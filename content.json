{"meta":{"title":"Xçš„åšå®¢","subtitle":"","description":"","author":"X","url":"http://yoursite.com","root":"/"},"pages":[],"posts":[{"title":"Instrumentsåˆ†æå’Œä½¿ç”¨","slug":"Instrumentsåˆ†æå’Œä½¿ç”¨","date":"2020-11-26T09:25:35.000Z","updated":"2020-11-26T10:47:08.600Z","comments":true,"path":"2020/2020-11-26-17:25:35/","link":"","permalink":"http://yoursite.com/2020/2020-11-26-17:25:35/","excerpt":"ä¸€ã€è‹¹æœå®˜æ–¹Instrumentsæ–‡æ¡£","text":"ä¸€ã€è‹¹æœå®˜æ–¹Instrumentsæ–‡æ¡£ å¯»æ‰¾å®˜æ–¹æ–‡æ¡£å°æŠ€å·§ï¼ˆç©ä¸ªèŠ±æ´»ï¼‰ Apple Developerå®˜ç½‘åªæœ‰Xcodeçš„å…¥å£, ä¿®æ”¹ https://help.apple.com/Xcode åé¢æ”¹æˆ instruments https://help.apple.com/instruments ä¹Ÿå¯ä»¥è¿™æ ·ç©ï¼ˆå–„ç”¨æœç´¢ï¼Œä½ ä¼šå‘ç°å¾ˆå¤šæƒŠå–œï¼‰ https://developer.apple.com/search/?q=instruments WWDC2019 Instruments è§†é¢‘ï¼ˆå¯é€‰ä¸­æ–‡å­—å¹•ï¼Œç‚¹å‡»è®¿é—®ï¼‰ ä½¿ç”¨å‰éœ€è¦åšçš„äº‹æƒ…æ‰“å¼€Malloc Stack. å¯ä»¥è®©æˆ‘ä»¬çœ‹åˆ°å †æ ˆä¿¡æ¯. (å¿«æ·é”® Command + Shift + ,) Live Allocations Only : åªæ˜¾ç¤ºæ²¡æœ‰è¢«é‡Šæ”¾(free)çš„å†…å­˜å †æ ˆ. All Alloction and Free History : æ˜¾ç¤ºæ‰€æœ‰çš„å†…å­˜å †æ ˆ, åŒ…æ‹¬è¢«é‡Šæ”¾(free)çš„. å¯¼å…¥æˆ–æ‰“å¼€dSYMæ–‡ä»¶. å¯ä»¥è¿˜åŸå †æ ˆä¿¡æ¯. è®¾ç½®æ–¹å¼ -&gt; Build Settings æ‰“å¼€Instrumentsçš„æ–¹å¼ å³é”®Dockæ çš„Xcodeå›¾æ ‡ (æˆ–è€…æŒ‰ä½Controlç‚¹å‡»Xcodeå›¾æ ‡) -&gt; Open Developer Tool -&gt; Instruments Xcodeèœå•æ  -&gt; Open Developer Tool -&gt; Instruments Xcode APP -&gt; Show the Debug navigator -&gt; Profile in Instruments Instrumentsç•Œé¢ä»‹ç»https://help.apple.com/instruments/mac/current/#/dev2843b037 InstrumentsåŠŸèƒ½ä½¿ç”¨. å†…å­˜åˆ›å»ºç›‘æ§ Allocations.https://help.apple.com/instruments/mac/current/#/dev7b8f6eb6 Core Animation (æ–°ç‰ˆXcodeæ¨¡æ‹Ÿå™¨æµ‹è¯•). æ–°ç‰ˆæœ¬æ”¹åˆ°æ¨¡æ‹Ÿå™¨ä¸­, çœ‹ä¸‹é¢çš„ Core Animation æ£€æµ‹. è€—æ—¶åˆ†æ Time Profiler. ä½¿ç”¨æ–¹æ³•ç›¸åŒ, æ²¡æœ‰å®˜æ–¹æ–‡æ¡£. å†…å­˜æ³„éœ² Leaks.https://help.apple.com/instruments/mac/current/#/dev022f987b å†…å­˜Debugçš„å¦ä¸€ç§æ–¹å¼. Debug Memory Graph (å¾ªç¯å¼•ç”¨æ¨èä½¿ç”¨æ­¤æ–¹å¼). åœ¨å›¾ä¸­, é»‘è‰²çš„çº¿å°±æ˜¯å¼ºå¼•ç”¨, ç°è‰²çš„çº¿å°±æ˜¯å¼±å¼•ç”¨. ä»¥æ­¤å¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹å‡º, å¦‚æœè¦é‡Šæ”¾çš„å¯¹è±¡, æ²¡ æœ‰è¢«é‡Šæ”¾, æ˜¯è¢«è°å¼ºå¼•ç”¨äº†. æ‰¾åˆ°å¯¹åº”çš„ä»£ç . é¢„è§ˆ Core Animation æ£€æµ‹ æ¨¡æ‹Ÿå™¨ (simulator) èœå•æ  Debug -&gt; Color Blended Layers : æ£€æµ‹é€æ˜å›¾å±‚ Color Copied Images : é32bit é¢œè‰²å›¾ç‰‡æ£€æµ‹ Session 419 WWDC 2014ä¸­è¯¦ç»†ä»‹ç»äº†Color Copied Images Color Misaligned Images æ‰“å¼€å¼€å…³åï¼Œçœ‹åˆ°éƒ¨åˆ†è§†å›¾ä¼šæœ‰é»„è‰²æˆ–æ´‹çº¢è‰²ï¼ˆMagentaï¼‰çš„å›¾å±‚æ ‡è®°ï¼Œä»£è¡¨å…¶åƒç´ ä¸å¯¹é½ã€‚ ä¸å¯¹é½ï¼šè§†å›¾æˆ–å›¾ç‰‡çš„ç‚¹æ•°(point)ï¼Œä¸èƒ½æ¢ç®—æˆæ•´æ•°çš„åƒç´ å€¼ï¼ˆpixelï¼‰ï¼Œå¯¼è‡´æ˜¾ç¤ºè§†å›¾çš„æ—¶å€™éœ€è¦å¯¹æ²¡å¯¹é½çš„è¾¹ç¼˜è¿›è¡Œé¢å¤–æ··åˆè®¡ç®—ï¼Œå½±å“æ€§èƒ½ã€‚ æ´‹çº¢è‰²ï¼šUIViewçš„frameåƒç´ ä¸å¯¹é½ï¼Œå³ä¸èƒ½æ¢ç®—æˆæ•´æ•°åƒç´ å€¼ã€‚ é»„è‰²ï¼šUIImageViewçš„å›¾ç‰‡åƒç´ å¤§å°ä¸å…¶frame.sizeä¸å¯¹é½ï¼Œå›¾ç‰‡å‘ç”Ÿäº†ç¼©æ”¾é€ æˆã€‚ Color Off-screen Rendered ç¦»å±æ¸²æŸ“æ£€æµ‹","categories":[],"tags":[{"name":"iOS","slug":"iOS","permalink":"http://yoursite.com/tags/iOS/"}]},{"title":"Xcodeå¿«æ·æŒ‡ä»¤","slug":"Xcodeå¿«æ·æŒ‡ä»¤","date":"2020-11-26T07:55:35.000Z","updated":"2020-11-26T10:38:17.145Z","comments":true,"path":"2020/2020-11-26-15:55:35/","link":"","permalink":"http://yoursite.com/2020/2020-11-26-15:55:35/","excerpt":"Xcodeçš„å¿«æ·æŒ‡ä»¤","text":"Xcodeçš„å¿«æ·æŒ‡ä»¤ _ å¿«æ·é”® è¯´æ˜ Command + shift + , Edit Scheme ç¼–è¾‘Scheme Command + shift + Y æ‰“å¼€/æ”¶èµ·æ§åˆ¶å° Command + shift + J åœ¨å·¥ç¨‹æ–‡ä»¶ç›®å½•å®šä½åˆ°å½“å‰æ–‡ä»¶ Command + shift + 2 Devices and Simulators Command + shift + O è¾“å…¥åç‚¹å‡»å¯å¿«é€Ÿè·³è½¬åˆ°æ–‡ä»¶ï¼Œè¿˜å¯è¾“å…¥æ–¹æ³•å Command + shift + F æœç´¢ğŸ” Command + shift + K Cleané¡¹ç›® Command + shift + L æ‰“å¼€èµ„æºæ–‡ä»¶ Command + shift + w å…³é—­é¡¹ç›® Command + shift + T æ–°å¼€å½“å‰é¡¹ç›® Command + Option + â† â†’ æ”¶èµ·å±•å¼€æ–¹æ³•ä»£ç å— Command + Shift + Option + â† â†’ æ”¶èµ·å±•å¼€å…¨å±€ä»£ç å— Command + Option + ã€ ã€‘ ä¸Šç§»ä¸‹ç§»ä»£ç  Command + Option + W ä¿ç•™å½“å‰æ‰“å¼€ï¼Œå…³é—­å…¶ä»–æ–‡ä»¶ Command + , åå¥½è®¾ç½® Command + R Run Command + B Build Command + N å¿«é€Ÿåˆ›å»ºæ–‡ä»¶ Command + ã€ ã€‘ å·¦å³ç§»åŠ¨ä»£ç  Command + F å½“å‰æ–‡ä»¶æœç´¢ Command + \\ æ‰“æ–­ç‚¹ Command + y å…³é—­æ–­ç‚¹è°ƒè¯• Command + . åœæ­¢å½“å‰æ“ä½œ Command + L è·³è½¬åˆ°å¯¹åº”è¡Œ Command + W å…³é—­å½“å‰æ–‡ä»¶ command + 1ï¼Œ2 â€¦ 9 å®æ“çœ‹ä¸‹æ•ˆæœå§ Command + 0 æ‰“å¼€/å…³é—­å·¦è¾¹å¯¼èˆª Control + 1 æŸ¥çœ‹æ–¹æ³•çš„è°ƒç”¨è€…å’Œè¢«è°ƒç”¨è€… Control + 6 æ˜¾ç¤ºå½“å‰æ–‡ä»¶çš„æ–¹æ³•ï¼Œç„¶åå¯ä»¥ç»§ç»­è¾“æ–¹æ³•åå›è½¦è·³è½¬ Control + 0 åˆ‡æ¢ Target Control + 4 åˆ‡æ¢é¡¹ç›® _","categories":[],"tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yoursite.com/tags/%E9%9A%8F%E7%AC%94/"}]},{"title":"iOSå¯¹è±¡æ‰€å å†…å­˜å¤§å°ä¹‹å†…å­˜å¯¹é½","slug":"iOSå¯¹è±¡æ‰€å å†…å­˜å¤§å°ä¹‹å†…å­˜å¯¹é½","date":"2020-11-18T12:59:08.136Z","updated":"2020-11-19T07:29:44.544Z","comments":true,"path":"2020/2020-11-18-20:59:08/","link":"","permalink":"http://yoursite.com/2020/2020-11-18-20:59:08/","excerpt":"ä¸€ã€è·å–NSObjectå¯¹è±¡å ç”¨çš„ç©ºé—´å¤§å°","text":"ä¸€ã€è·å–NSObjectå¯¹è±¡å ç”¨çš„ç©ºé—´å¤§å° åˆ›å»ºä¸€ä¸ª NSObject å¯¹è±¡, åˆ†åˆ«è°ƒç”¨ class_getInstanceSize å’Œ malloc_sizeæ–¹æ³• 1NSObject *obj &#x3D; [[NSObject alloc] init];23&#x2F;&#x2F; éœ€è¦å¯¼å…¥ #import &lt;objc&#x2F;runtime.h&gt;4NSLog(@&quot;%zd&quot;, class_getInstanceSize([NSObject class]));5 6&#x2F;&#x2F; éœ€è¦å¯¼å…¥ #import &lt;malloc&#x2F;malloc.h&gt;7NSLog(@&quot;%zd&quot;, malloc_size((__bridge const void *)(obj))); æŸ¥çœ‹Log 12019-11-05 15:10:22.210505+0800 Interview001-OCå¯¹è±¡çš„æœ¬è´¨[9215:816956] 822019-11-05 15:10:22.210675+0800 Interview001-OCå¯¹è±¡çš„æœ¬è´¨[9215:816956] 16 å¯ä»¥çœ‹å‡ºç³»ç»Ÿå¼€è¾Ÿäº†16ä¸ªå­—èŠ‚, ä½†æ˜¯è¯¥å¯¹è±¡åªæ˜¯ç”¨äº†8ä¸ªå­—èŠ‚ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢? ç‚¹è¿› NSObject å¯ä»¥çœ‹åˆ°ä¸‹é¢çš„ä»£ç , NSObject å¯¹è±¡çœŸæ­£çš„æ˜¯ä¸€ä¸ªç»“æ„ä½“æŒ‡é’ˆ, æ‰€ä»¥ä¼šå ç”¨8ä¸ªå­—èŠ‚ã€‚ 1&#x2F;&#x2F;&#x2F; An opaque type that represents an Objective-C class.2typedef struct objc_class *Class;3 4@interface NSObject &lt;NSObject&gt; &#123;5 Class isa ;6&#125; åœ¨ OpenSource æ‰¾åˆ° runtime æºç , æœç´¢ class_getInstanceSize å¯ä»¥æ‰¾åˆ°ä¸‹é¢çš„ä»£ç , å¯ä»¥çœ‹å‡º class_getInstanceSize è·å–çš„æ˜¯ç±»çš„æˆå‘˜å˜é‡çš„ size, å¹¶ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡æ‰€å ç”¨çš„ç©ºé—´ã€‚ 1size_t class_getInstanceSize(Class cls)2&#123;3 if (!cls) return 0;4 return cls-&gt;alignedInstanceSize();5&#125;67&#x2F;&#x2F; Class&#39;s ivar size rounded up to 123456789 pointer-size boundary.8uint32_t alignedInstanceSize() &#123;9 return word_align(unalignedInstanceSize());10&#125;1112size_t instanceSize(size_t extraBytes) &#123;13 size_t size &#x3D; alignedInstanceSize() + extraBytes;14 &#x2F;&#x2F; CF requires all objects be at least 16 bytes.15 if (size &lt; 16) size &#x3D; 16;16 return size;17&#125; é‚£ä¸ºä»€ä¹ˆä¼šåˆ†é…16ä¸ªå­—èŠ‚äº†? ä¹Ÿæ˜¯åœ¨ runtime é‡Œæ‰¾åˆ°äº†ç­”æ¡ˆ, å½“ size &lt; 16 æ—¶, ä¼šé»˜è®¤åˆ†é…16ä¸ªå­—èŠ‚ã€‚å¯ä»¥å‚ç…§ è¿™ç¯‡æ–‡ç«  æŠŠ.mæ–‡ä»¶ç¼–è¯‘æˆ.cppæ–‡ä»¶, æŸ¥çœ‹ NSObjectçœŸæ­£çš„å®ç°, å¯ä»¥ç†è§£æ˜¯å¯¹åº” c++ é‡Œçš„ç»“æ„ä½“ã€‚ äºŒã€è‡ªå®šä¹‰å¯¹è±¡æ‰€å ç©ºé—´ è‡ªå®šä¹‰ä¸€ä¸ªPersonç±» 1@interface Person : NSObject2 &#123;3 &#125;4 @end5 6 @implementation Person7 @end æ‰“å°å½“å‰å¯¹è±¡ 1Person *p &#x3D; [[Person alloc] init];23NSLog(@&quot;%zd&quot;, class_getInstanceSize([Person class]));4NSLog(@&quot;%zd&quot;, malloc_size((__bridge const void *)(p))); å¾—åˆ°çš„ç»“æœå’Œ NSObject å¯¹è±¡ä¸€æ ·çš„ 12019-11-05 15:30:11.991698+0800 Interview001-OCå¯¹è±¡çš„æœ¬è´¨[9360:864510] 822019-11-05 15:30:11.991704+0800 Interview001-OCå¯¹è±¡çš„æœ¬è´¨[9360:864510] 16 ç»™è‡ªå®šä¹‰å¯¹è±¡æ·»åŠ 1ä¸ªæˆå‘˜å˜é‡, å†æ¬¡æ‰“å° 1@interface Person : NSObject2&#123;3 int _age;4&#125;5@end 12019-11-05 15:31:56.767972+0800 Interview001-OCå¯¹è±¡çš„æœ¬è´¨[9385:868476] 1622019-11-05 15:31:56.767978+0800 Interview001-OCå¯¹è±¡çš„æœ¬è´¨[9385:868476] 16 å†æ¬¡æ·»åŠ æˆå‘˜å˜é‡, å†æ¬¡æ‰“å° 1@interface Person : NSObject2&#123;3 int _age;4 int _number;5&#125;6@end 12019-11-05 15:34:16.503491+0800 Interview001-OCå¯¹è±¡çš„æœ¬è´¨[9414:874058] 1622019-11-05 15:34:16.503497+0800 Interview001-OCå¯¹è±¡çš„æœ¬è´¨[9414:874058] 16 å¾ˆå¥‡æ€ª, æ²¡æœ‰å˜åŒ–å•Š? æˆ‘ä»¬ç¼–ç¨‹æˆ.cppå†æ¥åˆ†æ 1struct Person_IMPL &#123;2 struct NSObject_IMPL NSObject_IVARS;3 int _age;4 int _number;5&#125;; è¿™æ—¶è‡ªå®šä¹‰å¯¹è±¡åŒ…å«äº† 1ä¸ªç»“æ„ä½“æŒ‡é’ˆ (8å­—èŠ‚) 1ä¸ª int _age (4å­—èŠ‚) 1ä¸ª int _number (4å­—èŠ‚)8 + 4 + 4 = 16 å­—èŠ‚ æ²¡æœ‰æ·»åŠ ä»»ä½•æˆå‘˜å˜é‡æ—¶, åªæœ‰1ä¸ªç»“æ„ä½“æŒ‡é’ˆ, æ‰€ä»¥ä¼šæ˜¯8å­—èŠ‚ æ·»åŠ 1ä¸ªæˆå‘˜å˜é‡æ—¶, æœ‰1ä¸ªç»“æ„ä½“æŒ‡é’ˆ, å’Œ1ä¸ª int ç±»å‹çš„å€¼, é‚£å°±æ˜¯ 8 + 4 = 12, ä¸ºä»€ä¹ˆ class_getInstanceSize å¾—åˆ°çš„ç»“æœæ˜¯16äº†. å…¶å®æ‰©å®¹åŸºæ•°æ˜¯8(å†…å­˜å¯¹é½åŸå› , ç»“æ„ä½“çš„å¤§å°å¿…é¡»æ˜¯æœ€å¤§æˆå‘˜å¤§å°çš„å€æ•°), 8ä¸ªå­—èŠ‚ä¸å¤Ÿäº†, å°±å¼€è¾Ÿäº†8*2ä¸ªå­—èŠ‚, ä¾æ­¤ç±»æ¨ æ·»åŠ äº†2ä¸ªæˆå‘˜å˜é‡æ—¶, æœ‰1ä¸ªç»“æ„ä½“æŒ‡é’ˆ, å’Œ2ä¸ª int ç±»å‹çš„å€¼,é‚£å°±æ˜¯ 8 + 4 + 4 = 16 å†æ·»åŠ ä¸€ä¸ªæˆå‘˜å˜é‡ 1@interface Person : NSObject2&#123;3 int _age;4 int _number;5 int _sex;6&#125;7@end 12019-11-05 15:48:24.959113+0800 Interview001-OCå¯¹è±¡çš„æœ¬è´¨[9511:896453] 2422019-11-05 15:48:24.959120+0800 Interview001-OCå¯¹è±¡çš„æœ¬è´¨[9511:896453] 32 å¯ä»¥çœ‹å‡º class_getInstanceSize å·²ç»æ˜¯8*3=24å­—èŠ‚äº†ä½†æ˜¯ malloc_size å´æ˜¯ 32äº†, å› ä¸ºæ˜¯ä»¥16ä¸ºåŸºæ•°æ¥æ‰©å®¹çš„, å› ä¸º iOS åœ¨åˆ†é…å¯¹è±¡å†…å­˜æ—¶, éƒ½æ˜¯ä»¥16å€æ•°æ¥åˆ†é…çš„ æ¢ç´¢ä¸‹ç³»ç»Ÿæ˜¯å¦‚ä½•å†…å­˜å¯¹é½çš„ è¿ç®—ç¬¦çš„å«ä¹‰ è¿ç®—ç¬¦ å«ä¹‰ æè¿° &gt;&gt; å³ç§» å°†ä¸€ä¸ªæ•°çš„å„äºŒè¿›åˆ¶ä½å³ç§»Nä½ï¼Œç§»åˆ°å³ç«¯çš„ä½ä½è¢«èˆå¼ƒï¼Œå¯¹äºæ— ç¬¦å·æ•°ï¼Œé«˜ä½è¡¥0 &lt;&lt; å·¦ç§» ç”¨æ¥å°†ä¸€ä¸ªæ•°çš„å„äºŒè¿›åˆ¶ä½å…¨éƒ¨å·¦ç§»Nä½ï¼Œé«˜ä½èˆå¼ƒï¼Œä½ä½è¡¥0 &amp; æŒ‰ä½ä¸ å¦‚æœä¸¤ä¸ªç›¸åº”çš„äºŒè¿›åˆ¶ä½éƒ½ä¸º1ï¼Œåˆ™è¯¥ä½çš„ç»“æœå€¼ä¸º1ï¼Œå¦åˆ™ä¸º0 I æŒ‰ä½æˆ– ä¸¤ä¸ªç›¸åº”çš„äºŒè¿›åˆ¶ä½ä¸­åªè¦æœ‰ä¸€ä¸ªä¸º1ï¼Œè¯¥ä½çš„ç»“æœå€¼ä¸º1ï¼Œå¦åˆ™ä¸º0 ~ å–å å¯¹è¿™ä¸ªå­˜å‚¨å•å…ƒå½“å‰çš„å€¼å–åï¼Œä¹Ÿå°±æ˜¯åŸæ¥æ•°ä¸­ä¸º1çš„å˜ä¸º0ï¼Œ0å˜ä¸º1 çœ‹ä¸€ä¸‹æºç  1static inline uint32_t word_align(uint32_t x) &#123;2 return (x + WORD_MASK) &amp; ~WORD_MASK;3&#125;4 5static inline size_t word_align(size_t x) &#123;6 return (x + WORD_MASK) &amp; ~WORD_MASK;7&#125;8 9static inline size_t align16(size_t x) &#123;10 return (x + size_t(15)) &amp; ~size_t(15);11&#125; é‚£ä¹ˆæˆ‘ä»¬å°±ä¸éš¾ç†è§£äº†ï¼Œåˆ†æä¸€ä¸‹ï¼š 1 &#x2F;**2return (x + WORD_MASK) &amp; ~WORD_MASK;34å‡è®¾xä¸º6560000 0111 771111 1000 ~WORD_MASK80000 1101 6 + 7 &#x3D; 1390000 1000 (x + WORD_MASK) &amp; ~WORD_MASK ç»“æœï¼š810*&#x2F; æˆ‘ä»¬è‡ªå·±æ¥å†™ä¸ªæ–¹æ³•ï¼Œæ¢ä¸€ä¸ªæ–¹å¼æ¥è¾¾åˆ°ç³»ç»Ÿå†…å­˜å¯¹é½æ•ˆæœï¼š 12class_getInstanceSizeæ‰©å®¹åŸºæ•°æ˜¯8ï¼š3 int funcMethod(int num) &#123;4 return (num + 7) &gt;&gt; 3 &lt;&lt; 3;5 &#x2F;&#x2F; &gt;&gt; å³ç§» å°†ä¸€ä¸ªæ•°çš„å„äºŒè¿›åˆ¶ä½å³ç§»Nä½ï¼Œç§»åˆ°å³ç«¯çš„ä½ä½è¢«èˆå¼ƒï¼Œå¯¹äºæ— ç¬¦å·æ•°ï¼Œé«˜ä½è¡¥0ã€‚6 &#x2F;&#x2F; &lt;&lt; å·¦ç§» ç”¨æ¥å°†ä¸€ä¸ªæ•°çš„å„äºŒè¿›åˆ¶ä½å…¨éƒ¨å·¦ç§»Nä½ï¼Œé«˜ä½èˆå¼ƒï¼Œä½ä½è¡¥0ã€‚7 8 &#x2F;&#x2F; 0000 1101 6 + 7 &#x3D; 139 &#x2F;&#x2F; 0000 0001 &gt;&gt; 310 &#x2F;&#x2F; 0001 1000 &lt;&lt; 3 811 12 &#x2F;&#x2F; 0001 0011 12 + 7 &#x3D; 1913 &#x2F;&#x2F; 0000 0010 &gt;&gt; 314 &#x2F;&#x2F; 0001 0000 &lt;&lt; 3 1615 &#125;16 17 int main(int argc, char * argv[]) &#123;18 @autoreleasepool &#123;19 NSLog(@&quot;%d&quot;,funcMethod(6));20 NSLog(@&quot;%d&quot;,funcMethod(12));21 22 return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class]));23 &#125;24 &#125; æŸ¥çœ‹ä¸‹logæ‰“å°ï¼š 12020-11-19 14:29:16.424755+0800 Demo1[6321:2027201] 822020-11-19 14:29:16.425308+0800 Demo1[6321:2027201] 16 é‚£ä¹ˆfuncMethodå…·ä½“åšäº†ä»€ä¹ˆï¼Ÿ 1 return (num + 7) &gt;&gt; 3 &lt;&lt; 3;2&#x2F;&#x2F; &gt;&gt; å³ç§» å°†ä¸€ä¸ªæ•°çš„å„äºŒè¿›åˆ¶ä½å³ç§»Nä½ï¼Œç§»åˆ°å³ç«¯çš„ä½ä½è¢«èˆå¼ƒï¼Œå¯¹äºæ— ç¬¦å·æ•°ï¼Œé«˜ä½è¡¥0ã€‚3&#x2F;&#x2F; &lt;&lt; å·¦ç§» ç”¨æ¥å°†ä¸€ä¸ªæ•°çš„å„äºŒè¿›åˆ¶ä½å…¨éƒ¨å·¦ç§»Nä½ï¼Œé«˜ä½èˆå¼ƒï¼Œä½ä½è¡¥0ã€‚45&#x2F;&#x2F; 0000 1101 6 + 7 &#x3D; 136&#x2F;&#x2F; 0000 0001 &gt;&gt; 37&#x2F;&#x2F; 0001 1000 &lt;&lt; 3 ç»“æœï¼š889&#x2F;&#x2F; 0001 0011 12 + 7 &#x3D; 1910&#x2F;&#x2F; 0000 0010 &gt;&gt; 311&#x2F;&#x2F; 0001 0000 &lt;&lt; 3 ç»“æœï¼š16 malloc_sizeæ‰©å®¹åŸºæ•°æ˜¯16ï¼š 1 int funcMethod(int num) &#123;2 return (num + 15) &gt;&gt; 4 &lt;&lt; 4;3&#125;45int main(int argc, char * argv[]) &#123;6 @autoreleasepool &#123;7 NSLog(@&quot;%d&quot;,funcMethod(8));8 NSLog(@&quot;%d&quot;,funcMethod(20));910 return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class]));11 &#125;12&#125; æŸ¥çœ‹ä¸‹logæ‰“å°ï¼š 12020-11-19 14:47:36.265334+0800 Demo1[6565:2044463] 1622020-11-19 14:47:36.265933+0800 Demo1[6565:2044463] 32 ä¸‰ã€ ç»“è®º 1ä¸ª NSObject å¯¹è±¡å ç”¨äº†16ä¸ªå­—èŠ‚ 1ä¸ªè‡ªå®šä¹‰å¯¹è±¡å ç”¨äº†å‡ ä¸ªå­—èŠ‚, éœ€è¦æœ‰å¤šå°‘æˆå‘˜å˜é‡, åŒæ—¶è¿˜è¦è®¡ç®—ä¸Š NSObject çš„ isa æŒ‡é’ˆå¤§å°, åŒæ—¶ä¸ºäº†å¯¹é½, å¿…é¡»æ˜¯16çš„å€æ•° å››ã€ æ³¨æ„1- å¦‚æœè‡ªå®šä¹‰ç±»æœ‰ç»§æ‰¿å…³ç³», å¦‚ Student ç»§æ‰¿äº Person, è¦ç»§ç»­çˆ¶ç±»çš„æˆå‘˜å˜é‡2- æ³¨æ„å†…å­˜å¯¹é½é—®é¢˜, iOS åˆ†é…å†…å­˜é—®é¢˜","categories":[],"tags":[{"name":"iOS","slug":"iOS","permalink":"http://yoursite.com/tags/iOS/"}]},{"title":"iOSåŸºç¡€Bundleã€folderã€groupè¯¦è§£","slug":"iOSåŸºç¡€Bundleã€folderã€groupè¯¦è§£","date":"2020-11-06T09:39:09.000Z","updated":"2020-11-18T13:00:26.242Z","comments":true,"path":"2020/2020-11-06-17:39:09/","link":"","permalink":"http://yoursite.com/2020/2020-11-06-17:39:09/","excerpt":"ä¸€ã€Bundlesæ˜¯ä»€ä¹ˆï¼Ÿ","text":"ä¸€ã€Bundlesæ˜¯ä»€ä¹ˆï¼Ÿ Bundleæ˜¯ä¸€ä¸ªå«æœ‰å¯æ‰§è¡Œçš„ä»£ç åŠä»£ç æ‰€éœ€èµ„æºï¼Œä»¥ç‰¹å®šæ ‡å‡†çš„å±‚æ¬¡ç»“æ„ç»„åˆèµ·æ¥çš„æ–‡ä»¶å¤¹ã€‚è¿™é‡Œçš„å¯æ‰§è¡Œæ˜¯æŒ‡ç¼–è¯‘è¿‡åå¯ç›´æ¥è¿è¡Œçš„ä»£ç ç¨‹åºã€‚ä¸€ä¸ªå…¸å‹çš„ä¾‹å­å°±æ˜¯iOSç¨‹åºæ‰“åŒ…åçš„ipaï¼Œæˆ‘ä»¬è§£å‹ipaåä¼šå¾—åˆ°ä¸€ä¸ªpayloadæ–‡ä»¶å¤¹ï¼Œè¿›å…¥æ–‡ä»¶å¤¹ä¹‹åä¼šå‘ç°ä¸€ä¸ªå’Œipaåç§°ç›¸åŒçš„.appæ–‡ä»¶å¤¹ã€‚è¿™ä¸ª.appæ–‡ä»¶å¤¹å°±æ˜¯ä¸€ä¸ªBundleã€‚ æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹è‹¹æœå®˜æ–¹æ–‡æ¡£çš„æè¿°ï¼š About Bundles12Bundles are a convenient way to deliver software in macOS and iOS. Bundles provide a simplified interface for end users and at the same time provide support for development. This chapter provides an introduction to bundles and discusses the role they play in macOS and iOS. Bundles and Packages1Although bundles and packages are sometimes referred to interchangeably, they actually represent very distinct concepts:23* A package is any directory that the Finder presents to the user as if it were a single file.4* A bundle is a directory with a standardized hierarchical structure that holds executable code and the resources used by that code.56Packages provide one of the fundamental abstractions that makes macOS easy to use. If you look at an application or plug-in on your computer, what you are actually looking at is a directory. Inside the package directory are the code and resource files needed to make the application or plug-in run. When you interact with the package directory, however, the Finder treats it like a single file. This behavior prevents casual users from making changes that might adversely affect the contents of the package. For example, it prevents users from rearranging or deleting resources or code modules that might prevent an application from running correctly. è¿™é‡Œè¿˜æè¿°äº†Bundleå’ŒPackageçš„ä¸åŒå®šä¹‰ï¼š Packageæ˜¯Finderå‘ˆç°ç»™ç”¨æˆ·çš„ä»»ä½•ç›®å½•ï¼Œå°±å¥½åƒå®ƒæ˜¯ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ä¸€æ ·ã€‚ Bundleæ˜¯ä¸€ä¸ªå…·æœ‰æ ‡å‡†åŒ–å±‚æ¬¡ç»“æ„çš„ç›®å½•ï¼Œå…¶ä¸­åŒ…å«å¯æ‰§è¡Œä»£ç å’Œè¯¥ä»£ç ä½¿ç”¨çš„èµ„æºã€‚ ç³»ç»Ÿå¦‚ä½•è¯†åˆ«Bundleå‘¢ï¼Ÿä¸€èˆ¬è€Œè¨€ä¸€ä¸ªæ–‡ä»¶å¤¹å¦‚æœå¸¦ç€.appï¼Œ.bundleï¼Œ.frameworkï¼Œ.pluginï¼Œ.kextç­‰ç‰¹å®šåç¼€ï¼Œé‚£ä¹ˆç³»ç»Ÿå°±è®¤ä¸ºæ˜¯Bundleã€‚å¦‚æœä½¿ç”¨Xcodeåˆ›å»ºé¡¹ç›®çš„è¯ï¼ŒXcodeä¼šæä¾›ç›¸åº”çš„æ¨¡æ¿æ¥ç”Ÿæˆæ­£ç¡®çš„Bundleç±»å‹ã€‚ä»ä¸Šé¢çš„åç¼€æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºBundleä¸»è¦åˆ†ä¸ºï¼š Applictionã€‚åº”ç”¨ç¨‹åºï¼ŒåŒ…å«ä»£ç å’Œèµ„æºã€‚iOSå’ŒmacOSçš„appå°±æ˜¯è¿™ç§ã€‚ Frameworksã€‚æ¡†æ¶ï¼ŒåŒ…å«åŠ¨æ€å…±äº«åº“å’Œç›¸åº”èµ„æºã€‚æˆ‘ä»¬å¸¸ç”¨çš„ç³»ç»Ÿåº“å’Œç¬¬ä¸‰æ–¹åº“éƒ½å±äºè¿™ç§ã€‚ Plug-Insã€‚æ’ä»¶ï¼ŒmacOSå¾ˆå¤šçš„ç³»ç»ŸåŠŸèƒ½æ”¯æŒæ’ä»¶ï¼Œä¸€ç§åŠ¨æ€åŠ è½½ä»£ç æ¨¡å—çš„æ–¹å¼ã€‚ ä½¿ç”¨Bundleå¯ä»¥å¾ˆæ–¹ä¾¿çš„ç®¡ç†ç¨‹åºçš„æ–‡ä»¶å†…å®¹ï¼Œè¿›è¡Œæœ¬åœ°åŒ–è®¾ç½®ã€ç¨‹åºç§»åŠ¨å’Œè¿è¡Œç­‰ç­‰ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è‹¹æœå®˜æ–¹æ–‡æ¡£çš„æè¿°ï¼š 1How the System Identifies Bundles and Packages23The Finder considers a directory to be a package if any of the following conditions are true:45* The directory has a known filename extension: .app, .bundle, .framework, .plugin, .kext, and so on.6* The directory has an extension that some other application claims represents a package type; see Document Packages.7* The directory has its package bit set.89The preferred way to specify a package is to give the package directory a known filename extension. For the most part, Xcode takes care of this for you by providing templates that apply the correct extension. All you have to do is create an Xcode project of the appropriate type.1011Most bundles are also packages. For example, applications and plug-ins are typically presented as a single file by the Finder. However, this is not true for all bundle types. In particular, a framework is a type of bundle that is treated as a single unit for the purposes of linking and runtime usage, but framework directories are transparent so that developers can view the header files and other resources they contain. Bundlesçš„å†…éƒ¨ç»“æ„iOS Application Bundleçš„ç»“æ„Applicationç±»å‹çš„bundleæ˜¯å¾ˆå¸¸è§çš„ï¼Œä¸€èˆ¬é‡Œé¢ä¼šåŒ…å«ä¸€ä¸‹å‡ ä¸­ç±»å‹çš„æ–‡ä»¶ï¼š Info.plistæ–‡ä»¶ã€‚æ¯ä¸ªç¨‹åºä¸­å¿…é¡»æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œå› ä¸ºå®ƒåŒ…å«äº†ç¨‹åºè¿è¡Œçš„é…ç½®ä¿¡æ¯ï¼Œæ˜¯ç³»ç»Ÿè¿è¡Œç¨‹åºçš„ä¾æ®ã€‚ å¯æ‰§è¡Œä»£ç æ–‡ä»¶ã€‚è¿™æ˜¯ç¨‹åºçš„ä¸»ä½“ï¼ŒåŒ…å«äº†ç¨‹åºçš„è¿›å…¥ç‚¹å’Œé“¾æ¥çš„é™æ€ä»£ç ã€‚ èµ„æºæ–‡ä»¶ã€‚ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­éœ€è¦çš„èµ„æºï¼Œæ¯”å¦‚å›¾ç‰‡ï¼ŒéŸ³é¢‘ï¼Œè§†é¢‘ï¼Œå¤šè¯­è¨€çš„å­—ç¬¦ä¸²æ–‡ä»¶ï¼Œnibæ–‡ä»¶ï¼Œæ•°æ®æ–‡ä»¶ï¼Œé…ç½®æ–‡ä»¶ç­‰ç­‰ã€‚è¿™é‡Œé¢çš„å¤§éƒ¨åˆ†æ–‡ä»¶éƒ½å¯ä»¥æ ¹æ®è¯­è¨€ã€åœ°åŒºã€è®¾å¤‡é€šè¿‡ç‰¹å®šçš„ç»“æ„æˆ–å‘½åæ–¹å¼åŠ ä»¥åŒºåˆ†ï¼Œç¨‹åºä¼šè‡ªåŠ¨è¯†åˆ«åŠ è½½ã€‚ å…¶ä»–æ”¯æŒæ–‡ä»¶ã€‚Mac appå¯ä»¥åµŒå…¥é«˜å±‚èµ„æºï¼Œæ¯”å¦‚ç§æœ‰åº“ï¼Œæ’ä»¶ï¼Œæ–‡ä»¶æœ«ç­ï¼Œè‡ªå®šä¹‰æ•°æ®èµ„æºç­‰ç­‰ã€‚iOS appå¯ä»¥åŒ…å«è‡ªå®šä¹‰æ•°æ®èµ„æºï¼Œä½†æ˜¯ä¸èƒ½åŒ…å«ç§æœ‰åº“å’Œæ’ä»¶ã€‚ å¦‚æœæˆ‘ä»¬å¯¹äºipaä¸­çš„.appæ–‡ä»¶å¤¹å³é”®æ˜¾ç¤ºåŒ…å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°app bundleçš„æ•´ä½“ç»“æ„å¦‚ä¸‹ï¼š 1MyApp 2 MyApp &#x2F;&#x2F;ä»£ç ç¼–è¯‘é“¾æ¥åçš„å¯æ‰§è¡Œæ–‡ä»¶ 3 Info.plist &#x2F;&#x2F;ç¨‹åºä¿¡æ¯4 Assets.car &#x2F;&#x2F;Assetsä¸­çš„èµ„æºå¯¹åº”çš„æ–‡ä»¶ã€‚ 5 MyAppIcon.png &#x2F;&#x2F;æ‰€æœ‰çš„iconå›¾ç‰‡ 6 LaunchImage.png &#x2F;&#x2F;æ‰€æœ‰å¯åŠ¨å›¾ç‰‡ 7 nibs &#x2F;&#x2F;å·¥ç¨‹ä¸­çš„xibï¼Œstoryboardç”Ÿæˆçš„nibæ–‡ä»¶ 8 customResource &#x2F;&#x2F;å·¥ç¨‹ç›®å½•ä¸‹æˆ–è€…æ›´é‡Œå±‚æ–‡ä»¶å¤¹ä¸‹çš„å›¾ç‰‡ï¼ŒéŸ³ã€è§†é¢‘ï¼Œæ•°æ®æ–‡ä»¶ç­‰è‡ªå®šä¹‰èµ„æº 9 customBundle.bundle &#x2F;&#x2F;å·¥ç¨‹ä¸­ä½¿ç”¨çš„å…¶ä»–ç¬¬ä¸‰æ–¹æˆ–èµ„æºçš„bundle 10 en.lproj &#x2F;&#x2F;è¯­è¨€åŒºåˆ†çš„æ–‡ä»¶å¤¹ï¼Œå¯ä»¥ä½¿å­—ç¬¦ä¸²ã€å›¾ç‰‡ï¼Œnibæ–‡ä»¶ç­‰11 MyString 12 MyImage13 zh-Hans.lproj 14 MyString 15 MyImage 16 PkgInfo &#x2F;&#x2F;ç³»ç»Ÿè¯†åˆ«ä¿¡æ¯ 17 _CodeSignature &#x2F;&#x2F;ç­¾åä¿¡æ¯æ–‡ä»¶å¤¹ï¼Œé‡Œé¢çš„CodeResourcesåŒ…å«å¯¹bundleä¸­çš„æ‰€æœ‰èµ„æºæ–‡ä»¶çš„ç­¾åä¿¡æ¯ 18 embedded.mobileprovision &#x2F;&#x2F;æ‰“åŒ…çš„é…ç½®æ–‡ä»¶ä¿¡æ¯ Assets.caræ— æ³•ç›´æ¥æ‰“å¼€ï¼Œå¯ä»¥ä½¿ç”¨å·¥å…· cartool åˆ—å‡ºåŒ…å«çš„æ‰€æœ‰æ–‡ä»¶åç§°ã€‚PkgInfoã€ç­¾åä¿¡æ¯å’ŒåµŒå…¥é…ç½®æ–‡ä»¶éƒ½æ˜¯æ‰“åŒ…åç”Ÿæˆçš„ï¼Œæ˜¯ç³»ç»ŸéªŒè¯appçš„ä¾æ®ã€‚ Framework Bundleç»“æ„Framework Bundleå’Œapp bundleçš„æœ€å¤§ä¸åŒåœ¨äºæ¡†æ¶åº“æœ‰ç‰ˆæœ¬æ§åˆ¶ï¼Œå› æ­¤å¿…é¡»åŒ…å«ç‰ˆæœ¬åˆ—è¡¨å’Œå½“å‰ç‰ˆæœ¬ä¿¡æ¯ã€‚Frameworkçš„bundleç»“æ„å¦‚ä¸‹ï¼š 1MyFramework.framework&#x2F;2 MyFramework -&gt; Versions&#x2F;Current&#x2F;MyFramework 3 Resources -&gt; Versions&#x2F;Current&#x2F;Resources 4 Versions&#x2F;5 A&#x2F;6 MyFramework7 Headers&#x2F;8 MyHeader.h9 Resources&#x2F; 10 Eglish.lproj&#x2F;11 InfoPlist.strings 12 Info.plist13 Current -&gt; A ä¸Šé¢çš„æ ¹ç›®å½•ä¸‹çš„MyFrameworkå’ŒResourcesï¼Œä»¥åŠVersionsä¸‹é¢çš„current éƒ½æ˜¯æ–‡ä»¶å¼•ç”¨ï¼Œè¡¨æ˜å¼•ç”¨æ–‡ä»¶çš„ä½ç½®ã€‚çœŸæ­£çš„ä»£ç ï¼Œèµ„æºï¼Œheaderç­‰å†…å®¹éƒ½æ”¾åœ¨Versionsæ–‡ä»¶å¤¹ä¸‹é¢çš„å…·ä½“ç‰ˆæœ¬æ–‡ä»¶å¤¹ä¸­ï¼ŒCurrentå°±æŒ‡å‘å½“å‰ç‰ˆæœ¬çš„å¼•ç”¨ã€‚ å…³äºå¤šè¯­è¨€æœ¬åœ°åŒ–æ–‡ä»¶ï¼Œæ˜¯æŒ‰ç…§language_region.lprojçš„æ ¼å¼å‘½åçš„ï¼Œæ¯”å¦‚en_GBè¡¨æ˜è‹±è¯­è‹±å›½ï¼Œzh_Hansè¡¨ç¤ºä¸­æ–‡ä¸­å›½å¤§é™†ã€‚ Bundlesçš„åŸºæœ¬ä½¿ç”¨ä½¿ç”¨bundleä¸»è¦éƒ½æ˜¯å›´ç»•ç€å®šä½èµ„æºè·¯å¾„è€Œæ¥çš„ã€‚åŒ…æ‹¬ï¼šè·å–bundleåŠå…¶ä¿¡æ¯ï¼ˆä¸ç®¡æ˜¯main bundleè¿˜æ˜¯å…¶ä»–bundleï¼‰ï¼Œè·å–èµ„æºè·¯å¾„ï¼ˆæ ¹æ®èµ„æºåç§°å’Œç±»å‹å®šä½ï¼‰ï¼Œä½¿ç”¨ç³»ç»ŸAPIç›´æ¥è·å–èµ„æºï¼ˆæ¯”å¦‚å›¾ç‰‡ã€éŸ³é¢‘ã€æœ¬åœ°åŒ–å­—ç¬¦ä¸²ã€context helpï¼Œnibsï¼ŒInfo.plistå†…å®¹ç­‰ç­‰ï¼‰ï¼Œå…·ä½“ä½¿ç”¨å¯ä»¥å‚è€ƒ Class Bundleæ–‡æ¡£ åœ¨ç£ç›˜ä¸ŠæŸ¥æ‰¾èµ„æºæ—¶ï¼ŒBundleå¯¹è±¡éµå¾ªç‰¹å®šçš„æœç´¢æ¨¡å¼ã€‚é¦–å…ˆè¿”å›å…¨å±€èµ„æºï¼ˆå³ä¸åœ¨ç‰¹å®šäºè¯­è¨€çš„.lprojç›®å½•ä¸­çš„èµ„æºï¼‰ï¼Œç„¶åè¿”å›ç‰¹å®šäºåŒºåŸŸå’Œè¯­è¨€çš„èµ„æºã€‚æ­¤æœç´¢æ¨¡å¼è¡¨ç¤ºæ†ç»‘åŒ…æŒ‰ä»¥ä¸‹é¡ºåºæŸ¥æ‰¾èµ„æºï¼š å…¨å±€ï¼ˆéæœ¬åœ°åŒ–ï¼‰èµ„æº ç‰¹å®šåŒºåŸŸçš„æœ¬åœ°åŒ–èµ„æºï¼ˆåŸºäºç”¨æˆ·çš„åŒºåŸŸé¦–é€‰é¡¹ï¼‰ ç‰¹å®šè¯­è¨€çš„æœ¬åœ°åŒ–èµ„æºï¼ˆåŸºäºç”¨æˆ·çš„è¯­è¨€é¦–é€‰é¡¹ï¼‰ å¼€å‘è¯­è¨€èµ„æºï¼ˆç”±bundleçš„Info.plistæ–‡ä»¶ä¸­çš„CFBundleDevelopmentRegioné”®æŒ‡å®šï¼‰ ç”±äºå…¨å±€èµ„æºä¼˜å…ˆäºç‰¹å®šè¯­è¨€çš„èµ„æºï¼Œå› æ­¤æ‚¨ä¸åº”åœ¨åº”ç”¨ç¨‹åºä¸­åŒæ—¶åŒ…å«ç»™å®šèµ„æºçš„å…¨å±€å’Œæœ¬åœ°åŒ–ç‰ˆæœ¬ã€‚å­˜åœ¨èµ„æºçš„å…¨å±€ç‰ˆæœ¬æ—¶ï¼Œæ°¸è¿œä¸ä¼šè¿”å›ç‰¹å®šè¯­è¨€çš„ç‰ˆæœ¬ã€‚è¿™ç§ä¼˜å…ˆæƒçš„åŸå› æ˜¯æ€§èƒ½ã€‚å¦‚æœé¦–å…ˆæœç´¢æœ¬åœ°åŒ–èµ„æºï¼Œåˆ™bundleå¯¹è±¡å¯èƒ½ä¼šæµªè´¹æ—¶é—´åœ¨è¿”å›å…¨å±€èµ„æºä¹‹å‰æœç´¢ä¸å­˜åœ¨çš„æœ¬åœ°åŒ–èµ„æºã€‚ åœ¨æŸ¥æ‰¾èµ„æºæ–‡ä»¶æ—¶ï¼Œbundleå¯¹è±¡åœ¨ç¡®å®šè¦è¿”å›çš„æ–‡ä»¶æ—¶ä¼šè‡ªåŠ¨è€ƒè™‘è®¸å¤šæ ‡å‡†æ–‡ä»¶åä¿®é¥°ç¬¦ã€‚å¯ä»¥ä¸ºç‰¹å®šè®¾å¤‡ï¼ˆiphoneï¼Œipadï¼‰æˆ–ç‰¹å®šå±å¹•åˆ†è¾¨ç‡ï¼ˆ@2xï¼Œ@ 3xï¼‰æ ‡è®°èµ„æºã€‚æŒ‡å®šæ‰€éœ€èµ„æºçš„åç§°æ—¶ï¼Œè¯·ä¸è¦åŒ…å«è¿™äº›ä¿®é¥°ç¬¦ã€‚ bundleå¯¹è±¡é€‰æ‹©æœ€é€‚åˆåº•å±‚è®¾å¤‡çš„æ–‡ä»¶ã€‚ å‚è€ƒèµ„æ–™ï¼šBundle Programming GuideClass Bundle Reference äºŒã€iOS Xcodeå·¥ç¨‹ç›®å½•ä¸­folderå’Œgroupçš„åŒºåˆ«è¯´åˆ°folderå’Œgroupå¤§å®¶åº”è¯¥å¹¶ä¸é™Œç”Ÿï¼ŒXCodeå·¥ç¨‹ç›®å½•é‡Œé¢ï¼Œä½ ä¼šå‘ç°ä¸¤ä¸ªä¸åŒé¢œè‰²çš„æ–‡ä»¶å¤¹ï¼Œä¸€ç§æ˜¯è“è‰²çš„ï¼Œä¸€ç§æ˜¯é»„è‰²çš„ï¼Œæœ€å¸¸è§çš„æ˜¯é»„è‰²çš„ã€‚è¿™é‡Œæˆ‘ä»¬è¦æ¢è®¨çš„å°±æ˜¯é»„è‰²å’Œè“è‰²æ–‡ä»¶å¤¹çš„åŒºåˆ«ï¼š group ï¼ˆé»„è‰²æ–‡ä»¶å¤¹ï¼‰ä¸€èˆ¬åªåœ¨ä½ çš„å·¥ç¨‹ä¸­æ˜¯æ–‡ä»¶å¤¹çš„å½¢å¼ï¼Œä½†æ˜¯åœ¨æœ¬åœ°çš„ç›®å½•ä¸­è¿˜æ˜¯ä»¥æ•£ä¹±çš„å½¢å¼æ”¾åœ¨ä¸€èµ·çš„ï¼Œé™¤éä½ æ˜¯ä»å¤–éƒ¨ä»¥groupçš„å½¢å¼å¼•ç”¨è¿›æ¥çš„ã€‚ï¼ˆpsï¼šç›®å‰ç‰ˆæœ¬å·²ç»å°†æ–°å»ºç«‹çš„åˆ†ç»„åˆ›å»ºæˆçœŸæ­£çš„æ–‡ä»¶å¤¹ï¼‰ folder ï¼ˆè“è‰²æ–‡ä»¶ï¼‰åªèƒ½ä½œä¸ºèµ„æºï¼Œæ•´ä¸ªå¼•ç”¨è¿›é¡¹ç›®ï¼Œä¸å‚ä¸ç¼–è¯‘ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä»¥folderå½¢å¼å¼•ç”¨è¿›æ¥çš„æ–‡ä»¶ï¼Œä¸èƒ½è¢«æ”¾åœ¨complie sourcesåˆ—è¡¨é‡Œé¢ã€‚ æˆ‘æ‹–åŠ¨å¤–éƒ¨çš„æ–‡ä»¶å¤¹ â€œåˆ‡å›¾â€åˆ°æˆ‘çš„xcodeå·¥ç¨‹ç›®å½•ä¸‹é¢ï¼Œä¼šå¼¹å‡ºå¯¹è¯æ¡†ï¼Œå¦‚å›¾ï¼š copyï¼Œæ˜¯æŒ‡æ–‡ä»¶ä¸åœ¨é¡¹ç›®çš„ç›®å½•ä¸‹é¢ï¼Œä¾‹å¦‚é¡¹ç›®åœ¨æ¡Œé¢ä¸Šï¼Œæ–‡ä»¶åœ¨ Download ä¸‹ï¼Œä½  copy å°±ä¼šè¢«å¤åˆ¶åˆ°é¡¹ç›®é‡Œé¢ã€‚å¦‚æœæ–‡ä»¶åŸæœ¬å°±åœ¨é¡¹ç›®é‡Œé¢ï¼Œåˆ™ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚è¿™é‡Œä¸ç®¡å®ƒï¼Œé‡ç‚¹æ˜¯ä¸‹é¢çš„å•é€‰æ¡†ã€‚ è¿™é‡Œæˆ‘é€‰æ‹©çš„æ˜¯ä»¥folderçš„å½¢å¼å¼•ç”¨æ–‡ä»¶å¤¹ï¼Œç‚¹å‡»å®Œæˆï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ–‡ä»¶å¤¹æ˜¯è“è‰²çš„ï¼Œå¹¶ä¸”ç¼–è¯‘æ–‡ä»¶åˆ—è¡¨é‡Œé¢æ²¡æœ‰â€åˆ‡å›¾â€ è¿™ä¸ªæ–‡ä»¶ï¼Œè¯æ˜æ–‡ä»¶å¤¹å¼•ç”¨ï¼Œåªä¼šå¼•ç”¨æ–‡ä»¶å¤¹ï¼Œæ–‡ä»¶å¤¹é‡Œé¢çš„ä¸œè¥¿éƒ½ä¼šç›´æ¥æ‹·è´åˆ°bundleåŒ…ï¼Œä¸å‚ä¸ç¼–è¯‘ã€‚","categories":[],"tags":[{"name":"iOS","slug":"iOS","permalink":"http://yoursite.com/tags/iOS/"}]},{"title":"iOS ç»„ä»¶åº“åˆ¶ä½œæµç¨‹","slug":"ç»„ä»¶åº“åˆ¶ä½œæµç¨‹","date":"2020-10-24T08:52:17.000Z","updated":"2020-10-24T08:52:17.000Z","comments":true,"path":"2020/2020-08-25-17:25:13/","link":"","permalink":"http://yoursite.com/2020/2020-08-25-17:25:13/","excerpt":"ä¸€ã€åˆ¶ä½œæµç¨‹","text":"ä¸€ã€åˆ¶ä½œæµç¨‹ 11ã€æ–°å»ºXX.gitä»“åº“2 2ã€æ–°å»ºæ–‡ä»¶å¤¹ XXå¹¶cdåˆ°æ–‡ä»¶å¤¹3 3ã€pod lib create XX4 ï¼ˆ1ï¼‰æ˜¯å¦éœ€è¦ä¸€ä¸ªä¾‹å­å·¥ç¨‹ï¼š YES5 ï¼ˆ2ï¼‰é€‰æ‹©ä¸€ä¸ªæµ‹è¯•æ¡†æ¶ï¼šSpecta6 ï¼ˆ3ï¼‰æ˜¯å¦åŸºäºViewæµ‹è¯•ï¼šYES7 ï¼ˆ4ï¼‰ç±»çš„å‰ç¼€ï¼šXB 8 4ã€æ‰¾åˆ°ReplaceMeæ‰€åœ¨çš„æ–‡ä»¶å¤¹ï¼Œå¹¶å°†æºç æ”¾å…¥æ­¤æ–‡ä»¶å¤¹9 5ã€cd Example å¹¶æ‰§è¡Œ pod update --verbose --no-repo-update10 6ã€ç¼–å†™demoï¼Œå¹¶æµ‹è¯•é€šè¿‡11 7ã€æäº¤åˆ°xx.gitä»“åº“ï¼Œå¹¶update tag12 8ã€ç¼–è¾‘podspecæ–‡ä»¶ ã€exampleï¼šè§5ã€‘å¹¶éªŒè¯æ˜¯å¦å¯ç”¨13 pod lib lint14 9ã€æ·»åŠ XX.podspec åˆ°ä¸­å¿ƒä»“åº“15 pod repo push http:&#x2F;&#x2F;gitlab.devops.xxx.com&#x2F;ios&#x2F;PrivateCocoaPods.git XX.podspec16 pod repo push http:&#x2F;&#x2F;gitlab.devops.xxx.com&#x2F;ios&#x2F;PrivateCocoaPods.git XX.podspec --verbose --use-libraries --allow-warnings17 10ã€æ£€æŸ¥æ˜¯å¦æ·»åŠ æˆåŠŸ18 pod search XX19 11ã€å¯¼å…¥åˆ°é¡¹ç›®ä¸­ï¼š20 pod &#39;XX&#39; äºŒã€æ›´æ–°åº“11ã€ç¼–å†™æ›´æ–°ä»£ç 2 2ã€æäº¤åˆ°gitä»“åº“ï¼Œå¹¶update tag3 3ã€æ›´æ–°XX.podspecæ–‡ä»¶ç‰ˆæœ¬å·åŠæ›´æ–°ç‰ˆæœ¬è®°å½•4 4ã€æ›´æ–°XX.podspec åˆ°ä¸­å¿ƒä»“åº“5 pod repo push http:&#x2F;&#x2F;gitlab.devops.xxx.com&#x2F;ios&#x2F;PrivateCocoaPods.git XX.podspec6 pod repo push http:&#x2F;&#x2F;gitlab.devops.xxx.com&#x2F;ios&#x2F;PrivateCocoaPods.git XX.podspec --verbose --use-libraries --allow-warnings ä¸‰ã€ä½¿ç”¨ä¸­é‡åˆ°çš„é—®é¢˜çœ‹ä¸‹é¢ä½¿ç”¨Cocoapodsåˆ›å»ºç§æœ‰podspecCocoapodsä»£ç ç®¡ç†pod updateæ…¢ç§æœ‰podç›¸äº’ä¾èµ– 1ä»¥ä¸Šæ­¥éª¤éƒ½OKï¼Œæœç´¢ä¸åˆ°2rm ~&#x2F;Library&#x2F;Caches&#x2F;CocoaPods&#x2F;search_index.json34ç§æœ‰pod specsç›¸äº’ä¾èµ–5$pod spec lint QZCrashLogManager.podspec â€“allow-warnings â€“sources&#x3D;xsl-mobile-cocoaspecs,master å››ã€podspecæ ¼å¼ä¸å¿…å¡«1Pod::Spec.new do |s|2 s.name &#x3D; &quot;PodTestLibrary&quot; #åç§°3 s.version &#x3D; &quot;0.1.0&quot; #ç‰ˆæœ¬å·4 s.summary &#x3D; &quot;Just Testing.&quot; #ç®€çŸ­ä»‹ç»ï¼Œä¸‹é¢æ˜¯è¯¦ç»†ä»‹ç»5 s.description &#x3D; &lt;&lt;-DESC6 è¿™é‡Œæ˜¯è¯¦ç»†ä»‹ç»7 DESC8 s.homepage &#x3D; &quot;http:&#x2F;&#x2F;gitlab.devops.xxx.com&#x2F;ios&#x2F;XX.git&quot; #ä¸»é¡µ,è¿™é‡Œè¦å¡«å†™å¯ä»¥è®¿é—®åˆ°çš„åœ°å€ï¼Œä¸ç„¶éªŒè¯ä¸é€šè¿‡9 # s.screenshots &#x3D; &quot;www.example.com&#x2F;screenshots_1&quot;, &quot;www.example.com&#x2F;screenshots_2&quot; #æˆªå›¾10 s.license &#x3D; &#39;MIT&#39; #å¼€æºåè®®11 s.author &#x3D; &#123; &quot;xuebiao&quot; &#x3D;&gt; &quot;xuebiao@ksjgs.com&quot; &#125; #ä½œè€…ä¿¡æ¯12 s.source &#x3D; &#123; :git &#x3D;&gt; &quot;http:&#x2F;&#x2F;gitlab.devops.xxx.com&#x2F;ios&#x2F;XX.git&quot;, :tag &#x3D;&gt; s.version.to_s &#125; #é¡¹ç›®åœ°å€ï¼Œè¿™é‡Œä¸æ”¯æŒsshçš„åœ°å€ï¼ŒéªŒè¯ä¸é€šè¿‡ï¼Œåªæ”¯æŒHTTPå’ŒHTTPSï¼Œæœ€å¥½ä½¿ç”¨HTTPS13 # s.social_media_url &#x3D; &#39;https:&#x2F;&#x2F;twitter.com&#x2F;&lt;TWITTER_USERNAME&gt;&#39; #å¤šåª’ä½“ä»‹ç»åœ°å€1415 s.platform &#x3D; :ios, &#39;8.0&#39; #æ”¯æŒçš„å¹³å°åŠç‰ˆæœ¬16 s.requires_arc &#x3D; true #æ˜¯å¦ä½¿ç”¨ARCï¼Œå¦‚æœæŒ‡å®šå…·ä½“æ–‡ä»¶ï¼Œåˆ™å…·ä½“çš„é—®é¢˜ä½¿ç”¨ARC1718 s.source_files &#x3D; &#39;Pod&#x2F;Classes&#x2F;**&#x2F;*&#39; #ä»£ç æºæ–‡ä»¶åœ°å€ï¼Œ**&#x2F;*è¡¨ç¤ºClassesç›®å½•åŠå…¶å­ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ï¼Œå¦‚æœæœ‰å¤šä¸ªç›®å½•ä¸‹åˆ™ç”¨é€—å·åˆ†å¼€ï¼Œå¦‚æœéœ€è¦åœ¨é¡¹ç›®ä¸­åˆ†ç»„æ˜¾ç¤ºï¼Œè¿™é‡Œä¹Ÿè¦åšç›¸åº”çš„è®¾ç½®19 s.resource_bundles &#x3D; &#123;20 &#39;PodTestLibrary&#39; &#x3D;&gt; [&#39;Pod&#x2F;Assets&#x2F;*.png&#39;]21 &#125; #èµ„æºæ–‡ä»¶åœ°å€2223 s.public_header_files &#x3D; &#39;Pod&#x2F;Classes&#x2F;**&#x2F;*.h&#39; #å…¬å¼€å¤´æ–‡ä»¶åœ°å€24 s.frameworks &#x3D; &#39;UIKit&#39; #æ‰€éœ€çš„frameworkï¼Œå¤šä¸ªç”¨é€—å·éš”å¼€25 s.dependency &#39;AFNetworking&#39;, &#39;~&gt; 2.3&#39; #ä¾èµ–å…³ç³»ï¼Œè¯¥é¡¹ç›®æ‰€ä¾èµ–çš„å…¶ä»–åº“ï¼Œå¦‚æœæœ‰å¤šä¸ªéœ€è¦å¡«å†™å¤šä¸ªs.dependency26end podspecè¿›é˜¶1 # å¾®ä¿¡åˆ†äº«2 s.subspec &#39;UMSocialWechat&#39; do |ss|3 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;UMSocialWechat&#x2F;*.&#123;h,m&#125;&#39;4 ss.public_header_files &#x3D; &#39;KSThirdPartToolModule&#x2F;UMSocialWechat&#x2F;*.h&#39;5 ss.vendored_libraries &#x3D; &#39;KSThirdPartToolModule&#x2F;UMSocialWechat&#x2F;*.a&#39;6 ss.dependency &#39;UMCCommon&#39;7#ss.dependency &#39;UMCSecurityPlugins&#39;8#ss.dependency &#39;UMCShare&#x2F;Social&#x2F;ReducedQQ&#39;9 ss.dependency &#39;UMCShare&#x2F;Social&#x2F;ReducedSina&#39;10 ss.dependency &#39;UMCShare&#x2F;Social&#x2F;QQ&#39;11 ss.dependency &#39;WechatOpenSDK&#39;12 end1314 # è®¯é£è¯­éŸ³è¯†åˆ«15 s.subspec &#39;iflyMSC&#39; do |ss|16 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;iflyMSC&#x2F;**&#x2F;*.&#123;h,m&#125;&#39;17 ss.public_header_files &#x3D; &#39;KSThirdPartToolModule&#x2F;iflyMSC&#x2F;**&#x2F;*.h&#39;18 ss.vendored_frameworks &#x3D; [&#39;KSThirdPartToolModule&#x2F;iflyMSC&#x2F;iflyMSC.framework&#39;]19 ss.libraries &#x3D; &#39;c++&#39;,&#39;z&#39;20 ss.frameworks &#x3D; &#39;Contacts&#39;,&#39;AddressBook&#39;,&#39;AddressBookUI&#39;,&#39;AVFoundation&#39;,&#39;SystemConfiguration&#39;,&#39;Foundation&#39;,&#39;CoreTelephony&#39;,&#39;AudioToolbox&#39;,&#39;UIKit&#39;,&#39;CoreLocation&#39;,&#39;QuartzCore&#39;,&#39;CoreGraphics&#39;21 end2223 # æ™ºé½¿24 s.subspec &#39;SobotLib&#39; do |ss|25 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;SobotLib&#x2F;**&#x2F;*.&#123;h,m&#125;&#39;26 ss.public_header_files &#x3D; &#39;KSThirdPartToolModule&#x2F;SobotLib&#x2F;**&#x2F;*.h&#39;27 ss.vendored_libraries &#x3D; [&#39;KSThirdPartToolModule&#x2F;SobotLib&#x2F;libSobotLib.a&#39;]28 end2930 # GVUserDefaults31 s.subspec &#39;KSGVUserDefaults&#39; do |ss|32 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSGVUserDefaults&#x2F;**&#x2F;*&#39;33 ss.public_header_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSGVUserDefaults&#x2F;**&#x2F;*.h&#39;34 end3536 # SSKeychain37 s.subspec &#39;KSSSKeychain&#39; do |ss|38 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSSSKeychain&#x2F;*&#39;39 ss.public_header_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSSSKeychain&#x2F;*.h&#39;40 ss.dependency &#39;KSThirdPartToolModule&#x2F;KSGVUserDefaults&#39;4142 ss.subspec &#39;KSSSKeychain_0&#39; do |sss|43 sss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSSSKeychain&#x2F;SAMKeychain_0&#x2F;**&#x2F;*&#39;44 sss.public_header_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSSSKeychain&#x2F;**&#x2F;*.h&#39;45 end4647 ss.subspec &#39;KSSSKeychain_1&#39; do |sss|48 sss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSSSKeychain&#x2F;SAMKeychain_1&#x2F;**&#x2F;*&#39;49 sss.public_header_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSSSKeychain&#x2F;**&#x2F;*.h&#39;50 end51 end5253 # æ•°å­—è”ç›Ÿ54 s.subspec &#39;KSSZLM&#39; do |ss|55 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSSZLM&#x2F;**&#x2F;*.&#123;h,m&#125;&#39;56 ss.public_header_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSSZLM&#x2F;**&#x2F;*.h&#39;57 ss.vendored_frameworks &#x3D; [&#39;KSThirdPartToolModule&#x2F;KSSZLM&#x2F;du.framework&#39;]58 end5960 s.subspec &#39;JKDBModel&#39; do |ss| 61 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;JKDBModel&#x2F;**&#x2F;*&#39;62 ss.public_header_files &#x3D; &#39;KSThirdPartToolModule&#x2F;JKDBModel&#x2F;**&#x2F;*.h&#39;63 ss.dependency &#39;KSBaseModule&#39;64 ss.dependency &#39;KSFMDB&#39;65 end6667 s.subspec &#39;KSOpenURLTool&#39; do |ss| 68 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSOpenURLTool&#x2F;**&#x2F;*&#39;69 ss.public_header_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSOpenURLTool&#x2F;**&#x2F;*.h&#39;70 ss.dependency &#39;KSCommonCategory&#39;71 ss.dependency &#39;KSCommonMacros&#39;72 end7374 s.subspec &#39;KSDateFormatterManager&#39; do |ss|75 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSDateFormatterManager&#x2F;**&#x2F;*.&#123;h,m&#125;&#39;76 ss.dependency &#39;KSCommonCategory&#39;77 ss.dependency &#39;KSCommonMacros&#39;78 end79 80 s.subspec &#39;FCFileManager&#39; do |ss|81 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;FCFileManager&#x2F;**&#x2F;*.&#123;h,m&#125;&#39;82 end8384 s.subspec &#39;KSCameraManager&#39; do |ss| 85 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSCameraManager&#x2F;**&#x2F;*.&#123;h,m&#125;&#39;86 ss.dependency &#39;KSThirdPartToolModule&#x2F;KSAlertController_new&#39;87 ss.dependency &#39;KSCommonConstants&#39;88 end8990 s.subspec &#39;YCDownloadSession&#39; do |ss|91 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;YCDownloadSession&#x2F;**&#x2F;*&#39;92 end9394 s.subspec &#39;KSAlertController_new&#39; do |ss|95 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSAlertController_new&#x2F;**&#x2F;*.&#123;h,m&#125;&#39;96 ss.dependency &#39;KSUICommonCategory&#39;97 end9899 s.subspec &#39;IPAddress&#39; do |ss|100 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;IPAddress&#x2F;**&#x2F;*&#39;101 end102103 s.subspec &#39;KSCodeGenerator&#39; do |ss|104 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSCodeGenerator&#x2F;**&#x2F;*&#39;105 ss.frameworks &#x3D; &#39;CoreImage&#39;,&#39;CoreGraphics&#39;,&#39;Foundation&#39;106 end107108 s.subspec &#39;KSAssociationOriginalObject&#39; do |ss|109 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSAssociationOriginalObject&#x2F;*&#39;110 end111112 s.subspec &#39;KSCustomPresentationController&#39; do |ss|113 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSCustomPresentationController&#x2F;*&#39;114 end115116 s.subspec &#39;KSCircleSlider&#39; do |ss|117 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSCircleSlider&#x2F;*&#39;118 ss.dependency &#39;KSUICommonCategory&#39;119 end120121 s.subspec &#39;KSGCDDelay&#39; do |ss|122 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSGCDDelay&#x2F;*&#39;123 end124125 s.subspec &#39;KSJailbreakDetectTool&#39; do |ss|126 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSJailbreakDetectTool&#x2F;*&#39;127 end128129 s.subspec &#39;KSTextField&#39; do |ss|130 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSTextField&#x2F;*&#39;131 end132133 s.subspec &#39;GCD&#39; do |ss|134 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;GCD&#x2F;*&#39;135 end136137 s.subspec &#39;KSAllTypeJumpToViewControllerTool&#39; do |ss|138 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSAllTypeJumpToViewControllerTool&#x2F;*&#39;139 ss.dependency &#39;KSBaseModule&#39;140 end141142 s.subspec &#39;KSMutableTypeTool&#39; do |ss|143 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSMutableTypeTool&#x2F;*&#39;144 end145146 s.subspec &#39;KSCountdownCircleView&#39; do |ss|147 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSCountdownCircleView&#x2F;*&#39;148 ss.dependency &#39;KSThirdPartToolModule&#x2F;KSWeakProxy&#39;149 end150151 s.subspec &#39;KSWeakProxy&#39; do |ss|152 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSWeakProxy&#x2F;*&#39;153 end154155 # KSImageTool156 s.subspec &#39;KSImageTool&#39; do |ss|157 ss.source_files &#x3D; &#39;KSThirdPartToolModule&#x2F;KSImageTool&#x2F;**&#x2F;*&#39;158 ss.dependency &#39;SDWebImage&#39;159 ss.dependency &#39;KSAPPServerConfigModule&#39;160 ss.dependency &#39;KSCommonMacros&#39;161 ss.dependency &#39;KSCommonCategory&#39;162 end163164 s.dependency &#39;KSCommonConstants&#39;165 s.dependency &#39;KSCommonMacros&#39;166 s.dependency &#39;KSCommonCategory&#39;167 s.dependency &#39;KSUICommonCategory&#39;168 s.dependency &#39;Baymax&#39;169 s.dependency &#39;KSLBLelinkKitModule&#39;,&#39;1.0.0.1&#39;","categories":[{"name":"æ¶æ„çŸ¥è¯†","slug":"æ¶æ„çŸ¥è¯†","permalink":"http://yoursite.com/categories/%E6%9E%B6%E6%9E%84%E7%9F%A5%E8%AF%86/"}],"tags":[{"name":"ç»„ä»¶åº“åˆ¶ä½œ","slug":"ç»„ä»¶åº“åˆ¶ä½œ","permalink":"http://yoursite.com/tags/%E7%BB%84%E4%BB%B6%E5%BA%93%E5%88%B6%E4%BD%9C/"}]},{"title":"Swift+RXSwift","slug":"Swift-RXSwift","date":"2020-10-24T08:46:32.000Z","updated":"2020-10-24T10:00:37.000Z","comments":true,"path":"2020/Sat Oct 24 2020 16:46:32 GMT+0800 (ä¸­å›½æ ‡å‡†æ—¶é—´)/","link":"","permalink":"http://yoursite.com/2020/Sat%20Oct%2024%202020%2016:46:32%20GMT+0800%20(%E4%B8%AD%E5%9B%BD%E6%A0%87%E5%87%86%E6%97%B6%E9%97%B4)/","excerpt":"åˆ†äº«ä¸€ä¸‹åœ¨æ—¥å¸¸ä½¿ç”¨RxSwiftè¿›è¡Œå¼€å‘çš„MVVMæ¨¡å¼","text":"åˆ†äº«ä¸€ä¸‹åœ¨æ—¥å¸¸ä½¿ç”¨RxSwiftè¿›è¡Œå¼€å‘çš„MVVMæ¨¡å¼ ä¸€ä¸ªæœ‰collectionViewçš„åˆ—è¡¨é¡µï¼ŒMVVMæ–‡ä»¶ç›®å½•ç»“æ„ï¼š æ¥å£ KSUserAvatarAPI1import Moya23enum KSUserAvatarAPI &#123;4 &#x2F;&#x2F;&#x2F;è·å–å¤´åƒåˆ—è¡¨5 case list(page: Int)6 &#x2F;&#x2F;&#x2F;ä¸Šä¼ å¤´åƒ7 case updateAvatar(headImgUrl: String, headImgId: String)8 &#x2F;&#x2F;&#x2F;ä¼šå‘˜å¹¿å‘Šä¿¡æ¯ æŠ•æ”¾ä½ç½®: 1-æ•…äº‹æ’­æ”¾é¡µ;2-IPäº’åŠ¨é¡µ;3-å¤´åƒé¡µé¢;4-å®¶é•¿ä¸­å¿ƒ;5-ä¼šå‘˜é¢‘é“9 case userVipAdver(position: Int)10&#125;1112extension KSUserAvatarAPI: TargetType &#123;13 14 var baseURL: URL &#123;15 return URL(string: KSAppConfigEnvirenmentManager.default.Domain()) ?? URL(target: self)16 &#125;1718 var path: String &#123;19 switch self &#123;20 case .list:21 return KSNetworkBusinessAPIConstants.User.headList22 case .updateAvatar:23 return KSNetworkBusinessAPIConstants.User.headUpdate24 case .userVipAdver:25 return KSNetworkBusinessAPIConstants.User.userVipAdver26 &#125;27 &#125;2829 var method: Moya.Method &#123;30 switch self &#123;31 case .list,.userVipAdver:32 return .get33 case .updateAvatar:34 return .post35 &#125;36 &#125;3738 var task: Task &#123;39 switch self &#123;40 case let .list(page):41 let dict &#x3D; [&quot;pageNo&quot;: page, &quot;pageSize&quot;: 100]42 return .requestParameters(parameters: dict, encoding: URLEncoding.default)43 case let .updateAvatar(headImgUrl, headImgId):44 let dict &#x3D; [&quot;headImgUrl&quot;: headImgUrl, &quot;headImgId&quot;: headImgId]45 return .requestParameters(parameters: dict, encoding: JSONEncoding.default)46 case let .userVipAdver(position):47 let dict &#x3D; [&quot;position&quot;: position]48 return .requestParameters(parameters: dict, encoding: URLEncoding.default)49 &#125;50 &#125;5152 var sampleData: Data &#123;53 let text &#x3D; &quot;&quot;&quot;54 &quot;&quot;&quot;55 return text.data(using: .utf8) ?? Data()56 &#125;5758 var headers: [String: String]? &#123;59 return [&quot;Content-Type&quot;: &quot;application&#x2F;json&quot;]60 &#125;6162 var parameterEncoding: ParameterEncoding &#123;63 &#x2F;&#x2F;&#x2F; å‚æ•°é»˜è®¤è¿›è¡Œurlç¼–ç 64 return URLEncoding.default65 &#125;6667 var multipartBody: [Moya.MultipartFormData]? &#123;68 return nil69 &#125;70 71&#125; æ•°æ®æ¨¡å‹ KSUserAvatarModel1import ObjectMapper2import ObjectMapperAdditions34class KSUserAvatarModel: KSBaseModel &#123;5 6 &#x2F;&#x2F;&#x2F; æ€»æ•°é‡7 var totalCount &#x3D; 08 &#x2F;&#x2F;&#x2F; é¡µç 9 var pageNum &#x3D; 010 &#x2F;&#x2F;&#x2F; æ¯é¡µçš„æ•°é‡11 var pageSize &#x3D; 012 &#x2F;&#x2F;&#x2F; æ€»é¡µæ•°13 var totalPage &#x3D; 01415 &#x2F;&#x2F;&#x2F; åˆ—è¡¨16 var list: [Item] &#x3D; []17 18 override func mapping(map: Map) &#123;19 super.mapping(map: map)20 totalCount &lt;- (map[&quot;totalCount&quot;], IntTransform())21 list &lt;- map[&quot;list&quot;]22 pageNum &lt;- (map[&quot;pageNum&quot;], IntTransform())23 pageSize &lt;- (map[&quot;pageSize&quot;], IntTransform())24 totalPage &lt;- (map[&quot;totalPage&quot;], IntTransform())25 &#125;26 27 class Item: KSBaseModel &#123;28 29 &#x2F;&#x2F;&#x2F; è™šæ‹Ÿå•†å“id30 var virtualId &#x3D; &quot;&quot;31 &#x2F;&#x2F;&#x2F; å›¾ç‰‡åœ°å€32 var backGroundImg &#x3D; &quot;&quot;33 &#x2F;&#x2F;&#x2F; å¤´åƒç±»å‹free-å…è´¹member-ä¼šå‘˜34 var exchangeType &#x3D; &quot;&quot;35 &#x2F;&#x2F;&#x2F; æ˜¯å¦å±•ç¤ºä¸Šæ–°å›¾æ ‡trueæ˜¾ç¤ºfalseä¸æ˜¾ç¤º36 var isShowNewIcon &#x3D; false37 &#x2F;&#x2F;&#x2F; æ˜¯å¦å±•ç¤ºä¼šå‘˜å›¾æ ‡trueæ˜¾ç¤ºfalseä¸æ˜¾ç¤º38 var isShowMemberIcon &#x3D; false39 40 override func mapping(map: Map) &#123;41 super.mapping(map: map)42 virtualId &lt;- (map[&quot;virtualId&quot;], StringTransform())43 backGroundImg &lt;- (map[&quot;backGroundImg&quot;], StringTransform())44 exchangeType &lt;- (map[&quot;exchangeType&quot;], StringTransform())45 isShowNewIcon &lt;- (map[&quot;isShowNewIcon&quot;], BoolTransform())46 isShowMemberIcon &lt;- (map[&quot;isShowMemberIcon&quot;], BoolTransform())47 &#125;48 &#125;49&#125; KSUserAvatarListCell1import UIKit2import RxSwift3import RxCocoa45class KSUserAvatarListCell: KSBaseCollectionViewCell &#123;6 &#x2F;&#x2F;&#x2F; MARK: - Property7 private var disposeBag &#x3D; DisposeBag()8 9 &#x2F;&#x2F;&#x2F; MARK: - UI10 11 &#x2F;&#x2F;&#x2F; å¤´åƒèƒŒæ™¯å›¾12 private lazy var avatarBgImageView: UIImageView &#x3D; &#123;13 var imageView &#x3D; UIImageView()14 imageView.configueTheme([ksImage: ks_mine_pic_avatar_bg_default])15 return imageView16 &#125;()17 18 &#x2F;&#x2F;&#x2F; å¤´åƒ19 private lazy var avatarImageView: UIImageView &#x3D; &#123;20 var imageView &#x3D; UIImageView()21 imageView.cornerRadius &#x3D; 30.adaptor22 imageView.contentMode &#x3D; .scaleAspectFill23 return imageView24 &#125;()2526 &#x2F;&#x2F;&#x2F; ä¼šå‘˜iconæ ‡è¯†27 private lazy var vipIconImageView: UIImageView &#x3D; &#123;28 var imageView &#x3D; UIImageView()29 imageView.configueTheme([ksImage: ks_mine_icon_vip])30 return imageView31 &#125;()32 33 &#x2F;&#x2F;&#x2F; ä¸Šæ–°iconæ ‡è¯†34 private lazy var newIconImageView: UIImageView &#x3D; &#123;35 var imageView &#x3D; UIImageView()36 imageView.configueTheme([ksImage: ks_mine_tag_avatar_xin])37 return imageView38 &#125;()39 40 &#x2F;&#x2F;&#x2F; é€‰ä¸­iconæ ‡è¯†41 private lazy var selectIconImageView: UIImageView &#x3D; &#123;42 var imageView &#x3D; UIImageView()43 imageView.configueTheme([ksImage: ks_common_icon_select_blue_selected])44 return imageView45 &#125;()4647 48 &#x2F;&#x2F; MARK: - Setter49 public var cellViewModel: KSUserAvatarListCellViewModel? &#123;50 didSet &#123;51 guard let cellViewModel &#x3D; cellViewModel, let model &#x3D; cellViewModel.outputs.model.value else &#123; return &#125;52 53 cellViewModel.outputs.isSelected.asDriver().map &#123; [weak self] (selected) in54 guard let self &#x3D; self else &#123;return !selected&#125;55 56 self.avatarBgImageView.configueTheme([ksImage: selected ? ks_mine_pic_avatar_bg_select : ks_mine_pic_avatar_bg_default])57 return !selected58 &#125;.drive(selectIconImageView.rx.isHidden).disposed(by: disposeBag)5960 vipIconImageView.isHidden &#x3D; !model.isShowMemberIcon61 newIconImageView.isHidden &#x3D; !model.isShowNewIcon62 avatarImageView.ks_setImage(urlString: model.backGroundImg, placeholderImage: nil)63 &#125;64 &#125;65&#125;6667&#x2F;&#x2F; MARK: - Override68extension KSUserAvatarListCell &#123;69 70 override func prepareForReuse() &#123;71 super.prepareForReuse()72 disposeBag &#x3D; DisposeBag()73 &#125;74 75 override func configDefaultInit() &#123;76 super.configDefaultInit()77 &#125;78 79 override func configSubviews() &#123;80 super.configSubviews()81 contentView.addSubviews(avatarBgImageView, avatarImageView,vipIconImageView, newIconImageView, selectIconImageView)82 &#125;83 84 override func configLayoutSubviews() &#123;85 super.configLayoutSubviews()86 87 avatarBgImageView.snp.makeConstraints &#123; (make) in88 make.top.equalTo(15.adaptor)89 make.left.equalToSuperview()90 make.width.equalTo(71.adaptor)91 make.height.equalTo(77.adaptor)92 &#125;93 94 avatarImageView.snp.makeConstraints &#123; (make) in95 make.top.equalTo(avatarBgImageView).offset(5.adaptor)96 make.width.height.equalTo(60.adaptor)97 make.centerX.equalTo(avatarBgImageView)98 &#125;99 100 vipIconImageView.snp.makeConstraints &#123; (make) in101 make.top.equalTo(avatarBgImageView).offset(2.adaptor)102 make.right.equalTo(avatarBgImageView.snp.right).offset(-2.adaptor)103 make.width.height.equalTo(20.adaptor)104 &#125;105 106 newIconImageView.snp.makeConstraints &#123; (make) in107 make.left.equalTo(avatarBgImageView.snp.left).offset(-3.5.adaptor)108 make.top.equalTo(avatarBgImageView).offset(3.adaptor)109 make.width.height.equalTo(20.adaptor)110 &#125;111 112 selectIconImageView.snp.makeConstraints &#123; (make) in113 make.right.equalTo(avatarBgImageView)114 make.bottom.equalTo(avatarBgImageView).offset(-7.adaptor)115 make.width.height.equalTo(20.adaptor)116 &#125;117 &#125;118&#125; æ§åˆ¶å™¨ KSUserAvatarViewController1import UIKit2import RxSwift3import RxCocoa4import RxDataSources5import KSVipBusinessModule67class KSUserAvatarViewController: KSBaseCollectionViewController &#123;8 struct Style &#123;9 static let space: CGFloat &#x3D; 25.010 &#x2F;&#x2F;&#x2F; w 71 h 7711 static let cellWidth &#x3D; 71.012 static let cellHeight &#x3D; 100.013 &#125;1415 private let disposeBag &#x3D; DisposeBag()16 private let viewModel &#x3D; KSUserAvatarViewModel()17 18 private lazy var vipAdverManager: KSUserVipAdverManager &#x3D; &#123;19 let manager &#x3D; KSUserVipAdverManager()20 return manager21 &#125;()2223 &#x2F;&#x2F;&#x2F; MARK: - UI24 25 &#x2F;&#x2F;&#x2F; èƒŒæ™¯å›¾26 private lazy var backgroundImageView: UIImageView &#x3D; &#123;27 let imageView &#x3D; UIImageView()28 imageView.configueTheme([ksImage: ks_mine_pic_avatar_big_bg])29 imageView.contentMode &#x3D; .scaleAspectFill30 return imageView31 &#125;()32 33 &#x2F;&#x2F;&#x2F;å¤´åƒè§†å›¾34 private lazy var avatarView: KSAvatarView &#x3D; &#123;35 let avatarView &#x3D; KSAvatarView()36 return avatarView37 &#125;()3839 &#x2F;&#x2F;&#x2F;ä¼šå‘˜å¼•å¯¼èƒŒæ™¯å›¾40 private lazy var vipGuideButton: UIButton &#x3D; &#123;41 let button &#x3D; UIButton()42 button.configueTheme([ksBackgroundImageNormal: ks_common_pic_vip_guide_bg])43 button.configueTheme([ksTitleColorNormal: ksFFFFFF])44 button.titleLabel?.font &#x3D; 12.adaptor_Int.font_regular45 button.setTitle(&quot;ä¼šå‘˜ç•…ç”¨å¤´åƒ&quot;, for: .normal)46 button.titleEdgeInsets &#x3D; UIEdgeInsets(top: 0, left: 22.adaptor, bottom: 0, right: 0)47 return button48 &#125;()49 50 &#x2F;&#x2F;&#x2F;æ˜µç§°51 private lazy var nickNameLabel: UILabel &#x3D; &#123;52 let label &#x3D; UILabel()53 label.configueTheme([ksTextColor: ks4A4A4A])54 label.font &#x3D; 20.adaptor_Int.font_hyzy_regular55 label.text &#x3D; &quot;æ˜µç§°&quot;56 return label57 &#125;()5859 &#x2F;&#x2F;&#x2F;ä¼šå‘˜icon60 private lazy var vipIconImageView: UIImageView &#x3D; &#123;61 let imageView &#x3D; UIImageView()62 imageView.configueTheme([ksImage : ks_common_icon_vip_default])63 return imageView64 &#125;()65 66 &#x2F;&#x2F;&#x2F;è·å–å¤´åƒæŒ‰é’®67 private lazy var chooseAvatarbutton: UIButton &#x3D; &#123;68 let button &#x3D; UIButton()69 button.configueTheme([ksBackgroundImageNormal: ks_vip_btn_re_kaitong])70 button.configueTheme([ksTitleColorNormal: ksFFFFFF])71 button.titleLabel?.font &#x3D; 17.adaptor_Int.font_hyzy_regular72 button.setTitle(&quot;è·å–å¤´åƒ&quot;, for: .normal)73 button.isHidden &#x3D; true74 return button75 &#125;()76 77 &#x2F;&#x2F;&#x2F;åˆ—è¡¨èƒŒæ™¯å›¾78 private lazy var collectionBgImageView: UIImageView &#x3D; &#123;79 let imageView &#x3D; UIImageView()80 imageView.configueTheme([ksImage : ks_mine_pic_avatar_select_bg])81 return imageView82 &#125;()83 84 &#x2F;&#x2F;&#x2F;åˆ—è¡¨é®ç½©å›¾85 private lazy var collectionMaskImageView: UIImageView &#x3D; &#123;86 let imageView &#x3D; UIImageView()87 imageView.configueTheme([ksImage : ks_mine_pic_avatar_select_mask])88 return imageView89 &#125;()90&#125;9192&#x2F;&#x2F; MARK: - Request93extension KSUserAvatarViewController &#123;94 95 &#x2F;&#x2F;&#x2F; åˆ·æ–°96 override func configRefresh() &#123;97 super.configRefresh()98 viewModel.inputs.reload.onNext(false)99 &#125;100101 &#x2F;&#x2F;&#x2F; åŠ è½½æ›´å¤š102 override func configLoadMore() &#123;103 super.configLoadMore()104 viewModel.inputs.reload.onNext(true)105 &#125;106107 &#x2F;&#x2F;&#x2F; è‡ªåŠ¨è§¦å‘ç½‘ç»œè¯·æ±‚108 override func configRequestData() &#123;109 super.configRequestData()110 111 viewModel.inputs.reload.onNext(false)112 113 viewModel.outputs.refreshState.subscribe(onNext: &#123; [weak self] (tuple) in114 guard let self &#x3D; self else &#123; return &#125;115 guard let hasMore &#x3D; tuple.hasMore else &#123;116 self.configEndRefresh()117 return118 &#125;119 if tuple.loadMore &#123;120 hasMore ? self.endFooterRefreshing() : self.endRefreshingWithNoMoreData()121 &#125; else &#123;122 self.endHeaderRefreshing()123 hasMore ? self.resetNoMoreData() : self.endRefreshingWithNoMoreData()124 &#125;125126 &#125;).disposed(by: disposeBag)127 &#125;128129 &#x2F;&#x2F;&#x2F; æ‰‹åŠ¨è§¦å‘ç½‘ç»œè¯·æ±‚ï¼Œéœ€è¦è‡ªå·±è°ƒç”¨130 override func configRequestDataManual() &#123;131 super.configRequestDataManual()132 &#125;133&#125;134135&#x2F;&#x2F; MARK: - Override136extension KSUserAvatarViewController &#123;137 override func viewWillAppear(_ animated: Bool) &#123;138 super.viewWillAppear(animated)139 navigationController?.setNavigationBarHidden(true, animated: false)140 &#125;141 142 override func viewDidDisappear(_ animated: Bool) &#123;143 super.viewDidDisappear(animated)144 navigationController?.setNavigationBarHidden(false, animated: false)145 &#125;146 147 override func viewDidLoad() &#123;148 super.viewDidLoad()149 &#x2F;&#x2F;&#x2F;å±•ç¤ºå½“å‰å¤´åƒä¿¡æ¯150 configWithUserInfo()151 &#125;152 153 override func configDefaultInit() &#123;154 super.configDefaultInit()155 showBackButton &#x3D; true156 if #available(iOS 11.0, *) &#123;157 collectionView.contentInsetAdjustmentBehavior &#x3D; .never158 &#125; else &#123;159 automaticallyAdjustsScrollViewInsets &#x3D; false160 &#125;161 collectionView.showsHorizontalScrollIndicator &#x3D; false162 collectionView.backgroundColor &#x3D; .clear163 164 if let layout &#x3D; collectionView.collectionViewLayout as? UICollectionViewFlowLayout &#123;165 layout.itemSize &#x3D; CGSize(width: Style.cellWidth, height: Style.cellHeight)166 layout.minimumLineSpacing &#x3D; Style.space167 layout.minimumInteritemSpacing &#x3D; 0168 layout.sectionInset &#x3D; .zero169 layout.scrollDirection &#x3D; .horizontal170 &#125;171 collectionView.isPagingEnabled &#x3D; false172 &#125;173 174 override func configSubviews() &#123;175 super.configSubviews()176 view.addSubviews(backgroundImageView,avatarView,vipGuideButton,nickNameLabel,vipIconImageView,chooseAvatarbutton,collectionBgImageView,collectionView,collectionMaskImageView)177178 &#125;179 180 override func configLayoutSubviews() &#123;181 super.configLayoutSubviews()182 183 backgroundImageView.snp.makeConstraints &#123; (make) in184 make.edges.equalTo(0)185 &#125;186 187 avatarView.snp.makeConstraints &#123; (make) in188 make.top.equalTo(52.adaptor)189 make.centerX.equalToSuperview()190 make.width.equalTo(104)191 make.height.equalTo(108)192 &#125;193194 vipGuideButton.snp.makeConstraints &#123; (make) in195 make.top.equalTo(20.adaptor)196 make.right.equalTo(-20.adaptor)197 make.width.equalTo(128.adaptor)198 make.height.equalTo(32.5.adaptor)199 &#125;200201 nickNameLabel.snp.makeConstraints &#123; (make) in202 make.top.equalTo(avatarView.snp.bottom).offset(10)203 make.centerX.equalTo(avatarView)204 &#125;205206 vipIconImageView.snp.makeConstraints &#123; (make) in207 make.left.equalTo(nickNameLabel.snp.right).offset(2.adaptor)208 make.width.height.equalTo(24.adaptor)209 make.centerY.equalTo(nickNameLabel)210 &#125;211212 chooseAvatarbutton.snp.makeConstraints &#123; (make) in213 make.top.equalTo(nickNameLabel.snp.bottom).offset(14.adaptor)214 make.width.equalTo(131.adaptor)215 make.height.equalTo(47.5.adaptor)216 make.centerX.equalToSuperview()217 &#125;218219 collectionBgImageView.snp.makeConstraints &#123; (make) in220 make.left.right.bottom.equalTo(0)221 make.height.equalTo(Style.cellHeight)222 &#125;223 224 collectionView.snp.makeConstraints &#123; make in225 make.edges.equalTo(collectionBgImageView)226 &#125;227 228 collectionMaskImageView.snp.makeConstraints &#123; make in229 make.edges.equalTo(collectionBgImageView)230 &#125;231 &#125;232 233 override func configBindSubviews() &#123;234 super.configBindSubviews()235 collectionView.rx.setDelegate(self).disposed(by: disposeBag)236 collectionView.registerReusableCell(ofType: KSUserAvatarListCell.self)237 &#125;238 239 override func configBind() &#123;240 super.configBind()241 &#x2F;&#x2F; 1. ä¿¡å·åˆ›å»º242 let selectedType &#x3D; Driver.zip(collectionView.rx.itemSelected.asDriver(), collectionView.rx.modelSelected(KSUserAvatarListCellViewModel.self).asDriver())243 let outputs &#x3D; viewModel.transform(inputs: KSUserAvatarViewModel.Inputs(selectedType: selectedType))244 245 &#x2F;&#x2F; 2. ä¿¡å·ç»‘å®š246 let dataSource &#x3D; RxCollectionViewSectionedReloadDataSource&lt;SectionModel&lt;String, KSUserAvatarListCellViewModel&gt;&gt;(247 configureCell: &#123; (dataSource, collectionView, indexPath, item) in248 let cell &#x3D; collectionView.dequeueReusableCell(ofType: KSUserAvatarListCell.self, at: indexPath)249 cell.cellViewModel &#x3D; item250 return cell251 &#125; 252 )253 254 outputs.dataArray.asDriver(onErrorJustReturn: []).drive(collectionView.rx.items(dataSource: dataSource)).disposed(by: disposeBag)255 256 outputs.dataArray.subscribe(onNext: &#123; [weak self] (_) in257 guard let self &#x3D; self, !self.viewModel.outputs.dataArray.value.isEmpty, let section &#x3D; self.viewModel.outputs.dataArray.value.objectAt(0) else &#123; return &#125;258259 &#x2F;&#x2F;&#x2F;å–ç”¨æˆ·è´¦æˆ·ä¿¡æ¯260 let headImgId &#x3D; KSBusinessUserManager.default.fetchCurrentUserinfo()?.headImgId261262 for (pageIndex,cellViewModel) in section.items.enumerated() &#123;263 if headImgId &#x3D;&#x3D; cellViewModel.outputs.model.value?.virtualId &#123;264 cellViewModel.outputs.isSelected.accept(true)265 self.chooseAvatarbutton.isHidden &#x3D; true266 self.viewModel.outputs.headImgId.accept(headImgId ?? &quot;&quot;)267 268 &#x2F;&#x2F;&#x2F;æ›´æ”¹collectionviewcellä½ç½®269 DispatchQueue.main.asyncAfter(deadline: .now() + 0.25) &#123;270 if self.collectionView.contentSize.height &#x3D;&#x3D; 0 &#123; return &#125;271 self.collectionView.layoutIfNeeded()272 self.collectionView.scrollToItem(at: IndexPath(item: pageIndex, section: 0), at: .centeredVertically, animated: false)273 &#125;274 break275 &#125;276 &#125;277 278 &#125;).disposed(by: disposeBag)279 280 viewModel.inputs.selectedType.throttle(.seconds(1), latest: false).drive(onNext: &#123; [weak self] tuple in281 guard let self &#x3D; self , let section &#x3D; self.viewModel.outputs.dataArray.value.objectAt(0) else &#123;return&#125;282 283 let cellViewModel &#x3D; section.items.objectAt(tuple.0.item)284 285 &#x2F;&#x2F;&#x2F;è®¾ç½®å¤´åƒ286 self.avatarView.updateAvatar(url: cellViewModel?.outputs.model.value?.backGroundImg ?? &quot;&quot;)287 288 &#x2F;&#x2F;&#x2F;åˆ¤æ–­æ˜¯æ­£åœ¨ä½¿ç”¨çš„å¤´åƒ289 if cellViewModel?.outputs.model.value?.virtualId &#x3D;&#x3D; self.viewModel.outputs.headImgId.value &#123;290 self.chooseAvatarbutton.isHidden &#x3D; true291 &#125; else &#123;292 self.chooseAvatarbutton.isHidden &#x3D; false293 &#125;294295 &#125;).disposed(by: disposeBag)296 297 &#x2F;&#x2F;&#x2F;å¤´åƒæ›´æ–°æˆåŠŸ298 viewModel.outputs.updateAvatarSuccessed.subscribe(onNext: &#123; [weak self] _ in299 guard let self &#x3D; self else &#123;return&#125;300 self.chooseAvatarbutton.isHidden &#x3D; true301 self.avatarView.updateAvatar(url: self.viewModel.outputs.selectedModel.value?.backGroundImg ?? &quot;&quot;)302303 KSToast.makeToast(&quot;å¤´åƒè®¾ç½®æˆåŠŸå•¦~&quot;, position: .center)304 &#125;).disposed(by: disposeBag)305 306 &#x2F;&#x2F;&#x2F;ä¼šå‘˜å¼•å¯¼ç‚¹å‡»äº‹ä»¶307 vipGuideButton.rx.tap.throttle(.seconds(1), latest: false, scheduler: MainScheduler.instance).subscribe(onNext: &#123; _ in308 KSPageJumpCenterTool.linkToWithPage(&quot;RNMemberPurchase&quot;)309 &#125;).disposed(by: disposeBag)310 311 &#x2F;&#x2F;&#x2F;ä¿®æ”¹å¤´åƒäº‹ä»¶312 chooseAvatarbutton.rx.tap.throttle(.seconds(1), latest: false, scheduler: MainScheduler.instance).subscribe(onNext: &#123; [weak self] _ in313 guard let self &#x3D; self else &#123;return&#125;314 guard let model &#x3D; self.viewModel.outputs.selectedModel.value else &#123;315 &#x2F;&#x2F;&#x2F;æœªé€‰æ‹©å¤´åƒ316 return317 &#125;318 319 let vipStatus &#x3D; KSVipBusinessManager.default.vipStatus()320 if model.isShowMemberIcon &#x3D;&#x3D; true &amp;&amp; vipStatus !&#x3D; .normal &#123;321 &#x2F;&#x2F;&#x2F;éä¼šå‘˜èº«ä»½é€‰æ‹©ä¼šå‘˜å¤´åƒ éœ€è¦å¼¹å‡ºå¼€é€šä¼šå‘˜å¼•å¯¼å¼¹çª—322 &#x2F;&#x2F;&#x2F;è¯·æ±‚ä¼šå‘˜å¹¿å‘Šä¿¡æ¯323 self.vipAdverManager.configUserVipAdver(3)324 &#125;325 self.viewModel.inputs.updateAvatar.onNext(())326327 &#125;).disposed(by: disposeBag)328 &#125;329&#125;330331&#x2F;&#x2F; MARK: - Private332333extension KSUserAvatarViewController &#123;334 &#x2F;&#x2F;&#x2F;è¿›æ¥é¡µé¢å±•ç¤ºå¤´åƒä¿¡æ¯335 private func configWithUserInfo() &#123;336 guard let userInfo &#x3D; KSBusinessUserManager.default.fetchCurrentUserinfo() else &#123;337 return338 &#125;339 avatarView.updateAvatar(url: userInfo.headImgUrl)340 341 nickNameLabel.text &#x3D; userInfo.nickname342 343 let vipStatus &#x3D; KSVipBusinessManager.default.vipStatus()344 if vipStatus &#x3D;&#x3D; .unknow &#123;345 &#x2F;&#x2F;&#x2F;æœªå¼€é€š346 vipGuideButton.isHidden &#x3D; false347 vipIconImageView.isHidden &#x3D; true348349 &#125; else if vipStatus &#x3D;&#x3D; .normal &#123;350 &#x2F;&#x2F;&#x2F;å·²å¼€é€š351 vipGuideButton.isHidden &#x3D; true352 vipIconImageView.isHidden &#x3D; false353 vipIconImageView.configueTheme([ksImage : ks_common_icon_vip_default])354355 &#125; else &#123;356 &#x2F;&#x2F;&#x2F;ä¼šå‘˜å¤±æ•ˆ357 vipGuideButton.isHidden &#x3D; true358 vipIconImageView.isHidden &#x3D; false359 vipIconImageView.configueTheme([ksImage : ks_common_icon_vip_expired])360 &#125;361 &#125;362&#125;363364&#x2F;&#x2F; MARK: - UICollectionViewDelegate365extension KSUserAvatarViewController: UICollectionViewDelegate, UICollectionViewDelegateFlowLayout &#123;366&#125; KSUserAvatarViewModel1import UIKit2import RxSwift3import RxCocoa4import RxDataSources56class KSUserAvatarViewModel: KSBaseViewModel, KSBaseViewModelProtocol &#123;7 8 private let disposeBag &#x3D; DisposeBag()9 private let provider &#x3D; KSNetworkCommonManager.provider(KSUserAvatarAPI.self, stub: false, log: true)10 private var page &#x3D; 111 12 &#x2F;&#x2F;&#x2F; MARK: - ä¿¡å·13 &#x2F;&#x2F;&#x2F; è¾“å…¥æº &lt;è®¢é˜…&gt;14 public var inputs &#x3D; Inputs()15 public struct Inputs &#123;16 &#x2F;&#x2F;&#x2F; åˆ·æ–°åˆ—è¡¨17 var reload: PublishSubject&lt;Bool&gt; &#x3D; PublishSubject&lt;Bool&gt;()18 &#x2F;&#x2F;&#x2F; æ›´æ–°å¤´åƒè¯·æ±‚19 var updateAvatar: PublishSubject&lt;Void&gt; &#x3D; PublishSubject&lt;Void&gt;()20 &#x2F;&#x2F;&#x2F; cellç‚¹å‡»21 var selectedType: Driver&lt;(IndexPath, KSUserAvatarListCellViewModel)&gt; &#x3D; Driver.empty()22 &#125;23 24 &#x2F;&#x2F;&#x2F; è¾“å‡ºæº &lt;å‘é€&gt;25 public var outputs &#x3D; Outputs()26 public struct Outputs &#123;27 &#x2F;&#x2F;&#x2F; åŠ è½½çŠ¶æ€28 var loadingState: PublishSubject&lt;LoadingState&gt; &#x3D; PublishSubject&lt;LoadingState&gt;()29 &#x2F;&#x2F;&#x2F; åˆ·æ–°çŠ¶æ€30 var refreshState: PublishSubject&lt;(loadMore: Bool, hasMore: Bool?)&gt; &#x3D; PublishSubject&lt;(loadMore: Bool, hasMore: Bool?)&gt;()31 &#x2F;&#x2F;&#x2F; æ›´æ–°å¤´åƒæˆåŠŸ32 var updateAvatarSuccessed: PublishSubject&lt;Void&gt; &#x3D; PublishSubject&lt;Void&gt;()3334 &#x2F;&#x2F;&#x2F; æ•°æ®æº ï¼ˆå¸¸ç”¨BehaviorRelayï¼Œæ–¹ä¾¿valueæ“ä½œï¼Œå¹¶é€šè¿‡acceptå‘å‡ºä¿¡å·ï¼‰35 var dataArray: BehaviorRelay&lt;[SectionModel&lt;String, KSUserAvatarListCellViewModel&gt;]&gt; &#x3D; BehaviorRelay(value: [])36 &#x2F;&#x2F;&#x2F;å½“å‰çš„å¤´åƒid37 var headImgId: BehaviorRelay&lt;String&gt; &#x3D; BehaviorRelay(value: &quot;&quot;)38 &#x2F;&#x2F;&#x2F;å½“å‰é€‰ä¸­çš„å¤´åƒmodel39 var selectedModel: BehaviorRelay&lt;KSUserAvatarModel.Item?&gt; &#x3D; BehaviorRelay(value: nil)40 &#125;41 42 &#x2F;&#x2F;&#x2F; ä¿¡å·è½¬æ¢43 public func transform(inputs: Inputs) -&gt; Outputs &#123;44 self.inputs &#x3D; inputs45 46 &#x2F;&#x2F;&#x2F; è¯·æ±‚å¤´åƒåˆ—è¡¨ç½‘ç»œè¯·æ±‚47 inputs.reload.subscribe(onNext: &#123; [weak self] loadMore in48 self?.requestList(loadMore)49 &#125;).disposed(by: disposeBag)5051 &#x2F;&#x2F;&#x2F;æ›´æ–°å¤´åƒç½‘ç»œè¯·æ±‚52 inputs.updateAvatar.subscribe(onNext: &#123; [weak self] _ in53 guard let self &#x3D; self else &#123;return&#125;54 let headImgUrl &#x3D; self.outputs.selectedModel.value?.backGroundImg55 let headImgId &#x3D; self.outputs.selectedModel.value?.virtualId56 self.requestUpdateAvatar(headImgUrl ?? &quot;&quot;, headImgId ?? &quot;&quot;)5758 &#125;).disposed(by: disposeBag)59 60 &#x2F;&#x2F;&#x2F; é€‰æ‹©cell61 inputs.selectedType.drive(onNext: &#123; [weak self] tuple in62 guard let self &#x3D; self , let section &#x3D; self.outputs.dataArray.value.objectAt(0) else &#123;return&#125;63 64 &#x2F;&#x2F;&#x2F;è®°å½•é€‰ä¸­çš„å¤´åƒä¿¡æ¯model65 self.outputs.selectedModel.accept(section.items.objectAt(tuple.0.item)?.outputs.model.value)66 67 for (i, cellViewModel) in section.items.enumerated() &#123;68 &#x2F;&#x2F;&#x2F;tupleå…ƒç¥– ( IndexPath, KSUserAvatarListCellViewModel )69 cellViewModel.outputs.isSelected.accept(tuple.0.item &#x3D;&#x3D; i)70 &#125; 71 &#125;).disposed(by: disposeBag)72 73 &#x2F;&#x2F;&#x2F; viewModel -&gt; ä¿¡å·74 outputs.dataArray.subscribe(onNext: &#123; (_) in75 76 &#125;).disposed(by: disposeBag)77 78 return outputs79 &#125;80&#125;8182extension KSUserAvatarViewModel &#123;83 84 &#x2F;&#x2F;&#x2F; åˆ—è¡¨æ•°æ®è¯·æ±‚85 private func requestList(_ loadMore: Bool) &#123;86 self.outputs.loadingState.onNext(.loading)87 let tempPage &#x3D; loadMore ? page + 1 : 18889 KSNetworkCommonManager.default.requestWithRxSwift(provider: provider, target: KSUserAvatarAPI.list(page: page), dataType: KSResponse&lt;KSUserAvatarModel&gt;.self).subscribe(onNext: &#123; [weak self] (result) in90 guard let self &#x3D; self else &#123; return &#125;91 guard let data &#x3D; result.data, result.code &#x3D;&#x3D; KSNetworkCommonConstants.Code.codeSuccess else &#123;92 self.outputs.loadingState.onNext(.fail)93 self.outputs.refreshState.onNext((loadMore: loadMore, hasMore: nil))94 return95 &#125;96 97 self.page &#x3D; tempPage98 self.outputs.loadingState.onNext(.success)99 self.outputs.refreshState.onNext((loadMore: loadMore, hasMore: !data.list.isEmpty))100 &#x2F;&#x2F;&#x2F;é…ç½®æ•°æ®æº101 self.configDataArray(loadMore, data)102103 &#125;, onError: &#123; [weak self] (error) in104 guard let self &#x3D; self else &#123; return &#125;105 self.outputs.loadingState.onNext(.fail)106 self.outputs.refreshState.onNext((loadMore: loadMore, hasMore: nil))107108 &#125;).disposed(by: disposeBag)109 &#125;110 111 &#x2F;&#x2F;&#x2F;æ›´æ–°å¤´åƒæ¥å£è¯·æ±‚112 private func requestUpdateAvatar(_ headImgUrl: String, _ headImgId: String) &#123;113 KSNetworkCommonManager.default.requestWithRxSwift(provider: provider, target: KSUserAvatarAPI.updateAvatar(headImgUrl: headImgUrl, headImgId: headImgId), dataType: KSResponse&lt;KSUserAvatarModel&gt;.self).subscribe(onNext: &#123; [weak self] (result) in114 guard let self &#x3D; self else &#123; return &#125;115 guard result.code &#x3D;&#x3D; KSNetworkCommonConstants.Code.codeSuccess else &#123;116 KSToast.makeToast(result.message, position: .center)117 return118 &#125;119 &#x2F;&#x2F;&#x2F;è®°å½•æ›´æ–°å®Œçš„å¤´åƒid120 self.outputs.headImgId.accept(headImgId)121 self.outputs.updateAvatarSuccessed.onNext(())122123 &#125;, onError: &#123; (error) in124125 &#125;).disposed(by: disposeBag)126 &#125;127 128 &#x2F;&#x2F;&#x2F;é…ç½®åˆ—è¡¨æ•°æ®æº129 private func configDataArray(_ loadMore: Bool ,_ model: KSUserAvatarModel) &#123;130 DispatchQueue.global().async &#123;131 &#x2F;&#x2F;&#x2F; 1. åˆ—è¡¨æ•°æ®æº132 var dataArray: [SectionModel&lt;String, KSUserAvatarListCellViewModel&gt;] &#x3D; []133 &#x2F;&#x2F;&#x2F; 2. cellViewModelæ•°ç»„134 var items: [KSUserAvatarListCellViewModel] &#x3D; []135 136 for listModel in model.list &#123;137 items.append(KSUserAvatarListCellViewModel(listModel))138 &#125;139140 var sectionModel: SectionModel&lt;String, KSUserAvatarListCellViewModel&gt; &#x3D; SectionModel(model: &quot;&quot;, items: items)141 sectionModel.items &#x3D; items142 dataArray.append(sectionModel)143144 DispatchQueue.main.async &#123;145 if loadMore &#123;146 &#x2F;&#x2F;&#x2F;åŠ è½½147 self.outputs.dataArray.accept(self.outputs.dataArray.value + dataArray)148 &#125; else &#123;149 &#x2F;&#x2F;&#x2F;åˆ·æ–°150 self.outputs.dataArray.accept(dataArray)151 &#125;152 &#125;153 &#125;154 &#125;155 156 func test() &#123;157 let text &#x3D; &quot;&quot;&quot;158 &#123;159 &quot;list&quot;: [160 &#123;161 &quot;backGroundImg&quot;: &quot;http:&#x2F;&#x2F;3a3d0ca5-e784-437b-b3af-8f779cf275a0_info.png&quot;,162 &quot;virtualId&quot;: &quot;98124124&quot;,163 &quot;exchangeType&quot;: &quot;free&quot;,164 &quot;isShowNewIcon&quot;: true,165 &quot;isShowMemberIcon&quot;: false166 &#125;167 ]168 &#125;169 &quot;&quot;&quot;170 guard let model &#x3D; KSUserAvatarModel(JSONString: text) else &#123;171 return172 &#125;173 self.configDataArray(false, model)174 &#125;175&#125;","categories":[{"name":"RxSwift","slug":"RxSwift","permalink":"http://yoursite.com/categories/RxSwift/"}],"tags":[{"name":"iOS","slug":"iOS","permalink":"http://yoursite.com/tags/iOS/"}]},{"title":"blockåˆ†æ","slug":"blockåˆ†æ","date":"2020-07-03T06:56:33.000Z","updated":"2020-07-03T07:12:51.000Z","comments":true,"path":"2020/2020-07-03-14:56:33/","link":"","permalink":"http://yoursite.com/2020/2020-07-03-14:56:33/","excerpt":"Block å†…å­˜ç®¡ç†ï¼Œ__blockä¿®é¥°å˜é‡å€¼çš„åŸç†","text":"Block å†…å­˜ç®¡ç†ï¼Œ__blockä¿®é¥°å˜é‡å€¼çš„åŸç† é¦–å…ˆçœ‹ä¸€ä¸‹block çš„ç»“æ„ä½“ï¼š 1struct __block__testBlock_block_impl_0 &#123;2 struct __block_impl impl;3 struct __block__testBlock_block_desc_0* Desc;4 int i;5 __unsafe_unretained id unsafe_obj;6 __strong id strong_obj;7 int *static_int;8 __block__testBlock_block_impl_0(void *fp, struct __block__testBlock_block_desc_0 *desc, int _i, __unsafe_unretained id _unsafe_obj, __strong id _strong_obj, int *_static_int, int flags&#x3D;0) : i(_i), unsafe_obj(_unsafe_obj), strong_obj(_strong_obj), static_int(_static_int) &#123;9 impl.isa &#x3D; &amp;_NSConcreteStackBlock;10 impl.Flags &#x3D; flags;11 impl.FuncPtr &#x3D; fp;12 Desc &#x3D; desc;13 &#125;14&#125;; impl.isa = &amp;_NSConcreteStackBlock;ç”¨æ¥æ ‡è¯†æ˜¯å“ªç§ç±»å‹çš„ block ä¸‰ç§blockç±»å‹ï¼š 11. _NSConcreteGlobalBlock &#x2F;&#x2F; å…¨å±€block22. _NSConcreteStackBlock &#x2F;&#x2F; æ ˆblock33. _NSConcreteMallocBlock &#x2F;&#x2F; å † block block çš„ copy æ“ä½œ,ä¿®æ”¹å€¼çš„åŸç†ï¼Œ__forwarding ä½œç”¨ blcokç±»å‹ åŸä½ç½® copyä¹‹åçš„ç»“æœ _NSConcreteStackBlock æ ˆ å † _NSConcreteStackBlock æ•°æ®åŒº ä¸åšä»»ä½•äº‹æƒ… _NSConcreteMallocBlock å † å¢åŠ å¼•ç”¨è®¡æ•° æ ˆblockåœ¨ä½œç”¨åŸŸç»“æŸä¹‹åï¼Œå¯¹åº”çš„blockä¹Ÿä¼šé”€æ¯ å½“åœ¨æ ˆä¸Šå¯¹blockè¿›è¡Œcopyä¹‹åï¼Œä¼šåœ¨å †ä¸Šcopyä¸€ä»½ï¼Œå½“æ ˆä¸Šå˜é‡ä½œç”¨äºç»“æŸä¹‹åï¼Œæ ˆblock ä¼šé”€æ¯ï¼Œä½†æ˜¯å †ä¸Šä¼šå­˜åœ¨ã€‚ æ‰€ä»¥åœ¨mrcå¯¹blockcopyä¹‹åï¼Œå®¹æ˜“é€ æˆå†…å­˜æ³„æ¼ï¼Œå› ä¸ºå †ä¸Šæ²¡æœ‰é‡Šæ”¾. æˆ‘ä»¬çš„æ ˆä¸Š block æœ‰ä¸€ä¸ª __Block å˜é‡ï¼ŒåŒæ—¶è¿˜æœ‰ä¸ª__forwarding æŒ‡é’ˆï¼ŒæŒ‡å‘ä»–è‡ªå·±ï¼Œå½“è¿›è¡Œcopyä¹‹åï¼Œä¼šåœ¨å †ä¸Šä¹Ÿæœ‰ä¸€ä»½ï¼ŒåŒæ—¶ä¹Ÿä¼šæœ‰ï¼Œ __Blockå˜é‡å’Œ __forwarding æŒ‡é’ˆï¼Œè¿™é‡Œé¢çš„__forwardingæŒ‡é’ˆçš„ç”¨é€”æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå½“è¿›è¡Œcopyä¹‹åï¼Œæ ˆä¸Šçš„__forwardingæŒ‡é’ˆæŒ‡å‘å †ä¸Šçš„ __Blockå˜é‡,è€Œå †ä¸Šçš„__forwardingæŒ‡é’ˆï¼Œä¹ŸæŒ‡å‘è‡ªèº«çš„__Blockå˜é‡,æ‰€ä»¥å½“æˆ‘ä»¬è¦ä¿®æ”¹ä¸€ä¸ªå€¼å¾—æ—¶å€™ç”¨ __BlockæŒ‡é’ˆæ¥ä¿®é¥°,åŸå› æ˜¯ï¼Œè¿™æ—¶å€™å·²ç»å°†æ ˆä¸Šé¢çš„blockï¼Œcopyåˆ°äº†å †ä¸Šé¢ï¼Œå½“æˆ‘ä»¬ä¿®æ”¹å˜é‡çš„å€¼å¾—æ—¶å€™ï¼Œå…¶å®å°±æ˜¯é€šè¿‡æ ˆä¸Šé¢çš„é‚£ä¸ª__forwardingæŒ‡é’ˆæ‰¾åˆ°å †ä¸Šé¢çš„__blockå˜é‡ï¼Œç„¶åä¿®æ”¹å †ä¸Šé¢çš„__Blockä¿®é¥°çš„å˜é‡çš„å€¼ï¼Œå¦‚æœæˆ‘ä»¬è¿™ä¸ªblockè¢«æˆå‘˜å˜é‡æˆ–è€…å…¶ä»–åœ°æ–¹æŒæœ‰çš„è¯ï¼Œé‚£ä¹ˆå®é™…ä¸Šå°±æ˜¯é€šè¿‡å †ä¸Šé¢è‡ªèº«çš„å˜é‡çš„å€¼ï¼Œæ‰€ä»¥å¯ä»¥æ€»ç»“ï¼Œå½“æˆ‘ä»¬çš„æ ˆblockç»è¿‡copyä¹‹åï¼Œå †ä¸Šé¢ä¼šæœ‰ä¸€ä»½ï¼Œéƒ½æ˜¯é€šè¿‡ __forwardingæŒ‡é’ˆï¼Œæ‰¾åˆ°__blockå˜é‡ï¼Œç„¶åä¿®æ”¹ä»–çš„å€¼ã€‚","categories":[],"tags":[{"name":"iOS","slug":"iOS","permalink":"http://yoursite.com/tags/iOS/"}]},{"title":"iOS å†…å­˜å¸ƒå±€&å†…å­˜ç®¡ç†æ–¹æ¡ˆ","slug":"iOS-å†…å­˜å¸ƒå±€-å†…å­˜ç®¡ç†æ–¹æ¡ˆ","date":"2020-07-02T10:45:13.000Z","updated":"2020-07-03T02:31:48.000Z","comments":true,"path":"2020/2020-07-02-18:45:13/","link":"","permalink":"http://yoursite.com/2020/2020-07-02-18:45:13/","excerpt":"å†…å­˜å¸ƒå±€-äº”å¤§åŒº","text":"å†…å­˜å¸ƒå±€-äº”å¤§åŒº æ ˆåŒº 0x7 åˆ›å»ºä¸´æ—¶å˜é‡æ—¶ç”±ç¼–è¯‘å™¨è‡ªåŠ¨åˆ†é…ï¼Œåœ¨ä¸éœ€è¦çš„æ—¶å€™è‡ªåŠ¨æ¸…é™¤çš„å˜é‡çš„å­˜å‚¨åŒºã€‚é‡Œé¢çš„å˜é‡é€šå¸¸æ˜¯å±€éƒ¨å˜é‡ã€å‡½æ•°å‚æ•°ç­‰ã€‚åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œä½äºç”¨æˆ·è™šæ‹Ÿåœ°å€ç©ºé—´é¡¶éƒ¨çš„æ˜¯ç”¨æˆ·æ ˆï¼Œç¼– è¯‘å™¨ç”¨å®ƒæ¥å®ç°å‡½æ•°çš„è°ƒç”¨ã€‚å’Œå †ä¸€æ ·ï¼Œç”¨æˆ·æ ˆåœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´å¯ä»¥åŠ¨æ€åœ°æ‰©å±•å’Œæ”¶ç¼©ã€‚ å †åŒº 0x6 é‚£äº›ç”± new alloc åˆ›å»ºçš„å¯¹è±¡æ‰€åˆ†é…çš„å†…å­˜å—ï¼Œå®ƒä»¬çš„é‡Šæ”¾ç³»ç»Ÿä¸ä¼šä¸»åŠ¨å»ç®¡ï¼Œç”±æˆ‘ä»¬çš„å¼€å‘è€…å»å‘Šè¯‰ç³»ç»Ÿä»€ä¹ˆæ—¶å€™é‡Šæ”¾è¿™å—å†…å­˜(ä¸€ä¸ªå¯¹è±¡å¼•ç”¨è®¡æ•°ä¸º0æ˜¯ç³»ç»Ÿå°±ä¼šå›é”€æ¯è¯¥å†…å­˜åŒºåŸŸå¯¹è±¡)ã€‚ä¸€èˆ¬ä¸€ä¸ª new å°±è¦å¯¹åº”ä¸€ä¸ª releaseã€‚åœ¨ARCä¸‹ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨åœ¨åˆé€‚ä½ç½®ä¸ºOCå¯¹è±¡æ·»åŠ releaseæ“ä½œã€‚ä¼šåœ¨å½“å‰çº¿ç¨‹Runloopé€€å‡ºæˆ–ä¼‘çœ æ—¶é”€æ¯è¿™äº›å¯¹è±¡ï¼ŒMRCåˆ™éœ€ç¨‹åºå‘˜æ‰‹åŠ¨é‡Šæ”¾ã€‚å †å¯ä»¥åŠ¨æ€åœ°æ‰©å±•å’Œæ”¶ç¼©ã€‚ é™æ€åŒº(æœªåˆå§‹åŒ–æ•°æ®).bss ç¨‹åºè¿è¡Œè¿‡ç¨‹å†…å­˜çš„æ•°æ®ä¸€ç›´å­˜åœ¨ï¼Œç¨‹åºç»“æŸåç”±ç³»ç»Ÿé‡Šæ”¾ å¸¸é‡åŒº(å·²åˆå§‹åŒ–æ•°æ®).data ä¸“é—¨ç”¨äºå­˜æ”¾å¸¸é‡ï¼Œç¨‹åºç»“æŸåç”±ç³»ç»Ÿé‡Šæ”¾ ä»£ç åŒº ç”¨äºå­˜æ”¾ç¨‹åºè¿è¡Œæ—¶çš„ä»£ç ï¼Œä»£ç ä¼šè¢«ç¼–è¯‘æˆäºŒè¿›åˆ¶å­˜è¿›å†…å­˜çš„ç¨‹åºä»£ç åŒº å†…å­˜ç®¡ç†æ–¹æ¡ˆTaggedPointeré€šå¸¸æˆ‘ä»¬åˆ›å»ºå¯¹è±¡ï¼Œå¯¹è±¡å­˜å‚¨åœ¨å †ä¸­ï¼Œå¯¹è±¡çš„æŒ‡é’ˆå­˜å‚¨åœ¨æ ˆä¸­ï¼Œå¦‚æœæˆ‘ä»¬è¦æ‰¾åˆ°è¿™ä¸ªå¯¹è±¡ï¼Œå°±éœ€è¦å…ˆåœ¨æ ˆä¸­ï¼Œæ‰¾åˆ°æŒ‡é’ˆåœ°å€ï¼Œç„¶åæ ¹æ®æŒ‡é’ˆåœ°å€æ‰¾åˆ°åœ¨å †ä¸­çš„å¯¹è±¡ã€‚è¿™ä¸ªè¿‡ç¨‹æ¯”è¾ƒç¹çï¼Œå½“å­˜å‚¨çš„å¯¹è±¡åªæ˜¯ä¸€ä¸ªå¾ˆå°çš„ä¸œè¥¿ï¼Œæ¯”å¦‚ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¸€ä¸ªæ•°å­—ã€‚å»èµ°è¿™ä¹ˆä¸€ä¸ªç¹ççš„è¿‡ç¨‹ï¼Œæ— éæ˜¯è€—è´¹æ€§èƒ½çš„ï¼Œæ‰€ä»¥è‹¹æœå°±æå‡ºäº†TaggedPointerè¿™ä¹ˆä¸€ä¸ªä¸œè¥¿ã€‚ TaggedPointeræ˜¯è‹¹æœä¸ºäº†è§£å†³32ä½CPUåˆ°64ä½CPUçš„è½¬å˜å¸¦æ¥çš„å†…å­˜å ç”¨å’Œæ•ˆç‡é—®é¢˜ï¼Œé’ˆå¯¹NSNumberã€NSDateä»¥åŠéƒ¨åˆ†NSStringçš„å†…å­˜ä¼˜åŒ–æ–¹æ¡ˆã€‚ Tagged PointeræŒ‡é’ˆçš„å€¼ä¸å†æ˜¯åœ°å€äº†ï¼Œè€Œæ˜¯çœŸæ­£çš„å€¼ã€‚æ‰€ä»¥ï¼Œå®é™…ä¸Šå®ƒä¸å†æ˜¯ä¸€ä¸ªå¯¹è±¡äº†ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªæŠ«ç€å¯¹è±¡çš®çš„æ™®é€šå˜é‡è€Œå·²ã€‚æ‰€ä»¥ï¼Œå®ƒçš„å†…å­˜å¹¶ä¸å­˜å‚¨åœ¨å †ä¸­ï¼Œä¹Ÿä¸éœ€è¦mallocå’Œfreeã€‚ Tagged PointeræŒ‡é’ˆä¸­åŒ…å«äº†å½“å‰å¯¹è±¡çš„åœ°å€ã€ç±»å‹ã€å…·ä½“æ•°å€¼ã€‚å› æ­¤Tagged PointeræŒ‡é’ˆåœ¨å†…å­˜è¯»å–ä¸Šæœ‰ç€3å€çš„æ•ˆç‡ï¼Œåˆ›å»ºæ—¶æ¯”æ™®é€šéœ€è¦mallocè·Ÿfreeçš„ç±»å‹å¿«106å€ã€‚ è¿™é‡Œæœ‰å¯¹TaggedPointerè¿›è¡Œè¯¦ç»†ä»‹ç» é—®é¢˜ä¸ºä»€ä¹ˆç¬¬äºŒä¸ªforä¼šå´©æºƒï¼Ÿ 1dispatch_queue_t queue &#x3D; dispatch_queue_create(&quot;queue&quot;, DISPATCH_QUEUE_CONCURRENT);2 dispatch_async(queue, ^&#123;3 for (int i &#x3D; 0 ; i&lt;1000000; i++) &#123;4 self.str &#x3D; @&quot;abcd&quot;;5 &#125;6 &#125;);7 dispatch_async(queue, ^&#123;8 for (int i &#x3D; 0 ; i&lt;1000000; i++) &#123;9 self.str &#x3D; [NSString stringWithFormat:@&quot;adfalkdjfldkasjflakjsdkflasf-- %d&quot;,I];10 &#125;11 &#125;); ç­”ï¼štaggedpointerã€‚åœ¨setpropertyå‡½æ•°ä¸­ï¼Œæ‰§è¡Œäº†objc_release(id obj)ã€‚ç”±äºå¤§é‡çš„å¾ªç¯ï¼Œå¯¼è‡´äº†çº¿ç¨‹é—®é¢˜ï¼Œä½¿å¼•ç”¨è®¡æ•°&lt;=-1ã€‚ä½†æ˜¯ç”±äºç¬¬ä¸€ä¸ªå¾ªç¯ä¸­çš„objæ˜¯taggedpointerç±»å‹çš„stringï¼Œä¼šç›´æ¥return objï¼Œå¹¶ä¸ä¼šreleaseã€‚ä½†æ˜¯è¿™é‡Œreleaseï¼Œretainçš„æ—¶å€™å’‹åŠå‘¢ï¼Œå¼•ç”¨è®¡æ•°æ˜¯ä¸€ç›´å¾€ä¸Šå¢å—ï¼Ÿå¹¶ä¸æ˜¯ï¼Œåœ¨objc_retain(id obj)ä¸­ï¼ŒåŒæ ·åˆ¤æ–­äº†obj-&gt;isTaggedPointerï¼Œå¦‚æœæ˜¯trueï¼Œå°±ç›´æ¥return objã€‚ NONPOINTER_ISANSObjectç»§æ‰¿å…³ç³»ï¼šNSObject -&gt; Class -&gt; objc_class -&gt; objc_object -&gt; isa_t 1union isa_t &#123;2 isa_t() &#123; &#125;3 isa_t(uintptr_t value) : bits(value) &#123; &#125;45 Class cls;6 uintptr_t bits;7#if defined(ISA_BITFIELD)8 struct &#123;9 ISA_BITFIELD; &#x2F;&#x2F; defined in isa.h10 &#125;;11#endif12&#125;; isa_tæ˜¯è”åˆä½“ï¼Œç„¶åé‡ç‚¹çœ‹ISA_BITFIELDï¼Œ å‚æ•°è§£é‡Š nonpointer:è¡¨ç¤ºæ˜¯å¦å¯¹ isa æŒ‡é’ˆå¼€å¯æŒ‡é’ˆä¼˜åŒ– ï¼Œ 0:çº¯isaæŒ‡é’ˆï¼Œ1:ä¸æ­¢æ˜¯ç±»å¯¹è±¡åœ°å€,isa ä¸­åŒ…å«äº†ç±»ä¿¡æ¯ã€å¯¹è±¡çš„å¼•ç”¨è®¡æ•°ç­‰ã€‚ has_assoc:å…³è”å¯¹è±¡æ ‡å¿—ä½ï¼Œ0æ²¡æœ‰ï¼Œ1å­˜åœ¨ã€‚ has_cxx_dtor:è¯¥å¯¹è±¡æ˜¯å¦æœ‰ C++ æˆ–è€… Objc çš„ææ„å™¨,å¦‚æœæœ‰ææ„å‡½æ•°,åˆ™éœ€è¦åšææ„é€»è¾‘, å¦‚æœæ²¡æœ‰,åˆ™å¯ä»¥æ›´æ›´å¿«çš„é‡Šæ”¾å¯¹è±¡ã€‚ shiftcls:å­˜å‚¨ç±»æŒ‡é’ˆçš„å€¼ã€‚å¼€å¯æŒ‡é’ˆä¼˜åŒ–çš„æƒ…å†µä¸‹ï¼Œåœ¨ arm64 æ¶æ„ä¸­æœ‰ 33 ä½â½¤æ¥å­˜å‚¨ç±»æŒ‡é’ˆçš„å€¼ã€‚ magic:ç”¨äºè°ƒè¯•å™¨åˆ¤æ–­å½“å‰å¯¹è±¡æ˜¯çœŸçš„å¯¹è±¡è¿˜æ˜¯æ²¡æœ‰åˆå§‹åŒ–çš„ç©ºé—´ ã€‚ weakly_referenced:æ ‡å¿—å¯¹è±¡æ˜¯å¦è¢«æŒ‡å‘æˆ–è€…æ›¾ç»æŒ‡å‘â¼€ä¸€ä¸ª ARC çš„å¼±å˜é‡ï¼Œæ²¡æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡å¯ä»¥æ›´å¿«é‡Šæ”¾ã€‚ deallocating:æ ‡å¿—å¯¹è±¡æ˜¯å¦æ­£åœ¨é‡Šæ”¾å†…å­˜ã€‚ has_sidetable_rc:æ˜¯å¦æœ‰ç”¨åˆ°æ•£åˆ—è¡¨ï¼Œå½“å¯¹è±¡å¼•â½¤è®¡æ•°å¤§äº 10 æ—¶ï¼Œåˆ™éœ€è¦å€Ÿâ½¤è¯¥å˜é‡å­˜å‚¨è¿›ä½ã€‚ extra_rc:å½“è¡¨ç¤ºè¯¥å¯¹è±¡çš„å¼•ç”¨è®¡æ•°å€¼ï¼Œå®é™…ä¸Šæ˜¯å¼•ç”¨è®¡æ•°å€¼å‡ 1ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå¯¹è±¡çš„å¼•ç”¨è®¡æ•°ä¸º 10ï¼Œé‚£ä¹ˆ extra_rc ä¸º 9ã€‚ä¾‹ï¼šåœ¨x86_64(mac)çš„æ¶æ„ä¸‹ï¼Œå¦‚æœå¼•ç”¨è®¡æ•°å¤§äº 255ï¼Œå¼•ç”¨è®¡æ•°å°†ä¼šå‘ç”Ÿæº¢å‡ºã€‚ æº¢å‡ºæ—¶ï¼Œåˆ™éœ€è¦å°†has_sidetable_rcæ ‡è®°ä¸º1ï¼Œå°†ä¼šå°†æ‹¿å‡º2çš„7æ¬¡æ–¹(128ï¼Œå°±æ˜¯ä¸Šé¢çš„RC_HALF)æ”¾å…¥æ•£åˆ—è¡¨(sidetable)","categories":[],"tags":[{"name":"iOS","slug":"iOS","permalink":"http://yoursite.com/tags/iOS/"}]},{"title":"Explain +load and +initlalize","slug":"Explain-load-and-initlalize","date":"2020-06-02T03:34:34.000Z","updated":"2020-07-02T10:51:32.000Z","comments":true,"path":"2020/2020-06-02-11:34:34/","link":"","permalink":"http://yoursite.com/2020/2020-06-02-11:34:34/","excerpt":"Explain +load and +initlalize","text":"Explain +load and +initlalize + (void)load;Appleæ–‡æ¡£æ˜¯è¿™æ ·æè¿°çš„ï¼š Invoked whenever a class or category is added to the Objective-C runtime; implement this method to perform class-specific behavior upon loading. å½“ç±»ï¼ˆClassï¼‰æˆ–è€…ç±»åˆ«ï¼ˆCategoryï¼‰åŠ å…¥Runtimeä¸­æ—¶è°ƒç”¨ã€‚å®ç°è¯¥æ–¹æ³•ï¼Œå¯ä»¥åœ¨åŠ è½½æ—¶åšä¸€äº›ç±»ç‰¹æœ‰çš„æ“ä½œã€‚ Discussion The load message is sent to classes and categories that are both dynamically loaded and statically linked, but only if the newly loaded class or category implements a method that can respond. The order of initialization is as follows: All initializers in any framework you link to.è°ƒç”¨æ‰€æœ‰çš„Frameworkä¸­çš„åˆå§‹åŒ–æ–¹æ³• All +load methods in your image.è°ƒç”¨æ‰€æœ‰çš„+loadæ–¹æ³• All C++ static initializers and C/C++ attribute(constructor) functions in your image.è°ƒç”¨C++çš„é™æ€åˆå§‹åŒ–æ–¹åŠC/C++ä¸­çš„attribute(constructor)å‡½æ•° All initializers in frameworks that link to you.è°ƒç”¨æ‰€æœ‰é“¾æ¥åˆ°ç›®æ ‡æ–‡ä»¶çš„frameworkä¸­çš„åˆå§‹åŒ–æ–¹æ³• In addition: A classâ€™s +load method is called after all of its superclassesâ€™ +load methods.ä¸€ä¸ªç±»çš„+loadæ–¹æ³•åœ¨å…¶çˆ¶ç±»çš„+loadæ–¹æ³•åè°ƒç”¨ A category +load method is called after the classâ€™s own +load method.ä¸€ä¸ªCategoryçš„+loadæ–¹æ³•åœ¨è¢«å…¶æ‰©å±•çš„ç±»çš„è‡ªæœ‰+loadæ–¹æ³•åè°ƒç”¨ In a custom implementation of load you can therefore safely message other unrelated classes from the same image, but any load methods implemented by those classes may not have run yet.åœ¨+loadæ–¹æ³•ä¸­ï¼Œå¯ä»¥å®‰å…¨åœ°å‘åŒä¸€äºŒè¿›åˆ¶åŒ…ä¸­çš„å…¶å®ƒæ— å…³çš„ç±»å‘é€æ¶ˆæ¯ï¼Œä½†æ¥æ”¶æ¶ˆæ¯çš„ç±»ä¸­çš„+loadæ–¹æ³•å¯èƒ½å°šæœªè¢«è°ƒç”¨ã€‚ æ–‡æ¡£åœ°å€ loadå‡½æ•°è°ƒç”¨ç‰¹ç‚¹å¦‚ä¸‹:å½“ç±»è¢«å¼•ç”¨è¿›é¡¹ç›®çš„æ—¶å€™å°±ä¼šæ‰§è¡Œloadå‡½æ•°(åœ¨mainå‡½æ•°å¼€å§‹æ‰§è¡Œä¹‹å‰ï¼‰,ä¸è¿™ä¸ªç±»æ˜¯å¦è¢«ç”¨åˆ°æ— å…³,æ¯ä¸ªç±»çš„loadå‡½æ•°åªä¼šè‡ªåŠ¨è°ƒç”¨ä¸€æ¬¡.ç”±äºloadå‡½æ•°æ˜¯ç³»ç»Ÿè‡ªåŠ¨åŠ è½½çš„ï¼Œå› æ­¤ä¸éœ€è¦è°ƒç”¨çˆ¶ç±»çš„loadå‡½æ•°ï¼Œå¦åˆ™çˆ¶ç±»çš„loadå‡½æ•°ä¼šå¤šæ¬¡æ‰§è¡Œã€‚ å½“çˆ¶ç±»å’Œå­ç±»éƒ½å®ç°loadå‡½æ•°æ—¶,çˆ¶ç±»çš„loadæ–¹æ³•æ‰§è¡Œé¡ºåºè¦ä¼˜å…ˆäºå­ç±» ç±»ä¸­çš„loadæ–¹æ³•æ‰§è¡Œé¡ºåºè¦ä¼˜å…ˆäºç±»åˆ«(Category) å½“æœ‰å¤šä¸ªç±»åˆ«(Category)éƒ½å®ç°äº†loadæ–¹æ³•,è¿™å‡ ä¸ªloadæ–¹æ³•éƒ½ä¼šæ‰§è¡Œ,ä½†æ‰§è¡Œé¡ºåºä¸ç¡®å®š(å…¶æ‰§è¡Œé¡ºåºä¸ç±»åˆ«åœ¨Compile Sourcesä¸­å‡ºç°çš„é¡ºåºä¸€è‡´) å½“ç„¶å½“æœ‰å¤šä¸ªä¸åŒçš„ç±»çš„æ—¶å€™,æ¯ä¸ªç±»load æ‰§è¡Œé¡ºåºä¸å…¶åœ¨Compile Sourceså‡ºç°çš„é¡ºåºä¸€è‡´ + (void)initialize;Appleæ–‡æ¡£æ˜¯è¿™æ ·æè¿°çš„ï¼š Initializes the class before it receives its first message. åœ¨è¿™ä¸ªç±»æ¥æ”¶ç¬¬ä¸€æ¡æ¶ˆæ¯ä¹‹å‰è°ƒç”¨ã€‚ Discussion The runtime sends initialize to each class in a program exactly one time just before the class, or any class that inherits from it, is sent its first message from within the program. (Thus the method may never be invoked if the class is not used.) The runtime sends the initialize message to classes in a thread-safe manner. Superclasses receive this message before their subclasses. Runtimeåœ¨ä¸€ä¸ªç¨‹åºä¸­æ¯ä¸€ä¸ªç±»çš„ä¸€ä¸ªç¨‹åºä¸­å‘é€ä¸€ä¸ªåˆå§‹åŒ–ä¸€æ¬¡ï¼Œæˆ–æ˜¯ä»å®ƒç»§æ‰¿çš„ä»»ä½•ç±»ä¸­ï¼Œéƒ½æ˜¯åœ¨ç¨‹åºä¸­å‘é€ç¬¬ä¸€æ¡æ¶ˆæ¯ã€‚ï¼ˆå› æ­¤ï¼Œå½“è¯¥ç±»ä¸ä½¿ç”¨æ—¶ï¼Œè¯¥æ–¹æ³•å¯èƒ½æ°¸è¿œä¸ä¼šè¢«è°ƒç”¨ã€‚ï¼‰è¿è¡Œæ—¶å‘é€ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„æ–¹å¼åˆå§‹åŒ–æ¶ˆæ¯ã€‚çˆ¶ç±»çš„è°ƒç”¨ä¸€å®šåœ¨å­ç±»ä¹‹å‰ã€‚ æ–‡æ¡£åœ°å€ initializeå‡½æ•°è°ƒç”¨ç‰¹ç‚¹å¦‚ä¸‹:initializeåœ¨ç±»æˆ–è€…å…¶å­ç±»çš„ç¬¬ä¸€ä¸ªæ–¹æ³•è¢«è°ƒç”¨å‰è°ƒç”¨ã€‚å³ä½¿ç±»æ–‡ä»¶è¢«å¼•ç”¨è¿›é¡¹ç›®,ä½†æ˜¯æ²¡æœ‰ä½¿ç”¨,initializeä¸ä¼šè¢«è°ƒç”¨ã€‚ç”±äºæ˜¯ç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨ï¼Œä¹Ÿä¸éœ€è¦å†è°ƒç”¨ [super initialize] ï¼Œå¦åˆ™çˆ¶ç±»çš„initializeä¼šè¢«å¤šæ¬¡æ‰§è¡Œã€‚å‡å¦‚è¿™ä¸ªç±»æ”¾åˆ°ä»£ç ä¸­ï¼Œè€Œè¿™æ®µä»£ç å¹¶æ²¡æœ‰è¢«æ‰§è¡Œï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ä¸ä¼šè¢«æ‰§è¡Œçš„ã€‚ çˆ¶ç±»çš„initializeæ–¹æ³•ä¼šæ¯”å­ç±»å…ˆæ‰§è¡Œ å½“å­ç±»æœªå®ç°initializeæ–¹æ³•æ—¶,ä¼šè°ƒç”¨çˆ¶ç±»initializeæ–¹æ³•,å­ç±»å®ç°initializeæ–¹æ³•æ—¶,ä¼šè¦†ç›–çˆ¶ç±»initializeæ–¹æ³•. å½“æœ‰å¤šä¸ªCategoryéƒ½å®ç°äº†initializeæ–¹æ³•,ä¼šè¦†ç›–ç±»ä¸­çš„æ–¹æ³•,åªæ‰§è¡Œä¸€ä¸ª(ä¼šæ‰§è¡ŒCompile Sources åˆ—è¡¨ä¸­æœ€åä¸€ä¸ªCategory çš„initializeæ–¹æ³•) æˆ‘ä»¬åœ¨Teacher(ç»§æ‰¿Person).mä¸­ä¸å®ç°initializeæ–¹æ³•ï¼š 1&#x2F;&#x2F;In Person.m2+(void)initialize3&#123;4 NSLog(@&quot;%s&quot;,__FUNCTION__);5&#125;67&#x2F;&#x2F;In Teacher.m(ç»§æ‰¿è‡ªPerson)89Teacher.mä¸­ä¸å®ç°initializeæ–¹æ³• æˆ‘ä»¬è°ƒç”¨ä¸‹Teacherçš„newæ–¹æ³•,è¿è¡Œï¼š 1[Teacher new]; è¿è¡Œç»“æœï¼š 12017-05-04 14:06:45.051 LoadAndInitializeExample[29238:912579] +[Person initialize]22017-05-04 14:06:45.051 LoadAndInitializeExample[29238:912579] +[Person initialize] è¿è¡Œåå‘ç°çˆ¶ç±»çš„initializeæ–¹æ³•ç«Ÿç„¶è°ƒç”¨äº†ä¸¤æ¬¡ï¼šå¯è§å½“å­ç±»æœªå®ç°initializeæ–¹æ³•,ä¼šè°ƒç”¨çˆ¶ç±»initializeæ–¹æ³•.ä½†ä¸ºä»€ä¹ˆä¼šæ‰“å°2æ¬¡å‘¢?æˆ‘çš„ç†è§£:å­ç±»ä¸å®ç°initializeæ–¹æ³•ï¼Œä¼šæŠŠç»§æ‰¿çˆ¶ç±»çš„initializeæ–¹æ³•å¹¶è°ƒç”¨ä¸€éã€‚åœ¨æ­¤ä¹‹å‰,çˆ¶ç±»åˆå§‹åŒ–æ—¶,ä¼šå…ˆè°ƒç”¨ä¸€éè‡ªå·±initializeæ–¹æ³•.æ‰€ä»¥å‡ºç°2é,æ‰€ä»¥ä¸ºäº†é˜²æ­¢çˆ¶ç±»initializeä¸­ä»£ç å¤šæ¬¡æ‰§è¡Œ,æˆ‘ä»¬åº”è¯¥è¿™æ ·å†™: 1&#x2F;&#x2F;In Person.m2+(void)initialize3&#123;4 if(self &#x3D;&#x3D; [Person class])5 &#123;6 NSLog(@&quot;%s&quot;,__FUNCTION__);7 &#125;8&#125; ä¸‹é¢æˆ‘ä»¬åœ¨ Teacher.mä¸­å®ç°initializeæ–¹æ³• 1&#x2F;&#x2F;In Person.m2+(void)initialize3&#123;4 NSLog(@&quot;%s&quot;,__FUNCTION__);5&#125;67&#x2F;&#x2F;In Teacher.m(ç»§æ‰¿è‡ªPerson)8+(void)initialize9&#123;10 NSLog(@&quot;%s&quot;,__FUNCTION__);11&#125; åŒæ ·è°ƒç”¨Teacher çš„newæ–¹æ³•,è¿è¡Œï¼š 1[Teacher new]; è¿è¡Œç»“æœ: 12017-05-04 14:07:45.051 LoadAndInitializeExample[29238:912579] +[Person initialize]22017-05-04 14:07:45.051 LoadAndInitializeExample[29238:912579] +[Teacher initialize] å¯ä»¥çœ‹åˆ° å½“å­ç±»å®ç°initializeæ–¹æ³•å,ä¼šè¦†ç›–çˆ¶ç±»initializeæ–¹æ³•,è¿™ä¸€ç‚¹å’Œç»§æ‰¿æ€æƒ³ä¸€æ ·ã€‚ ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨ï¼š +loadç”±äºè°ƒç”¨loadæ–¹æ³•æ—¶çš„ç¯å¢ƒå¾ˆä¸å®‰å…¨ï¼Œæˆ‘ä»¬åº”è¯¥å°½é‡å‡å°‘loadæ–¹æ³•çš„é€»è¾‘ã€‚å¦ä¸€ä¸ªåŸå› æ˜¯loadæ–¹æ³•æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå®ƒå†…éƒ¨ä½¿ç”¨äº†é”ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥é¿å…çº¿ç¨‹é˜»å¡åœ¨loadæ–¹æ³•ä¸­ loadå¾ˆå¸¸è§çš„ä¸€ä¸ªä½¿ç”¨åœºæ™¯,äº¤æ¢ä¸¤ä¸ªæ–¹æ³•çš„å®ç°ï¼š 1&#x2F;&#x2F;æ‘˜è‡ªMJRefresh2+ (void)load3&#123;4 [self exchangeInstanceMethod1:@selector(reloadData) method2:@selector(mj_reloadData)];5 [self exchangeInstanceMethod1:@selector(reloadRowsAtIndexPaths:withRowAnimation:) method2:@selector(mj_reloadRowsAtIndexPaths:withRowAnimation:)];6 [self exchangeInstanceMethod1:@selector(deleteRowsAtIndexPaths:withRowAnimation:) method2:@selector(mj_deleteRowsAtIndexPaths:withRowAnimation:)];7 [self exchangeInstanceMethod1:@selector(insertRowsAtIndexPaths:withRowAnimation:) method2:@selector(mj_insertRowsAtIndexPaths:withRowAnimation:)];8 [self exchangeInstanceMethod1:@selector(reloadSections:withRowAnimation:) method2:@selector(mj_reloadSections:withRowAnimation:)];9 [self exchangeInstanceMethod1:@selector(deleteSections:withRowAnimation:) method2:@selector(mj_deleteSections:withRowAnimation:)];10 [self exchangeInstanceMethod1:@selector(insertSections:withRowAnimation:) method2:@selector(mj_insertSections:withRowAnimation:)];11&#125;1213+ (void)exchangeInstanceMethod1:(SEL)method1 method2:(SEL)method214&#123;15 method_exchangeImplementations(class_getInstanceMethod(self, method1), class_getInstanceMethod(self, method2));16&#125; ####+initialize initializeæ–¹æ³•ä¸»è¦ç”¨æ¥å¯¹ä¸€äº›ä¸æ–¹ä¾¿åœ¨ç¼–è¯‘æœŸåˆå§‹åŒ–çš„å¯¹è±¡è¿›è¡Œèµ‹å€¼ã€‚æ¯”å¦‚NSMutableArrayè¿™ç§ç±»å‹çš„å®ä¾‹åŒ–ä¾èµ–äºruntimeçš„æ¶ˆæ¯å‘é€ï¼Œæ‰€ä»¥æ˜¾ç„¶æ— æ³•åœ¨ç¼–è¯‘å™¨åˆå§‹åŒ–ï¼š 12&#x2F;&#x2F; In Person.m3&#x2F;&#x2F; intç±»å‹å¯ä»¥åœ¨ç¼–è¯‘æœŸèµ‹å€¼4static int someNumber &#x3D; 0; 5static NSMutableArray *someArray;6+ (void)initialize &#123;7 if (self &#x3D;&#x3D; [Person class]) &#123;8 &#x2F;&#x2F; ä¸æ–¹ä¾¿ç¼–è¯‘æœŸå¤åˆ¶çš„å¯¹è±¡åœ¨è¿™é‡Œèµ‹å€¼9 someArray &#x3D; [[NSMutableArray alloc] init];10 &#125;11&#125; æ€»ç»“ï¼šloadå’Œinitializeçš„å…±åŒç‚¹1.å¦‚æœçˆ¶ç±»å’Œå­ç±»éƒ½è¢«è°ƒç”¨,çˆ¶ç±»çš„è°ƒç”¨ä¸€å®šåœ¨å­ç±»ä¹‹å‰ï¼› +loadæ–¹æ³•è¦ç‚¹ å½“ç±»è¢«å¼•ç”¨è¿›é¡¹ç›®çš„æ—¶å€™å°±ä¼šæ‰§è¡Œloadå‡½æ•°(åœ¨mainå‡½æ•°å¼€å§‹æ‰§è¡Œä¹‹å‰ï¼‰,ä¸è¿™ä¸ªç±»æ˜¯å¦è¢«ç”¨åˆ°æ— å…³,æ¯ä¸ªç±»çš„loadå‡½æ•°åªä¼šè‡ªåŠ¨è°ƒç”¨ä¸€æ¬¡.ç”±äºloadå‡½æ•°æ˜¯ç³»ç»Ÿè‡ªåŠ¨åŠ è½½çš„ï¼Œå› æ­¤ä¸éœ€è¦å†è°ƒç”¨[super load]ï¼Œå¦åˆ™çˆ¶ç±»çš„loadå‡½æ•°ä¼šå¤šæ¬¡æ‰§è¡Œã€‚ å½“çˆ¶ç±»å’Œå­ç±»éƒ½å®ç°loadå‡½æ•°æ—¶,çˆ¶ç±»çš„loadæ–¹æ³•æ‰§è¡Œé¡ºåºè¦ä¼˜å…ˆäºå­ç±» ç±»ä¸­çš„loadæ–¹æ³•æ‰§è¡Œé¡ºåºè¦ä¼˜å…ˆäºç±»åˆ«(Category) å½“æœ‰å¤šä¸ªç±»åˆ«(Category)éƒ½å®ç°äº†loadæ–¹æ³•,è¿™å‡ ä¸ªloadæ–¹æ³•éƒ½ä¼šæ‰§è¡Œ,ä½†æ‰§è¡Œé¡ºåºä¸ç¡®å®š(å…¶æ‰§è¡Œé¡ºåºä¸ç±»åˆ«åœ¨Compile Sourcesä¸­å‡ºç°çš„é¡ºåºä¸€è‡´) å½“ç„¶å½“æœ‰å¤šä¸ªä¸åŒçš„ç±»çš„æ—¶å€™,æ¯ä¸ªç±»load æ‰§è¡Œé¡ºåºä¸å…¶åœ¨Compile Sourceså‡ºç°çš„é¡ºåºä¸€è‡´ æ³¨æ„: loadè°ƒç”¨æ—¶æœºæ¯”è¾ƒæ—©,å½“loadè°ƒç”¨æ—¶,å…¶ä»–ç±»å¯èƒ½è¿˜æ²¡åŠ è½½å®Œæˆ,è¿è¡Œç¯å¢ƒä¸å®‰å…¨. loadæ–¹æ³•æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå®ƒä½¿ç”¨äº†é”ï¼Œæˆ‘ä»¬åº”è¯¥é¿å…çº¿ç¨‹é˜»å¡åœ¨loadæ–¹æ³•. +initializeæ–¹æ³•è¦ç‚¹ initializeåœ¨ç±»æˆ–è€…å…¶å­ç±»çš„ç¬¬ä¸€ä¸ªæ–¹æ³•è¢«è°ƒç”¨å‰è°ƒç”¨ã€‚å³ä½¿ç±»æ–‡ä»¶è¢«å¼•ç”¨è¿›é¡¹ç›®,ä½†æ˜¯æ²¡æœ‰ä½¿ç”¨,initializeä¸ä¼šè¢«è°ƒç”¨ã€‚ç”±äºæ˜¯ç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨ï¼Œä¹Ÿä¸éœ€è¦æ˜¾å¼çš„è°ƒç”¨çˆ¶ç±»çš„initializeï¼Œå¦åˆ™çˆ¶ç±»çš„initializeä¼šè¢«å¤šæ¬¡æ‰§è¡Œã€‚å‡å¦‚è¿™ä¸ªç±»æ”¾åˆ°ä»£ç ä¸­ï¼Œè€Œè¿™æ®µä»£ç å¹¶æ²¡æœ‰è¢«æ‰§è¡Œï¼Œè¿™ä¸ªå‡½æ•°æ˜¯ä¸ä¼šè¢«æ‰§è¡Œçš„ã€‚ çˆ¶ç±»çš„initializeæ–¹æ³•ä¼šæ¯”å­ç±»å…ˆæ‰§è¡Œ å½“å­ç±»æœªå®ç°initializeæ–¹æ³•æ—¶,ä¼šè°ƒç”¨çˆ¶ç±»initializeæ–¹æ³•,å­ç±»å®ç°initializeæ–¹æ³•æ—¶,ä¼šè¦†ç›–çˆ¶ç±»initializeæ–¹æ³•. å½“æœ‰å¤šä¸ªCategoryéƒ½å®ç°äº†initializeæ–¹æ³•,ä¼šè¦†ç›–ç±»ä¸­çš„æ–¹æ³•,åªæ‰§è¡Œä¸€ä¸ª(ä¼šæ‰§è¡ŒCompile Sources åˆ—è¡¨ä¸­æœ€åä¸€ä¸ªCategory çš„initializeæ–¹æ³•) æ³¨æ„: åœ¨initializeæ–¹æ³•æ”¶åˆ°è°ƒç”¨æ—¶,è¿è¡Œç¯å¢ƒåŸºæœ¬å¥å…¨ã€‚ initializeå†…éƒ¨ä¹Ÿä½¿ç”¨äº†é”ï¼Œæ‰€ä»¥æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä½†åŒæ—¶è¦é¿å…é˜»å¡çº¿ç¨‹ï¼Œä¸è¦å†ä½¿ç”¨é”","categories":[],"tags":[{"name":"iOS","slug":"iOS","permalink":"http://yoursite.com/tags/iOS/"}]},{"title":"SELå’ŒMethodå’ŒIMPè¯¦è§£","slug":"SELå’ŒMethodå’ŒIMPè¯¦è§£","date":"2020-06-01T03:45:31.000Z","updated":"2020-07-02T10:51:44.000Z","comments":true,"path":"2020/2020-06-01-11:45:31/","link":"","permalink":"http://yoursite.com/2020/2020-06-01-11:45:31/","excerpt":"SELå’ŒMethodå’ŒIMPåˆ†åˆ«è¯´ä¸‹ï¼Œå†è°ˆä¸‹å¯¹IMPçš„ç†è§£","text":"SELå’ŒMethodå’ŒIMPåˆ†åˆ«è¯´ä¸‹ï¼Œå†è°ˆä¸‹å¯¹IMPçš„ç†è§£ åœ¨ Objective-C ä¸­ï¼Œselectorï¼ŒMethod å’Œ implementation(IMP) éƒ½æ˜¯ Runtime çš„ç»„æˆéƒ¨åˆ†ã€‚åœ¨å®é™…å¼€å‘ä¸­å®ƒä»¬å¸¸å¸¸å¯ä»¥ç›¸äº’è½¬æ¢æ¥å¤„ç†æ¶ˆæ¯çš„å‘é€ã€‚Selectorå®šä¹‰ï¼štypedef struct objc_selector *SELç¿»è¯‘æˆä¸­æ–‡å«åšé€‰æ‹©å­æˆ–è€…é€‰æ‹©å™¨ï¼Œé€‰æ‹©å­ä»£è¡¨æ–¹æ³•åœ¨ Runtime æœŸé—´çš„æ ‡è¯†ç¬¦ã€‚ä¸º SEL ç±»å‹ï¼Œè™½ç„¶ SEL æ˜¯ objc_selector ç»“æ„ä½“æŒ‡é’ˆï¼Œä½†å®é™…ä¸Šå®ƒåªæ˜¯ä¸€ä¸ª C å­—ç¬¦ä¸²ã€‚åœ¨ç±»åŠ è½½çš„æ—¶å€™ï¼Œç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸æ–¹æ³•ç›¸å¯¹åº”çš„é€‰æ‹©å­ï¼Œå¹¶æ³¨å†Œåˆ° Objective-C çš„ Runtime è¿è¡Œç³»ç»Ÿã€‚ å¸¸è§çš„æœ‰ä¸¤ç§æ–¹å¼æ¥è·å–/åˆ›å»ºé€‰æ‹©å­: 1SEL selA &#x3D; @selector(setString:);2SEL selB &#x3D; sel_registerName(&quot;setString:&quot;); ä» sel_getName() æ–¹æ³•çš„æºç å¯ä»¥çœ‹å‡º SEL å’Œ const char * æ˜¯å¯ä»¥ç›¸äº’è½¬åŒ–çš„ï¼š 1const char *sel_getName(SEL sel) &#123;2 return sel ? (const char *)sel : &quot;&lt;null selector&gt;&quot;;3&#125; å¦‚æœå°† selA å’Œ selB å¼ºè½¬ä¸ºä¸º const char *: 1(lldb) p (const char *)$22(const char *) $3 &#x3D; 0x00007fff9a3794b5 &quot;setString:&quot;3(lldb) p (const char *)$14(const char *) $4 &#x3D; 0x00007fff9a3794b5 &quot;setString:&quot;5(lldb) ä¸Šé¢çš„ç»“æœå¯ä»¥çœ‹å‡ºï¼ŒselA å’Œ selB æŒ‡å‘ç›¸åŒçš„åœ°å€ï¼Œä»£è¡¨åŒä¸€ä¸ªå­—ç¬¦ä¸²ã€‚ å¦‚æœæŸä¸ªç±»å®ç°äº† setStringï¼šæ–¹æ³•ï¼Œé‚£ä¹ˆä»¥ä¸Šä¸¤ä¸ªé€‰æ‹©å­ä¼ å…¥ respondsToSelector() æ–¹æ³•è¿”å›çš„ç»“æœéƒ½å°†ä¸º YESã€‚ ä¸åŒç±»ä¸­ç›¸åŒåå­—çš„æ–¹æ³•æ‰€å¯¹åº”çš„æ–¹æ³•é€‰æ‹©å­æ˜¯ç›¸åŒçš„ï¼Œå³ä½¿æ–¹æ³•åå­—ç›¸åŒè€Œå˜é‡ç±»å‹ä¸åŒä¹Ÿä¼šå¯¼è‡´å®ƒä»¬å…·æœ‰ç›¸åŒçš„æ–¹æ³•é€‰æ‹©å­ã€‚ Implementation(IMP): å®šä¹‰ï¼štypedef id (*IMP)(id, SEL, ...) ä»£è¡¨å‡½æ•°æŒ‡é’ˆï¼Œå³å‡½æ•°æ‰§è¡Œçš„å…¥å£ã€‚è¯¥å‡½æ•°ä½¿ç”¨æ ‡å‡†çš„ C è°ƒç”¨ã€‚ç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å‘ selfï¼ˆå®ƒä»£è¡¨å½“å‰ç±»å®ä¾‹çš„åœ°å€ï¼Œå¦‚æœæ˜¯ç±»åˆ™æŒ‡å‘çš„æ˜¯å®ƒçš„å…ƒç±»ï¼‰ï¼Œä½œä¸ºæ¶ˆæ¯çš„æ¥å—è€…ï¼›ç¬¬äºŒä¸ªå‚æ•°ä»£è¡¨æ–¹æ³•çš„é€‰æ‹©å­ï¼›â€¦ ä»£è¡¨å¯é€‰å‚æ•°ï¼Œå‰é¢çš„ id ä»£è¡¨è¿”å›å€¼ã€‚ ä¸¾ä¸ªAFä¸­çš„æºç ä¾‹å­ï¼š 1 NSURLSessionConfiguration *configuration &#x3D; [NSURLSessionConfiguration ephemeralSessionConfiguration];2 NSURLSession *session &#x3D; [NSURLSession sessionWithConfiguration:configuration];3#pragma GCC diagnostic push4#pragma GCC diagnostic ignored &quot;-Wnonnull&quot;5 NSURLSessionDataTask *localDataTask &#x3D; [session dataTaskWithURL:nil];6#pragma clang diagnostic pop7 IMP originalAFResumeIMP &#x3D; method_getImplementation(class_getInstanceMethod([self class], @selector(af_resume)));8 Class currentClass &#x3D; [localDataTask class];9 10 while (class_getInstanceMethod(currentClass, @selector(resume))) &#123;11 Class superClass &#x3D; [currentClass superclass];12 IMP classResumeIMP &#x3D; method_getImplementation(class_getInstanceMethod(currentClass, @selector(resume)));13 IMP superclassResumeIMP &#x3D; method_getImplementation(class_getInstanceMethod(superClass, @selector(resume)));14 if (classResumeIMP !&#x3D; superclassResumeIMP &amp;&amp;15 originalAFResumeIMP !&#x3D; classResumeIMP) &#123;16 [self swizzleResumeAndSuspendMethodForClass:currentClass];17 &#125;18 currentClass &#x3D; [currentClass superclass];19 &#125; Methodå®šä¹‰ï¼štypedef struct objc_method *MethodMethod å¯¹å¼€å‘è€…æ¥è¯´æ˜¯ä¸€ç§ä¸é€æ˜çš„ç±»å‹ï¼Œè¢«éšè—åœ¨æˆ‘ä»¬å¹³æ—¶ä¹¦å†™çš„ç±»æˆ–å¯¹è±¡çš„æ–¹æ³•èƒŒåã€‚å®ƒæ˜¯ä¸€ä¸ª objc_method ç»“æ„ä½“æŒ‡é’ˆï¼Œobjc_method çš„å®šä¹‰ä¸ºï¼š 1&#x2F;&#x2F;&#x2F; Method2struct objc_method &#123;3 SEL method_name; 4 char *method_types;5 IMP method_imp;6&#125;; æ–¹æ³•å method_name ç±»å‹ä¸º SELï¼Œå‰é¢æåˆ°è¿‡ç›¸åŒåå­—çš„æ–¹æ³•å³ä½¿åœ¨ä¸åŒç±»ä¸­å®šä¹‰ï¼Œå®ƒä»¬çš„æ–¹æ³•é€‰æ‹©å™¨ä¹Ÿç›¸åŒã€‚ æ–¹æ³•ç±»å‹ method_types æ˜¯ä¸ª char æŒ‡é’ˆï¼Œå…¶å®å­˜å‚¨ç€æ–¹æ³•çš„å‚æ•°ç±»å‹å’Œè¿”å›å€¼ç±»å‹ï¼Œå³æ˜¯ Type Encoding ç¼–ç ã€‚ method_imp æŒ‡å‘æ–¹æ³•çš„å®ç°ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå‡½æ•°çš„æŒ‡é’ˆï¼Œå°±æ˜¯å‰é¢è®²åˆ°çš„ Implementationã€‚ ä¸¾ä¸ªAFä¸­çš„æºç ä¾‹å­ï¼š 1static inline void af_swizzleSelector(Class theClass, SEL originalSelector, SEL swizzledSelector) &#123;2 Method originalMethod &#x3D; class_getInstanceMethod(theClass, originalSelector);3 Method swizzledMethod &#x3D; class_getInstanceMethod(theClass, swizzledSelector);4 method_exchangeImplementations(originalMethod, swizzledMethod);5&#125; åº”ç”¨åœºæ™¯ï¼š When we use method swizzling 1+ (void)load &#123;2 static dispatch_once_t onceToken;3 dispatch_once(&amp;onceToken, ^&#123;4 Class class &#x3D; [self class];5 6 SEL originalSelector &#x3D; @selector(prepareToPlay);7 SEL swizzledSelector &#x3D; @selector(recond_prepareToPlay);8 9 Method originalMethod &#x3D; class_getInstanceMethod(class, originalSelector);10 Method swizzledMethod &#x3D; class_getInstanceMethod(class, swizzledSelector);11 12 BOOL didAddMethod &#x3D; class_addMethod(class, originalSelector, method_getImplementation(swizzledMethod), method_getTypeEncoding(swizzledMethod));13 &#x2F;*14 @return YES if the method was added successfully, otherwise NO (for example, the class already contains a method implementation with that name).15 å¦‚æœæ–¹æ³•æ·»åŠ æˆåŠŸï¼Œåˆ™è¿”å›YESï¼Œå¦åˆ™è¿”å›NOï¼ˆä¾‹å¦‚ï¼Œç±»å·²åŒ…å«å…·æœ‰è¯¥åç§°çš„æ–¹æ³•å®ç°ï¼‰16 *&#x2F;17 if (didAddMethod) &#123;18 class_replaceMethod(class, swizzledSelector, method_getImplementation(originalMethod), method_getTypeEncoding(originalMethod));19 &#125; else &#123;20 method_exchangeImplementations(originalMethod, swizzledMethod);21 &#125;22 &#125;);23&#125; Selectorï¼ŒMethodï¼ŒIMP å®ƒä»¬ä¹‹é—´çš„å…³ç³»å¯ä»¥è¿™ä¹ˆè§£é‡Šï¼šä¸€ä¸ªç±»ï¼ˆClassï¼‰æŒæœ‰ä¸€ä¸ªåˆ†å‘è¡¨ï¼Œåœ¨è¿è¡ŒæœŸåˆ†å‘æ¶ˆæ¯ï¼Œè¡¨ä¸­çš„æ¯ä¸€ä¸ªå®ä½“ä»£è¡¨ä¸€ä¸ªæ–¹æ³•ï¼ˆMethodï¼‰ï¼Œå®ƒçš„åå­—å«åšé€‰æ‹©å­ï¼ˆSELï¼‰ï¼Œå¯¹åº”ç€ä¸€ç§æ–¹æ³•å®ç°ï¼ˆIMPï¼‰ã€‚","categories":[],"tags":[{"name":"iOS","slug":"iOS","permalink":"http://yoursite.com/tags/iOS/"}]},{"title":"ç»„ä»¶åŒ–æ–¹æ¡ˆ","slug":"ç»„ä»¶åŒ–æ–¹æ¡ˆ","date":"2020-05-23T08:27:28.000Z","updated":"2020-07-02T10:51:49.000Z","comments":true,"path":"2020/2020-05-23-16:27:28/","link":"","permalink":"http://yoursite.com/2020/2020-05-23-16:27:28/","excerpt":"BeeHiveæ¡†æ¶å…¨é¢è§£æâ€”â€”iOSå¼€å‘ä¸»æµæ–¹æ¡ˆæ¯”è¾ƒ","text":"BeeHiveæ¡†æ¶å…¨é¢è§£æâ€”â€”iOSå¼€å‘ä¸»æµæ–¹æ¡ˆæ¯”è¾ƒ â€¢ BeeHiveæ¡†æ¶å…¨é¢è§£æâ€”â€”iOSå¼€å‘ä¸»æµæ–¹æ¡ˆæ¯”è¾ƒâ€¢ ä¸€ã€BeeHiveæ˜¯ä»€ä¹ˆï¼Ÿâ€¢ äºŒã€ä½œä¸ºæ¡†æ¶ï¼ŒBeeHiveåšäº†ä»€ä¹ˆå·¥ä½œï¼Ÿâ€¢ ä¸‰ã€BeeHiveæ˜¯æ€ä¹ˆåšåº”ç”¨ä»£ç†è§£è€¦çš„ï¼Ÿâ€¢ BeeHiveåº”ç”¨ä»£ç†è§£è€¦â€¢ MLSOAppDelegateåº”ç”¨ä»£ç†è§£è€¦â€¢ åº”ç”¨ä»£ç†è§£è€¦è®¨è®ºâ€¢ å››ã€BeeHiveæ˜¯æ€ä¹ˆåšæ¨¡å—é—´è°ƒç”¨çš„ï¼Ÿâ€¢ BeeHiveæ¨¡å—è°ƒç”¨â€¢ CTMediatoræ¨¡å—è°ƒç”¨â€¢ æ¨¡å—é—´è°ƒç”¨çš„è®¨è®ºâ€¢ äº”ã€BeeHiveçš„å¼€å‘æ”¯æŒåŠŸèƒ½â€¢ å…­ã€æˆ‘ä»¬çš„æ–¹æ¡ˆé€‰æ‹©â€¢ Objective-Cæ˜¯å¦é€‚åˆPOPå¼€å‘ï¼Ÿâ€¢ é€‰æ‹©æ–¹æ¡ˆâ€¢ å‚è€ƒæ–‡æ¡£ ä¸€ã€BeeHiveæ˜¯ä»€ä¹ˆï¼Ÿ BeeHiveæ˜¯ç”¨äºiOSåº”ç”¨å¼€å‘çš„Appæ¨¡å—åŒ–ç¼–ç¨‹çš„æ¡†æ¶å®ç°æ–¹æ¡ˆï¼Œå¸æ”¶äº†Springæ¡†æ¶Serviceçš„ç†å¿µæ¥å®ç°æ¨¡å—é—´çš„APIè€¦åˆã€‚BeeHiveæ¡†æ¶ä»£ç å·²åœ¨GitHubå¼€æºï¼Œå¯¹è¿™ä¸ªæ¡†æ¶ä¸äº†è§£çš„åŒå­¦å¯ä»¥å…ˆçœ‹ä¸€ä¸‹å¼€æºåº“æä¾›çš„ä»‹ç»ï¼šBeeHive@githubã€‚ äºŒã€ä½œä¸ºæ¡†æ¶ï¼ŒBeeHiveåšäº†ä»€ä¹ˆå·¥ä½œï¼Ÿ BeeHiveæ¡†æ¶æä¾›çš„åŠŸèƒ½ä¸»è¦æœ‰ä»¥ä¸‹å‡ éƒ¨åˆ†ï¼šâ€¢ åº”ç”¨ä»£ç†è§£è€¦ï¼šè§£é™¤AppDelegateä»£ç†æ–¹æ³•ä¸­ï¼Œä¸åŒä¸šåŠ¡ä»£ç çš„è€¦åˆã€‚â€¢ æ¨¡å—é—´è°ƒç”¨è§£è€¦ï¼šè§£é™¤ä¸åŒæ¨¡å—é—´çš„\bè¿‡åº¦è€¦åˆé—®é¢˜ï¼Œæä¾›æ›´åŠ æ¸…æ™°çš„è°ƒç”¨æ–¹æ¡ˆã€‚â€¢ å…¶ä»–å¼€å‘æ”¯æŒåŠŸèƒ½ ä¸‰ã€BeeHiveæ˜¯æ€ä¹ˆåšåº”ç”¨ä»£ç†è§£è€¦çš„ï¼ŸAppDelegateä¸­çš„ä»£ç æƒ³è¦è§£é™¤è€¦åˆï¼Œè¯´åˆ°åº•è¿˜æ˜¯è¦å°†ä»£ç†äº‹ä»¶åˆ†å‘åˆ°ä¸åŒçš„ä¸šåŠ¡ä»£ç†ç±»ä¸­ã€‚åœ¨BeeHiveä¹‹å‰ï¼Œæˆ‘è‡ªå·±ç”¨è¿‡ä¸¤ç§è§£è€¦ç»„ä»¶ï¼šâ€¢ FRDModuleManagerï¼šå®ç°ä»£ç†ä¸­æ‰€æœ‰æ–¹æ³•ï¼Œç®€å•çš„å°†AppDelegateçš„å•è·¯ä»£ç†æ”¹æˆå¤šè·¯ä»£ç†ã€‚â€¢ MLSOAppDelegateï¼šé€šè¿‡runtimeçš„äº‹ä»¶è½¬å‘ï¼Œå°†ä»£ç†åè®®ä¸­çš„æ–¹æ³•è¿›è¡ŒåŠ¨æ€è½¬å‘ï¼Œåœ¨è‡ªå·±ä»£ç ä¸­æ²¡æœ‰å®ç°æ‰€æœ‰ä»£ç†æ–¹æ³•ã€‚ä¸çŸ¥é“è¿˜æœ‰æ²¡æœ‰å…¶ä»–çš„\bå¼€æºç»„ä»¶ï¼Œå•è®ºä»¥ä¸Šä¸¤ç§ï¼ŒMLSOAppDelegateåº”è¯¥ç®—æ˜¯FRDModuleManagerçš„å¢å¼ºç‰ˆï¼Œæ‰€ä»¥ä¸‹é¢æˆ‘ä»¬æŠŠMLSOAppDelegateçš„æ–¹æ¡ˆæ¥å’ŒBeeHiveçš„æ–¹æ¡ˆè¿›è¡Œæ¯”è¾ƒã€‚ ç¬”è€…è¯´æ˜ï¼šä¸€èˆ¬\båº”ç”¨ä»£ç†è§£è€¦çš„æ–‡ç« ä¼šå°†ä»£ç†äº‹ä»¶åˆ†å‘åˆ°çš„ç±»ç§°ä¹‹ä¸ºæ¨¡å—moduleï¼Œä½†æ˜¯ä¸ºäº†å’Œä¸‹éƒ¨åˆ†â€œæ¨¡å—é—´è°ƒç”¨â€ä¸­çš„æ¨¡å—æ¦‚å¿µåŒºåˆ†ï¼Œæˆ‘ä»¬å°±å°†åº”ç”¨ä»£ç†è§£è€¦ä¸­å¸¸ç”¨çš„Moduleç§°ä¹‹ä¸ºâ€œæ¨¡å—ä»£ç†ç±»â€ã€‚ BeeHiveåº”ç”¨ä»£ç†è§£è€¦ç»Ÿä¸€åŸºç±» + å…¨å±€ä¸Šä¸‹æ–‡å‚æ•° + äº‹ä»¶äºŒæ¬¡åˆ†å‘BeeHiveæä¾›äº†ç»Ÿä¸€çš„AppDelegateåŸºç±»BHAppDelegateï¼Œæ‰€æœ‰ä»£ç†äº‹ä»¶çš„å‚æ•°å…¨éƒ¨ä¿å­˜åˆ°å…¨å±€ä¸Šä¸‹æ–‡å¯¹è±¡BHContextä¸­ï¼Œç”±ç®¡ç†æ¨¡å—ä»£ç†ç±»çš„BHModuleManagerä»BHContexté‡ŒæŠŠå‚æ•°å–å‡ºæ¥ç„¶åé€šè¿‡BHModuleEventTypeæšä¸¾ç±»å‹è¿›è¡ŒäºŒæ¬¡åˆ†å‘ã€‚å°†æ¨¡å—ä»£ç†ç±»æ³¨å†Œè¿›BHModuleManagerï¼ŒBeeHiveæä¾›äº†å¤šç§æ–¹æ³•ï¼š åœ¨æ¨¡å—ä»£ç†ç±»+ (void)loadæ–¹æ³•ä¸­è°ƒç”¨[BeeHive registerDynamicModule:[self class]];; åœ¨æ¨¡å—ä»£ç†ç±»çš„implementationä¸­æ’å…¥å®BH_EXPORT_MODULE(NO);æ­¤æ–¹æ³•å®è´¨ä¸Šå’Œä¸Šé¢ç›¸åŒï¼› ç±»ä¼¼Javaæ³¨è§£çš„å½¢å¼@BeeHiveMod(ShopModule); é€šè¿‡[BHContext shareInstance].moduleConfigName = @&quot;BeeHive.bundle/BeeHive&quot;;æŒ‡å®šçš„æ–‡ä»¶åŠ è½½ã€‚ åº”ç”¨ä»£ç†è§£è€¦åŠŸèƒ½æ¶‰åŠåˆ°çš„ç±»å‹æœ‰ï¼šâ€¢ BHAppDelegateâ€¢ BHModuleProtocolâ€¢ BHModuleManagerâ€¢ BHAnnotationâ€¢ BHContext \bä¼˜ç‚¹ï¼š ä¸šåŠ¡ä»£ç çš„AppDelegateåªè¦ç»§æ‰¿åŸºç±»ï¼Œä¸éœ€è¦å®ç°å…·ä½“çš„ä»£ç†æ–¹æ³•ï¼› æ‰©å±•äº†æ¨¡å—ç”Ÿå‘½å‘¨æœŸ\bï¼Œå¢åŠ äº†modSetUpã€modInitå’ŒmodSplashæ–¹æ³•ï¼› æ¨¡å—ä»£ç†ç±»åœ¨ä¸šåŠ¡ä»£ç ä¸­æ³¨å†Œæˆ–è€…æ¨¡å—ä»£ç†ç±»è‡ªåŠ¨æ³¨å†Œæ—¶ï¼Œä¼šæŒ‰ç…§Levelå’ŒPriorityè¿›è¡Œæ’åºï¼Œæ¨¡å—ä»£ç†ç±»è¢«è°ƒç”¨çš„é¡ºåºå¯æ§ï¼› æ¨¡å—ä»£ç†ç±»æ”¯æŒå¼‚æ­¥åŠ è½½ï¼› æ”¯æŒè‡ªå®šä¹‰äº‹ä»¶ã€‚ ä¸è¶³ï¼š å› ä¸ºæœ‰ç»Ÿä¸€åŸºç±»ï¼Œå¯¹ä¸šåŠ¡ä»£ç æœ‰ä¾µå…¥ï¼› å› ä¸ºBeeHiveå¯¹AppDelegateæ–¹æ³•è¿›è¡Œäº†\bäºŒæ¬¡å°è£…ï¼Œæ‰€ä»¥å½“ç³»ç»Ÿä»£ç†æ–¹æ³•å¢åŠ ã€åˆ é™¤ã€å˜åŠ¨æ—¶ï¼ŒBeeHiveéœ€è¦åŒæ­¥ä¿®æ”¹ï¼› é€šè¿‡Levelå’ŒPriorityè¿›è¡Œæ¨¡å—ä»£ç†ç±»çš„æ’åºï¼Œå…¶å®è´¨ä¸Šå­˜åœ¨é€»è¾‘è€¦åˆï¼› æœªæ”¯æŒUIResponderä¸­çš„äº‹ä»¶ï¼› MLSOAppDelegateåº”ç”¨ä»£ç†è§£è€¦ç»Ÿä¸€åŸºç±» + äº‹ä»¶è½¬å‘è¯¥ç»„ä»¶æä¾›äº†åŸºç±»MLSOAppDelegateï¼ŒåŸºç±»ä½¿ç”¨forwardInvocationå°†æ¥æ”¶åˆ°çš„æ–¹æ³•å…¨éƒ¨è½¬å‘åˆ°MLAppServiceManagerç®¡ç†çš„æ‰€æœ‰æ¨¡å—ä»£ç†ç±»åˆ—è¡¨ä¸­ã€‚æ³¨å†Œæ¨¡å—ä»£ç†ç±»ï¼Œè¯¥ç»„ä»¶ä¹Ÿæä¾›äº†å¤šä¸ªæ–¹æ³•ï¼š é€šè¿‡MLAppServiceManagerçš„registerServiceWithPlistFileæ–¹æ³•åŠ è½½é…ç½®æ–‡ä»¶ï¼› åœ¨æ¨¡å—ä»£ç†ç±»+ (void)loadæ–¹æ³•ä¸­è°ƒç”¨registerServiceæ–¹æ³•; é€šè¿‡ML_EXPORT_SERVICEå®å®šä¹‰è‡ªåŠ¨æ³¨å†Œï¼›å®è´¨ä¸ä¸Šä¸€ç§ç›¸åŒï¼›ä¼˜ç‚¹ï¼š ä¸šåŠ¡ä»£ç çš„AppDelegateåªè¦ç»§æ‰¿åŸºç±»ï¼Œä¸éœ€è¦å®ç°ä»£ç†æ–¹æ³•ï¼› ç°æœ‰ä»£ç†åè®®çš„æ–¹æ³•å¢å‡å˜åŠ¨æ—¶ä¸éœ€è¦åŒæ­¥ä¿®æ”¹ï¼› é€šè¿‡é…ç½®æ–‡ä»¶ä¸»åŠ¨æ³¨å†Œæ—¶ï¼Œè°ƒç”¨é¡ºåºå¯æ§ï¼›ä¸è¶³ï¼š éœ€è¦æ”¯æŒæ–°çš„åè®®æ—¶ï¼Œéœ€è¦åŒæ­¥ä¿®æ”¹ï¼›æ¯”å¦‚iOS10ç³»ç»Ÿçš„æ¨é€ï¼› åœ¨loadæ–¹æ³•å†…è‡ªåŠ¨æ³¨å†Œæ—¶ï¼Œè°ƒç”¨é¡ºåºä¸å¯æ§ï¼› æœªåˆ†å‘UIResponderä¸­çš„äº‹ä»¶ï¼› åº”ç”¨ä»£ç†è§£è€¦è®¨è®ºé€šè¿‡ä¸Šé¢çš„æ¯”è¾ƒï¼Œä¸¤ç§æ–¹æ¡ˆçš„åŒºåˆ«ä¸»è¦åœ¨äºæ¨¡å—ä»£ç†ç±»çš„æ‰§è¡Œé¡ºåºä»¥åŠå¯¹ä»£ç†æ–¹æ³•å˜åŠ¨çš„å…¼å®¹æ€§ä¸¤æ–¹é¢ã€‚ æ¨¡å—ä»£ç†ç±»çš„æ‰§è¡Œé¡ºåºæ¨¡å—ä»£ç†ç±»çš„æ‰§è¡Œé¡ºåºåªæ˜¯ä¸ªé€»è¾‘é—®é¢˜ï¼Œç›¸å¯¹æ¥è¯´BeeHiveçš„æ–¹æ¡ˆæ¯”è¾ƒæ»¡è¶³æˆ‘ä»¬çš„ä¸šåŠ¡è¦æ±‚ã€‚ä¸è¿‡æˆ‘ä»¬åœ¨æ­¤ä¸å¦¨æ€è€ƒä¸€ä¸‹ï¼Œæ¨¡å—ä»£ç†ç±»çš„æ‰§è¡Œé¡ºåºå®è´¨ä¸Šæ˜¯ä¸ªä»€ä¹ˆé—®é¢˜ã€‚æ‰€è°“çš„é¡ºåºï¼Œæˆ‘ä»¬æ‹†åˆ†åˆ°æœ€ç»†çš„å±‚æ¬¡ä¸Šï¼Œå…¶å®å°±æ˜¯ä¸¤ä¸ªæ¨¡å—ä»£ç†ç±»è°å…ˆè°åçš„é—®é¢˜ã€‚é‚£ä¹ˆï¼Œæ‰§è¡Œé¡ºåºçš„é—®é¢˜ï¼Œå®è´¨ä¸Šå°±æ˜¯æ¨¡å—\bä»£ç†ç±»ä¹‹é—´çš„è€¦åˆé—®é¢˜ã€‚è€¦åˆå…³ç³»ä¸€èˆ¬æ˜¯ä¸¤è€…ä¹‹é—´çš„ï¼Œæ‰€ä»¥è§£å†³é—®é¢˜æ—¶å…·ä½“æ–¹æ¡ˆæ¶‰åŠçš„å¯¹è±¡ä¸€æ—¦è¶…å‡ºäº†ä¸¤è€…ï¼Œé‚£ä¹ˆå°±å­˜åœ¨å†—ä½™çš„è€¦åˆã€‚è€Œé€šè¿‡Priorityè¿›è¡Œæ§åˆ¶å°±æ˜¯è¿™æ ·çš„æ–¹æ¡ˆã€‚æ¯”å¦‚ï¼Œç°æœ‰Aï¼ŒBï¼ŒCï¼ŒDå››ä¸ªæ¨¡å—ï¼Œå…¶ä¸­Bä¾èµ–Aï¼ŒCä¾èµ–Bï¼ŒDä¾èµ–Aï¼Œé‚£ä¹ˆç°åœ¨è®¾å®šä»–ä»¬çš„Priorityåˆ†åˆ«ä¸ºA=1ï¼ŒB=10ï¼ŒC=20ï¼ŒD=30ï¼ˆ\bæ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜ï¼‰ã€‚ä½†æ˜¯æœ‰ä¸€å¤©ï¼Œå› ä¸ºæ–°çš„éœ€æ±‚ï¼ŒBæ¨¡å—ä¹Ÿéœ€è¦ä¾èµ–Dæ¨¡å—äº†ã€‚é‚£ä¹ˆæŒ‰ç…§Priorityçš„è§„åˆ™ï¼Œæˆ‘ä»¬éœ€è¦è°ƒæ•´Bçš„Priorityï¼Œä½¿ä¹‹å¤§äºDçš„Priorityï¼Œæ¯”å¦‚è®¾ç½®B=40ã€‚ä½†è¿™æ ·è®¾ç½®çš„è¯å°±ç ´åäº†Cä¾èµ–Bçš„å…³ç³»ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†Dçš„Priority\bè®¾ç½®ä¸ºæ¯”Bæ›´å°ï¼Œè¿™æ ·å°±ä¸ä¼šæœ‰é—®é¢˜ã€‚ä½†æ˜¯æˆ‘ä»¬åœ¨è¿™é‡Œä¸¾è¿™ä¸ªä¾‹å­çš„\bç›®çš„åœ¨äºè§£é‡Šï¼ŒPriorityçš„æ–¹æ¡ˆä¼šä½¿å¾—æ¨¡å—é—´çš„ä¾èµ–å…³ç³»æ›´åŠ å¤æ‚ï¼Œä¸¤ä¸ªæ¨¡å—é—´çš„ä¾èµ–å…³ç³»å¯èƒ½å½±å“åˆ°å…¶ä»–æ¨¡å—é—´çš„ä¾èµ–å…³ç³»ã€‚é‚£ä¹ˆï¼Œå¦‚æœå›å½’åˆ°æœ€ç†æƒ³çš„çŠ¶æ€ï¼Œæˆ‘ä»¬æ˜¯å¦å¯ä»¥é€šè¿‡æ¨¡å—ä»£ç†ç±»é—´çš„è€¦åˆå…³ç³»æŒ‡å®šç›¸å¯¹çš„åŠ è½½é¡ºåºï¼Œ\bç±»ä¼¼Masonryè¿™æ ·çš„å¸ƒå±€ç»„ä»¶ã€‚æ¯”å¦‚ï¼š 1â€¢ + (void)load &#123;2â€¢ [[FWModuleDelegateManager sharedInstance] registeModuleDelegate:[FWPushModuleDelegate class] forName:@&quot;FWPush&quot; after:@[@&quot;FWUserCenterModuleDelegate&quot;, @&quot;FWLocationModuleDelegate&quot;]];3â€¢ 4â€¢ [[FWModuleDelegateManager sharedInstance] registeModuleDelegate:[FWPushModuleDelegate class] forName:@&quot;FWPush&quot; forIndex:0];5â€¢ &#125; å½“ç„¶ï¼Œæˆ‘ä»¬ä¸Šé¢çš„ä»£ç åªæ˜¯ä¸ªç®€å•çš„è®¾æƒ³ï¼Œå®é™…çš„å®ç°å¯èƒ½ä¼šæ›´åŠ å¤æ‚ï¼Œæ¯”å¦‚ï¼Œå¦‚æœè€ƒè™‘åˆ°BeeHiveæ”¯æŒçš„æ¨¡å—ä»£ç†ç±»å¼‚æ­¥åŠ è½½çš„ç‰¹æ€§ï¼Œé‚£ä¹ˆè¿™ä¸ªç›¸å¯¹æ‰§è¡Œé¡ºåºçš„æ–¹æ¡ˆå¯èƒ½å°±éœ€è¦é€šè¿‡ä¿¡å·é‡æˆ–è€…é˜Ÿåˆ—çš„æ‰‹æ®µæ¥ç¡®ä¿ä¸åŒçº¿ç¨‹ä¸‹æ¨¡å—ä»£ç†ç±»çš„æ‰§è¡Œé¡ºåºäº†ã€‚åœ¨è¿™é‡Œï¼Œæœ¬æ–‡æš‚æ—¶åªåšè®¨è®ºï¼Œä¸ç»™å‡ºå®é™…æ–¹æ¡ˆã€‚ ä»£ç†æ–¹æ³•å˜åŠ¨çš„å…¼å®¹æ€§å¦‚æœè¯´ä¸Šä¸€ä¸ªé—®é¢˜å®é™…ä¸Šåªæ˜¯ä¸ªé€»è¾‘é—®é¢˜ï¼Œå¹¶ä¸å­˜åœ¨æŠ€æœ¯å¯èƒ½æ€§ä¸Šçš„æ˜¯ä¸éã€‚é‚£ä¹ˆå¯¹ä»£ç†æ–¹æ³•å˜åŠ¨çš„å…¼å®¹æ€§ï¼Œåˆ™æ˜¯æŠ€æœ¯æ–¹æ¡ˆçš„å®è´¨æ‰€åœ¨ã€‚ä»¥BeeHiveçš„æ–¹æ¡ˆï¼Œå®é™…ä¸Šæ˜¯æŠ›å¼ƒäº†çµæ´»æ€§çš„è€ƒé‡ï¼Œè¿™æ ·é™åˆ¶äº†å®ƒåœ¨è¿™ä¸€ç‚¹ä¸Šçš„ä¼˜åŒ–ç©ºé—´ã€‚ å››ã€BeeHiveæ˜¯æ€ä¹ˆåšæ¨¡å—é—´è°ƒç”¨çš„ï¼Ÿæ¨¡å—é—´è°ƒç”¨è§£å†³çš„æ˜¯æ¨¡å—é—´çš„ä¾èµ–è€¦åˆé—®é¢˜ã€‚å¸¸è§çš„å¤„ç†æ–¹æ¡ˆæœ‰ä»¥ä¸‹ä¸‰ç§ï¼šâ€¢ URLRouterï¼šå°†ä¸åŒçš„æ¨¡å—å®šä¹‰æˆä¸ºä¸åŒçš„URLï¼Œé€šè¿‡URLçš„å½¢å¼è¿›è¡Œè·¨æ¨¡å—è°ƒç”¨ã€‚â€¢ Target-Actionï¼šåˆ©ç”¨OCçš„runtimeèƒ½åŠ›ï¼ŒåŠ¨æ€çš„è°ƒç”¨æŒ‡å®šTargetçš„actionï¼›â€¢ ProtocolClassï¼šæ¨¡å—å®ç°æŒ‡å®šçš„åè®®ï¼Œä¾èµ–æ–¹é€šè¿‡åè®®å¯¹è±¡ä»¥åŠåè®®æ–¹æ³•å¯¹æ¨¡å—è¿›è¡Œè®¿é—®ï¼›è·¯ç”±çš„æ–¹æ¡ˆé™åˆ¶æ¯”è¾ƒå¤šï¼Œæˆ‘ä»¬åœ¨æ­¤æ¯”è¾ƒä¸€ä¸‹åä¸¤ç§æ–¹æ¡ˆã€‚BeeHiveæ¨¡å—è°ƒç”¨ProtocolClass / RouterBeeHiveçš„æ¨¡å—éƒ½å¿…é¡»å®ç°ä¸€ä¸ªç»§æ‰¿è‡ªBHServiceProtocolçš„å”¯ä¸€è‡ªå®šä¹‰åè®®ï¼Œæ­¤åè®®ä¸­å®šä¹‰è‡ªå·±æƒ³è¦å…¬å¼€çš„æ–¹æ³•ï¼Œæ˜¯ç”¨æ¥ç»™å…¶ä»–æ¨¡å—è°ƒç”¨ä½¿ç”¨çš„ã€‚æ¯ä¸ªæ¨¡å—çš„è‡ªå®šä¹‰åè®®å¯ä»¥ç»Ÿä¸€æ”¾åœ¨ä¸€ä¸ªpodä¸­ï¼Œä»¥ä¸­ä»‹è€…æ¨¡å¼è§£å†³ç½‘çŠ¶ä¾èµ–çš„é—®é¢˜ã€‚è€Œä¸”è¯¥podåªä¼šè¢«å…·ä½“çš„æ¨¡å—ä¾èµ–ï¼Œå¹¶ä¸ä¼šä¾èµ–å…·ä½“çš„æ¨¡å—ã€‚å®Œå…¨ç¬¦åˆé¢å‘å¯¹è±¡çš„ä¾èµ–å€’ç½®åŸåˆ™â€”â€”æŠ½è±¡ä¸åº”è¯¥ä¾èµ–äºå…·ä½“å®ç°ï¼Œå…·ä½“å®ç°åº”è¯¥ä¾èµ–äºæŠ½è±¡ã€‚å°†æ¨¡å—æ³¨å†Œè¿›å…¥BHServiceManagerä¸­ï¼ŒBeeHiveä¹Ÿæä¾›äº†å¤šç§æ–¹æ³•ï¼š åœ¨æ¨¡å—ä»£ç†ç±»ä¸­æ‰‹åŠ¨æ³¨å†Œ[[BeeHive shareInstance] registerService:@protocol(TradeServiceProtocol) service:[BHTradeViewController class]];; é€šè¿‡æ³¨è§£çš„å½¢å¼æ³¨å†Œ@BeeHiveService(HomeServiceProtocol,BHViewController); é€šè¿‡[BHContext shareInstance].serviceConfigName = @&quot;BeeHive.bundle/BHService&quot;;æŒ‡å®šçš„é…ç½®æ–‡ä»¶åŠ è½½ã€‚BeeHiveå¦å¤–è¿˜æä¾›äº†\bé€šè¿‡è·¯ç”±BHRouterè¿›è¡Œæ¨¡å—é—´è°ƒç”¨çš„æ–¹æ¡ˆã€‚æ¨¡å—é—´è°ƒç”¨æ¶‰åŠçš„ç±»å‹æœ‰ï¼šBHServiceProtocolBHServiceManagerBHRouter ä¸è¶³ï¼š æœ‰åŸºç¡€åè®®ï¼Œå­˜åœ¨ä»£ç \bä¾µå…¥ï¼Œä½†å…¶ä¸­å¹¶æœªå°è£…é€šç”¨æ€§çš„åè®®æ–¹æ³•ï¼› BHServiceManageræ³¨å†Œæ—¶é€šè¿‡åè®®è¯†åˆ«æ¨¡å—ï¼Œå› æ­¤æ¯ä¸ªæ¨¡å—å¿…é¡»å®šä¹‰è‡ªå·±çš„åè®®ï¼› é€šè¿‡é…ç½®æ–‡ä»¶æ³¨å†Œæ—¶ï¼Œæœªæä¾›å±æ€§æ³¨å…¥ï¼› å› ä¸ºæ¨¡å—é€šè¿‡BeeHiveç»Ÿä¸€æ³¨å†Œååˆ›å»ºï¼Œæ‰€ä»¥Serviceä¹‹é—´çš„ä¾èµ–ï¼Œå¯èƒ½å¯¼è‡´Serviceåœ¨æ³¨å†Œå‰ä½¿ç”¨ï¼›å› è€Œéœ€è¦æ§åˆ¶Serviceçš„åŠ è½½é¡ºåºï¼›ä¼˜ç‚¹ï¼š æ¨¡å—ä¸å­˜åœ¨\bæˆ–æœªæ³¨å†Œæ—¶ï¼Œä¸ä¼šè·å–åˆ°å®ä¾‹ï¼Œå¯ä»¥çµæ´»å¤„ç†ï¼›å¦å¤–ï¼Œå› ä¸ºæš‚æ—¶æ²¡æœ‰å¼„æ¸…BHRouterçš„ä½¿ç”¨åœºæ™¯ï¼Œæˆ‘å®åœ¨åˆ†ä¸æ¸…â€œæ”¯æŒRouterå¼è°ƒç”¨â€è¿™æ˜¯BeeHiveæ¡†æ¶çš„ä¼˜ç‚¹è¿˜æ˜¯ä¸è¶³ã€‚ CTMediatoræ¨¡å—è°ƒç”¨Target-ActionCTMediatorçš„æ–¹æ¡ˆä¸­ï¼Œæ¯ä¸ªæ¨¡å—éœ€è¦å®šä¹‰è‡ªå·±çš„Targetå¯¹è±¡ï¼Œä½œä¸ºå…¬å…±æ–¹æ³•å£°æ˜ï¼Œå…¶ä¸­å®šä¹‰çš„Actionéƒ½æ˜¯ç»™å…¶ä»–æ¨¡å—è°ƒç”¨ä½¿ç”¨çš„ã€‚ä¸ºäº†è§£å†³ç½‘çŠ¶ä¾èµ–çš„é—®é¢˜ï¼Œå¯ä»¥ä¸ºæ¯ä¸ªæ¨¡å—å®šä¹‰ä¸€ä¸ªCTMediator\bçš„categoryå¯¹Targetè¿›è¡ŒäºŒæ¬¡å°è£…ï¼Œè¿™äº›categoryæ”¾åœ¨ç»Ÿä¸€çš„podä¸­ï¼Œä½œä¸ºä¸€ä¸ªä¸­ä»‹è€…ã€‚æŒ‰æ­£å¸¸çš„é€»è¾‘ï¼Œè¿™ä¸ªç»Ÿä¸€podæ˜¯ä¼šä¾èµ–å…·ä½“çš„æ¨¡å—çš„ï¼Œä½†æ˜¯CTMediatorçš„æ–¹æ¡ˆä¸­ï¼Œæ˜¯åˆ©ç”¨runtimeè°ƒç”¨å¯¹åº”çš„Target-Actionï¼Œæ‰€ä»¥è§£é™¤äº†ç›´æ¥çš„ä»£ç ä¾èµ–ã€‚ä¸è¶³ï¼š Targetæ— åŸºç¡€ç±»å‹ï¼Œç¼ºä¹æŠ½è±¡ï¼Œæ¨¡å—éœ€è¦è‡ªå·±å®ç°Target-Action; å½“æ¨¡å—ä¸å­˜åœ¨æ—¶ï¼Œæ— æ³•\bæå‰å¤„ç†ï¼Œåªèƒ½è®¾ç½®é»˜è®¤å¤„ç†æ–¹æ³•ï¼› categoryä¸­éƒ½æ˜¯ç¡¬ç¼–ç ï¼Œä¿®æ”¹æ—¶ä¼šæ¯”è¾ƒéº»çƒ¦ã€‚ä¼˜ç‚¹ï¼š Targetæ— åŸºç¡€ç±»å‹ï¼Œæ‰€ä»¥æ— ä¾µå…¥æ€§ï¼› æ¨¡å—ä¸éœ€æ³¨å†Œ; ä¸¤å±‚å°è£…ï¼Œä¿è¯çµæ´»æ€§ï¼› å’Œåº”ç”¨é—´çš„Routeè·³è½¬å¯ä»¥æ›´çµæ´»çš„å¯¹æ¥ï¼› æ¨¡å—é—´è°ƒç”¨çš„è®¨è®ºè¿™ä¸ªæ¨¡å—é—´è°ƒç”¨çš„é—®é¢˜å…¶å®å°±æ˜¯â€œä¾èµ–å€’ç½®â€\bæ‰€è§£å†³çš„é—®é¢˜ã€‚BeeHiveçš„æ–¹æ¡ˆåº”è¯¥æ˜¯\bä¾èµ–å€’ç½®åŸåˆ™çš„æ ‡å‡†å®ç°æ–¹æ¡ˆï¼Œè€ŒCTMediatoråˆ™æ˜¯å……åˆ†ä½¿ç”¨äº†OCçš„ç‰¹æ€§å‰‘èµ°åé”‹ã€‚è€ŒCTMediatorä¹‹æ‰€ä»¥éœ€è¦è¿™æ ·å¤„ç†ï¼Œå®è´¨ä¸Šå°±æ˜¯å› ä¸ºå®ƒè¿½æ±‚ä»£ç çš„æ— ä¾µå…¥æ€§ä»¥åŠå…æ³¨å†Œï¼Œæ‰€ä»¥Targetæ²¡æœ‰ç»Ÿä¸€çš„åŸºç¡€ç±»å‹ã€‚å¦‚æœå¢åŠ ä¸€ä¸ªåŸºç¡€çš„Targetç±»ï¼ŒåŒæ ·å¯ä»¥åƒBeeHive\bçš„æ–¹æ¡ˆä¸€æ ·ï¼Œå®Œç¾çš„ç¬¦åˆä¾èµ–å€’ç½®åŸåˆ™ã€‚è€Œå“ªä¸ªé€‚åˆä½ ï¼Œå°±è¦çœ‹è‡ªå·±çš„å–èˆäº†ã€‚ äº”ã€BeeHiveçš„å¼€å‘æ”¯æŒåŠŸèƒ½â€¢ ç¯å¢ƒåˆ‡æ¢ï¼šBHContextç±»ä¸­å®šä¹‰äº†envç”¨æ¥æ ‡è¯†å½“å‰çš„ç¯å¢ƒç±»å‹ï¼Œåªä¸è¿‡è¿™ä¸ªåŠŸèƒ½å¤ªç®€å•äº†äº›ã€‚â€¢ æ—¶é—´ç»Ÿè®¡å·¥å…·ï¼šBHTimeProfilerâ€¢ çœ‹é—¨ç‹—ï¼Œç”¨æ¥æ£€æµ‹ä¸»çº¿ç¨‹å ç”¨ï¼šBHWatchDogå› ä¸ºæœ¬æ¬¡é‡ç‚¹æ˜¯è®¨è®ºæ¡†æ¶ï¼Œæ‰€ä»¥è¿™äº›å†…å®¹æš‚ä¸è¯¦è¿°ã€‚ å…­ã€æˆ‘ä»¬çš„æ–¹æ¡ˆé€‰æ‹©Objective-Cæ˜¯å¦é€‚åˆPOPå¼€å‘ï¼ŸPOPï¼šProtocol-Oriented Programmingåœ¨\bçœ‹äº†è¿™ä¹ˆå¤šæ¡†æ¶çš„ä¼˜åŠ£åï¼Œæƒ³è¯·å¤§å®¶æ€è€ƒä¸ªé—®é¢˜ï¼šObjective-Cå¼€å‘æ˜¯å¦é€‚åˆé¢å‘åè®®ç¼–ç¨‹ï¼Ÿæˆ‘ä¸ªäººè§‰å¾—\bPOPçš„å…³é”®ç‚¹æœ‰ä¸¤ç‚¹ï¼Œä¸€æ˜¯å£°æ˜ä¸å®ç°çš„éš”ç¦»ï¼ŒäºŒæ˜¯å¯¹äºå¤šæ€çš„æ”¯æŒã€‚è€Œå¯¹äºObjective-Cæ¥è¯´ï¼Œå£°æ˜ä¸å®ç°çš„éš”ç¦»ï¼Œè¿™åœ¨.hä¸.mä¸­å·²ç»å®ç°ï¼Œè™½ç„¶åªæ˜¯è¡¨é¢çš„ï¼Œå¹¶æ²¡æœ‰åšåˆ°å®Œå…¨è§£è€¦ï¼›ä½†å¾ˆå¤šæ—¶å€™çš„å°è£…æ€§å·²ç»å¯ä»¥æ»¡è¶³ã€‚è€Œå¯¹äºå¤šæ€çš„æ”¯æŒï¼Œå¾ˆå¤šæ—¶å€™å…¶å®å°±æ˜¯ç¨‹åºèƒ½åŠ›çš„æ‰©å±•ï¼Œåœ¨è¿™ä¸€æ–¹é¢Objective-Cæ˜¯é€šè¿‡Categoryå®ç°çš„ã€‚å› æ­¤ï¼ŒOCå¯¹äºPOPä¼¼ä¹æ²¡æœ‰è¿«åˆ‡çš„éœ€æ±‚ã€‚ é€‰æ‹©æ–¹æ¡ˆæœ¬ç€å­¦ä»¥è‡´ç”¨çš„åŸåˆ™ï¼Œæˆ‘ä»¬å¦‚æœè¦å¼€å‘é¡¹ç›®ï¼Œéœ€è¦é€‰å®šä¸€ä¸ªç¡®å®šçš„æ¡†æ¶æ–¹æ¡ˆï¼Œé‚£ä¹ˆç»¼åˆä»¥ä¸Šçš„åˆ†ææ¯”è¾ƒï¼Œæˆ‘ä¸ªäººçš„å€¾å‘æ–¹æ¡ˆæ˜¯ï¼šåŸºäºMLSOAppDelegateè¿›è¡Œä¼˜åŒ–ï¼Œå¢åŠ BeeHiveçš„ä¼˜ç‚¹ï¼ˆæ”¯æŒé¡ºåºè®¾å®šã€å¼‚æ­¥åŠ è½½ï¼‰ï¼Œæ”¯æŒç›¸å¯¹é¡ºåº + åŸºäºCTMediatorè¿›è¡Œä¼˜åŒ–ï¼ˆå¢åŠ Targeté¢„æ£€æµ‹ï¼‰ï¼Œ\bä¸šåŠ¡å±‚å¢åŠ éƒ¨åˆ†æŠ½è±¡ä»¥ä¸Šæ˜¯æˆ‘çš„ç­”æ¡ˆï¼Œå¦‚æœæ˜¯ä½ ï¼Œä½ ä¼šé€‰æ‹©ä»€ä¹ˆå‘¢ï¼Ÿ å‚è€ƒæ–‡æ¡£ BeeHiveï¼Œä¸€æ¬¡iOSæ¨¡å—åŒ–è§£è€¦å®è·µ BeeHive â€”â€” ä¸€ä¸ªä¼˜é›…ä½†è¿˜åœ¨å®Œå–„ä¸­çš„è§£è€¦æ¡†æ¶ iOSå¤§å‹é¡¹ç›®è§£è€¦æ–¹æ¡ˆæœ‰éš¾åº¦ï¼ŸBeeHiveè®¾è®¡ä¼˜åŒ–æ¥å¸®åŠ© BeeHive@github","categories":[{"name":"æ¶æ„çŸ¥è¯†","slug":"æ¶æ„çŸ¥è¯†","permalink":"http://yoursite.com/categories/%E6%9E%B6%E6%9E%84%E7%9F%A5%E8%AF%86/"}],"tags":[{"name":"ç»„ä»¶åŒ–","slug":"ç»„ä»¶åŒ–","permalink":"http://yoursite.com/tags/%E7%BB%84%E4%BB%B6%E5%8C%96/"}]},{"title":"æ¶æ„æ¦‚å¿µ","slug":"æ¶æ„æ¦‚å¿µ","date":"2020-05-23T08:26:15.000Z","updated":"2020-07-02T10:51:56.000Z","comments":true,"path":"2020/2020-05-23-16:26:15/","link":"","permalink":"http://yoursite.com/2020/2020-05-23-16:26:15/","excerpt":"ç»„ä»¶ã€æ’ä»¶ã€æ¨¡å—ã€å­åº”ç”¨ã€åº“ã€æ¡†æ¶ç­‰æ¦‚å¿µè¾¨æ","text":"ç»„ä»¶ã€æ’ä»¶ã€æ¨¡å—ã€å­åº”ç”¨ã€åº“ã€æ¡†æ¶ç­‰æ¦‚å¿µè¾¨æ ç½‘ä¸Šæœ‰è®¸å¤šè®²ç»„ä»¶åŒ–ã€æ¨¡å—åŒ–ç­‰æ¦‚å¿µçš„æ–‡ç« ï¼Œä½†å¤§å®¶ä¸€èˆ¬éƒ½æ˜¯å°†è¿™ä¸¤ä¸ªæ¦‚å¿µæ··ä¸ºä¸€è°ˆçš„ï¼Œå¹¶æ²¡æœ‰åŠ ä»¥åŒºåˆ†ã€‚è€Œä¸”å®é™…ä¸Šè®¸å¤šäººå¯¹äºç»„ä»¶ã€æ’ä»¶ã€æ¨¡å—ã€å­åº”ç”¨ç­‰æ¦‚å¿µçš„åŒºåˆ«ä¹Ÿä¸ç”šæ˜äº†ï¼Œç”šè‡³äºè®¸å¤šåšå®¢æ–‡ç« ä¸“é—¨è§£è¯´è¿™å‡ ä¸ªæ¦‚å¿µéƒ½æœ‰äº›è°¬è¯¯ã€‚ä¹‹å‰å·²ç»å†™äº†ä¸€ç¯‡æ–‡ç« ä¸“é—¨å¯¹ç»„ä»¶å’Œæ¨¡å—ä¸¤ä¸ªæ¦‚å¿µè¿›è¡Œè¾¨æï¼Œç°åœ¨æˆ‘ä»¬å¯¹äºæ›´å¤šçš„æ¦‚å¿µåœ¨æ›´é«˜çš„å±‚æ¬¡ä¸Šè¿›è¡Œè¾¨æã€‚æƒ³åˆ†æ¸…è¿™å‡ ä¸ªæ¦‚å¿µæˆ‘è§‰å¾—ç»“åˆä¸€ä¸‹è½¯ä»¶çš„æ¸è¿›å¼å¼€å‘åœºæ™¯æ›´å®¹æ˜“ç†è§£ã€‚ä½†æ˜¯ä¸‹é¢çš„ç¯‡å¹…ä¼šæ¯”è¾ƒé•¿ï¼Œæ‰€ä»¥æŒ‰æƒ¯ä¾‹è¿˜æ˜¯å…ˆè¯´ç»“è®ºï¼Œä¸è€çƒ¦çš„åŒå­¦å¯ä»¥å…ˆçœ‹ï¼š 1.æ¦‚å¿µåŒºåˆ«â€¢ ç»„ä»¶ï¼šä»£ç é‡ç”¨ï¼ŒåŠŸèƒ½ç›¸å¯¹å•ä¸€æˆ–è€…ç‹¬ç«‹ï¼Œæ— ç»Ÿä¸€æ¥å£ã€‚ç»„ä»¶åŒ–å¼€å‘çš„æˆæœæ˜¯åŸºç¡€åº“å’Œå…¬å…±ç»„ä»¶ã€‚â€¢ æ’ä»¶ï¼šè¿‘ä¹ç»„ä»¶ï¼Œæœ‰ç»Ÿä¸€æ¥å£â€¢ æ¨¡å—ï¼šé«˜å†…èšï¼Œæ¾è€¦åˆï¼ŒåŠŸèƒ½ç›¸å¯¹å¤æ‚ï¼Œæœ‰å¤šä¸ªç»Ÿä¸€æ¥å£ã€‚æ¨¡å—åŒ–å¼€å‘çš„åŸºç¡€æ˜¯æ¡†æ¶ã€‚â€¢ å­ç³»ç»Ÿï¼šé«˜äºæ¨¡å—ï¼Œéœ€è¦ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚å­ç³»ç»Ÿå¼€å‘çš„åŸºç¡€æ˜¯å®¹å™¨ã€‚ 1.1.ç»„ä»¶å’Œæ’ä»¶æ’ä»¶çš„æ¦‚å¿µæ¯”è¾ƒå½¢è±¡ï¼Œä¸€èˆ¬å­˜åœ¨ä¸€ä¸ªâ€œæ’æ‹”â€è¿‡ç¨‹ï¼Œæ‰€ä»¥è¦æ±‚å¯æ’æ‹”çš„æ’ä»¶æœ‰ä¸€ä¸ªç›¸åŒçš„æ¥å£ï¼ˆè¿™é‡Œæ‰€è¯´çš„æ¥å£åªæ˜¯æ¦‚å¿µä¸Šçš„æ¥å£ï¼Œå³è°ƒç”¨æ–¹æ³•åŠå‚æ•°ç­‰ï¼‰ã€‚è€Œç»„ä»¶æ˜¯ä¸å­˜åœ¨è¿™ä¸ª\bç›¸åŒæ¥å£çš„ã€‚æ‹¿æˆ‘ä»¬æœ€å¸¸è§çš„ç½‘ç»œè¯·æ±‚åŠŸèƒ½ä¸¾ä¾‹ï¼Œæ— è®ºå“ªç§å¼€å‘è¯­è¨€ï¼Œgithubä¸Šå¯èƒ½éƒ½æœ‰å¤šç§ç½‘ç»œè¯·æ±‚ç»„ä»¶ï¼Œé‚£ä¹ˆå¯¹äºä¸€ä¸ª\bé¡¹ç›®è€Œè¨€ï¼Œä»ä¸€ä¸ª\bç½‘ç»œç»„ä»¶ComponentAåˆ‡æ¢ä¸ºå¦ä¸€ä¸ªç½‘ç»œç»„ä»¶ComponentBæ˜¯åŸºæœ¬æ— æ³•åšåˆ°è°ƒç”¨æ–¹æ³•ä¸æ”¹åŠ¨çš„ã€‚è€Œå¦‚æœæŠŠç½‘ç»œè¯·æ±‚ç»„ä»¶æ’ä»¶åŒ–ï¼Œå³åœ¨ç»„ä»¶å¤–å±‚æŠ½è±¡ä¸€å±‚\bç»Ÿä¸€åŒ–çš„è°ƒç”¨æ¥å£NetworkInterfaceï¼Œç„¶åå°†å½“å‰ä½¿ç”¨ç½‘ç»œè¯·æ±‚ç»„ä»¶ComponentAåŒ…è£…æˆå®ç°è¯¥æ¥å£çš„ç½‘ç»œè¯·æ±‚æ’ä»¶PluginAã€‚é‚£ä¹ˆå¦‚æœä»¥åéœ€è¦å°†ä½¿ç”¨çš„ComponentAåˆ‡æ¢ä¸ºComponentBï¼Œé‚£ä¹ˆåªéœ€è¦å°†ComponentBåŒ…è£…æˆPluginBå¹¶æ’å…¥åˆ°åº”ç”¨ä¸­\bå³å¯ã€‚å®é™…è°ƒç”¨æ—¶ï¼Œä¸šåŠ¡ä»£ç è¿˜æ˜¯è°ƒç”¨NetworkInterfaceï¼Œä¸ç”¨åšä»»ä½•ä¿®æ”¹ã€‚ä»ä¸Šé¢è¿™ä¸ªä¾‹å­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œæ’ä»¶å’Œç»„ä»¶çš„\bå®è´¨åŒºåˆ«å°±åœ¨äºé€šè¿‡ç»Ÿä¸€æ¥å£éš”ç»ä¸šåŠ¡ä»£ç å¯¹äºç»„ä»¶çš„ç›´æ¥ä¾èµ–ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬å¸¸å¬åˆ°çš„æ‰€è°“çš„â€œé¡¹ç›®å¼€å‘æ—¶åº”è¯¥æŠŠç¬¬ä¸‰æ–¹ç»„ä»¶å°è£…ä¸€ä¸‹å†ç”¨â€ã€‚ 1.2.ç»„ä»¶å’Œæ¨¡å—ä¸¤è€…çš„å®è´¨åŒºåˆ«åœ¨äºï¼šç»„ä»¶åŒ–å¼€å‘æ˜¯çºµå‘åˆ†å±‚ï¼Œæ¨¡å—åŒ–å¼€å‘æ˜¯æ¨ªå‘åˆ†å—ã€‚æ‰€ä»¥ï¼Œæ¨¡å—åŒ–å¹¶æ²¡æœ‰è¦æ±‚ä¸€å®šç»„ä»¶åŒ–ï¼Œå°±æ˜¯è¯´è¿›è¡Œæ¨¡å—åŒ–æ‹†åˆ†æ—¶ä½ å¯ä»¥å®Œå…¨ä¸è€ƒè™‘ä»£ç é‡ç”¨ï¼Œåªæ˜¯æŠŠåŒä¸€ä¸šåŠ¡çš„ä»£ç åšå†…èšæ•´åˆæˆä¸åŒçš„æ¨¡å—ã€‚åªä¸è¿‡è¿™æ ·å¾—åˆ°çš„æˆæœç›¸å¯¹ç®€å•ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸ä¼šè¿™æ ·è€Œå·²ã€‚ç»„ä»¶åŒ–å°±æ¯”å¦‚é¡¹ç›®ä¸­å…¬å…±çš„alertæ¡†ï¼Œå®ƒçš„å‡ºç°å…¶å®æ˜¯åŸºäºä»£ç å¤ç”¨çš„ç›®çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠå®ƒå°è£…ï¼Œå¹¶ç»™å¤šä¸ªåœ°æ–¹ä½¿ç”¨ã€‚è€Œæ¨¡å—åŒ–å°±æ¯”å¦‚ä¸€ä¸ªèµ„è®¯åˆ—è¡¨ç•Œé¢ï¼Œå®ƒæœ¬èº«å¯èƒ½åªåœ¨ä¸€ä¸ªåœ°æ–¹ä½¿ç”¨ï¼Œæ²¡æœ‰å¤ç”¨çš„éœ€æ±‚ï¼Œä½†æˆ‘ä»¬ä¹Ÿè¦æŠŠå®ƒå°è£…æˆæ¨¡å—ï¼Œè¿™æ˜¯é«˜å†…èšçš„è¦æ±‚ï¼Œæˆ‘ä»¬ä¸åº”è¯¥æŠŠèµ„è®¯ç›¸å…³çš„ä»£ç åœ¨é¡¹ç›®ä¸­æ”¾å¾—åˆ°å¤„éƒ½æ˜¯ã€‚ä½†åƒè¿™æ ·çš„ç®€å•æ¨¡å—åªæ˜¯è½»æ¨¡å—ï¼Œç»Ÿä¸€æ¥å£è¾ƒå°‘ã€‚è€Œç»Ÿä¸€å®šä¹‰çš„æ¥å£è¶Šå¤šï¼Œå…¶å®å’Œä¸»åº”ç”¨çš„è€¦åˆå°±è¶Šé«˜ï¼Œä¹Ÿä¾¿æ˜¯é‡æ¨¡å—ã€‚è€Œè·¯ç”±å°±æ˜¯è§£å†³é«˜è€¦åˆé—®é¢˜çš„ï¼Œä¸è¿‡è€¦åˆé—®é¢˜ä¸æ˜¯æ¨¡å—åŒ–å¼€å‘çš„éœ€æ±‚ï¼Œåªä¸è¿‡æˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šåœ¨è¿™ä¸ªæ—¶é—´è€ƒè™‘è¿™ä¸€äº‹æƒ…è€Œå·²ï¼Œå°±åƒæˆ‘ä»¬ä¸ä¼šåªåšæ¨¡å—åŒ–å¼€å‘åŒæ—¶ä¸åšç»„ä»¶åŒ–å¼€å‘ä¸€æ ·ã€‚ 1.3.æ¨¡å—å’Œå­åº”ç”¨æ¨¡å—å’Œå­åº”ç”¨çš„åŒºåˆ«ä¸ç»„ä»¶å’Œæ’ä»¶çš„åŒºåˆ«æœ‰ç‚¹åƒï¼Œéƒ½åœ¨äºä¸€ä¸ªç»Ÿä¸€æ¥å£ã€‚å­åº”ç”¨æˆ‘ä»¬ä¸å¸¸æï¼Œä½†å…¶å®å¹¶ä¸å°‘è§ï¼Œåƒå¾®ä¿¡å°ç¨‹åºï¼Œé’‰é’‰ä¸­çš„ç¬¬ä¸‰æ–¹åº”ç”¨è¿˜æœ‰ä¼ä¸šOAåº”ç”¨ä¸­é›†æˆçš„å‘¨è¾¹åŠŸèƒ½æ¨¡å—éƒ½åº”è¯¥å±äºå­åº”ç”¨çš„æ¦‚å¿µã€‚å¯¹äºæ¨¡å—è€Œè¨€ï¼Œå®ƒæš´éœ²ç»™\bå¤–éƒ¨è°ƒç”¨çš„æ¥å£ä¸€èˆ¬å¾ˆå°‘ï¼Œæœ€å¸¸è§çš„å°±æ˜¯ä¸Šé¢æåˆ°çš„è·¯ç”±è§„åˆ™ï¼Œç›¸å½“äºå¯ä»¥è®©å¤–éƒ¨é€šè¿‡è·¯ç”±è§„åˆ™å±•ç¤ºå®ƒã€‚è€Œå­åº”ç”¨éœ€è¦çš„å°±ä¸åªæ˜¯ä¸€ä¸ªå±•ç¤ºæ¥å£ï¼Œå®ƒå¯èƒ½éœ€è¦åŠ¨æ€çš„æ§åˆ¶å­åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸï¼Œä»¥åŠå…¶ä»–åŠŸèƒ½ä¸Šçš„ä¿¡æ¯äº¤äº’ï¼ˆæ¯”å¦‚ï¼Œè´¦æˆ·ä¿¡æ¯çš„åŒæ­¥ï¼‰ï¼Œç”šè‡³äºè¦åšåˆ°ç±»ä¼¼æ’ä»¶é‚£æ ·çš„æ’æ‹”æ•ˆæœã€‚æ‰€ä»¥å­åº”ç”¨å¿…ç„¶æ˜¯æ¥å£åŒ–çš„ï¼Œè€Œæ¨¡å—åˆ™æ²¡æœ‰ç¡¬æ€§çš„è¦æ±‚ã€‚ 1.4.åº“å’Œæ¡†æ¶é™¤äº†ä¸Šé¢è¿™å››ç§æ¦‚å¿µï¼Œè¿˜æœ‰ä¸¤ä¸ªæ˜¯æˆ‘ä»¬å¼€å‘ä¸­å¸¸é‡åˆ°çš„ï¼šåº“å’Œæ¡†æ¶ã€‚åº“ï¼Œæˆ–è€…åŸºç¡€åº“ï¼Œæ¦‚å¿µä¸Šåè¿‘äºå„ç§å·¥å…·\bç§¯ç´¯æˆçš„é›†åˆï¼Œæ˜¯è½¯ä»¶ä»£ç çš„å±‚é¢æ˜¯åˆ†å±‚çš„æ¦‚å¿µï¼Œæ‰€ä»¥å¯¹åº”ç»„ä»¶åŒ–ã€‚åŸºç¡€åº“ç”šè‡³å¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªå¤§çš„ç»„ä»¶ã€‚è€Œæ¡†æ¶é¡¾åæ€ä¹‰æ˜¯ç»“æ„åŒ–çš„ï¼Œæ˜¯ç›¸å¯¹æ•´ä½“çš„ä¸€ä¸ªæ¦‚å¿µï¼Œæ‰€ä»¥åº”ç”¨äºæ¨¡å—åŒ–ï¼Œç”šè‡³æ˜¯å­åº”ç”¨åŒ–ã€‚æ¯”å¦‚åœ¨iOSä¸­ï¼ŒRACæ˜¯ä¸€ä¸ªåº“ï¼Œè€ŒåŸºäºæ­¤çš„ä¸€å¥—MVVMçš„å…·ä½“å®ç°æˆæœï¼ˆå•é¡µé¢çš„æ–‡ä»¶ç»“æ„ï¼Œå¤šé¡µé¢çš„äº¤äº’ç­‰ç­‰ï¼‰æ‰å«æ¡†æ¶ã€‚å› ä¸ºæ¡†æ¶æœ¬èº«å°±æœ‰æ¶æ„æ€æƒ³åœ¨é‡Œé¢ã€‚ 2.æ¸è¿›å¼è¾¨æä¸Šé¢è®²äº†ä¸€ä¸‹å‡ ä¸ªæ¦‚å¿µçš„åŒºåˆ«ï¼Œå½“ç„¶è¿™å‡ ä¸ªæ¦‚å¿µåœ¨æœåŠ¡ç«¯å¼€å‘å’Œå®¢æˆ·ç«¯å¼€å‘é¢†åŸŸå¯èƒ½æœ‰äº›å¾®å·®åˆ«ï¼Œæˆ‘ä»¬å°±ä¸æ·±ç©¶äº†ã€‚æƒ³è¦æ›´æ·±å…¥çš„äº†è§£è¿™äº›æ¦‚å¿µçš„åŒºåˆ«ï¼Œæˆ‘å‡†å¤‡æ‹¿ä¸€ä¸ªæ¸è¿›å¼å¼€å‘ç§»åŠ¨ç«¯é¡¹ç›®çš„ä¾‹å­è¿›è¡Œè¾¨æã€‚é¦–å…ˆæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªè™šæ‹Ÿçš„äº§å“â€”â€”ä¸€æ¬¾çŸ¥è¯†ç±»åº”ç”¨ï¼ŒåŒ…å«å¸¸è§çš„èµ„è®¯ã€é—®ç­”ã€å­¦é™¢ã€ç›´æ’­ç­‰åŠŸèƒ½ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ä»è®¾è®¡çš„è§’åº¦é€æ­¥æ‹†åˆ†è¿™ä¸ªäº§å“ã€‚ 2.1åŸå§‹æ€å¦‚æœå¼€å‘æ—¶æ²¡æœ‰è€ƒè™‘ä»»ä½•ç»„ä»¶åŒ–ã€æ¨¡å—åŒ–å¼€å‘ï¼Œé‚£ä¹ˆæ­¤åº”ç”¨çš„æ‰€æœ‰åŠŸèƒ½éƒ½æ˜¯å †ç§¯åœ¨ä¸€èµ·çš„ï¼Œæ€»ç»“èµ·æ¥å°±æ˜¯ä»£ç ç‰¹ç‚¹å°±æ˜¯é«˜è€¦åˆï¼Œä½å†…èšï¼Œæ— é‡ç”¨ã€‚é¢å¯¹è¿™æ ·çš„ä¸€å †ä»£ç ï¼Œ\bæŠ€æœ¯ç»ç†å¯èƒ½è¦è®©ä½ åšä¸€ä¸‹ä»£ç é‡æ„ï¼Œè¿™å°±æ˜¯ä½ ä¸‹ä¸€æ­¥çš„å·¥ä½œã€‚ 2.2ç»„ä»¶\bé‚£ä¹ˆä½ è¿›è¡Œä»£ç é‡æ„çš„ç¬¬ä¸€æ­¥æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿç­”ï¼šå°†å·¥ç¨‹ä¸­é‡å¤çš„ä»£ç åˆå¹¶æˆä¸ºä¸€ä»½ï¼Œä¹Ÿå°±æ˜¯é‡ç”¨ã€‚å¦‚æœè®©æˆ‘ä»¬æ¥çœ‹ç»„ä»¶åŒ–å¼€å‘çš„å®šä¹‰ï¼Œå®ƒçš„ç€é‡ç‚¹å°±æ˜¯ä»£ç é‡ç”¨ã€‚é‚£è¿™ä¸€æ­¥æœ€åçš„ç»“æœå°±æ˜¯æç‚¼å‡ºä¸€ä¸ªä¸ªç»„ä»¶ç»™ä¸åŒçš„åŠŸèƒ½ä½¿ç”¨ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹ä¸€ä¸‹å…¶ä¸­çš„ä¾èµ–å…³ç³»ï¼šå…·ä½“åŠŸèƒ½ä¾èµ–æç‚¼å‡ºæ¥çš„ç»„ä»¶ï¼Œç»„ä»¶æœ¬èº«ä¹‹é—´å¯èƒ½ä¹Ÿæœ‰ä¾èµ–å…³ç³»ï¼Œä½†ä¸€èˆ¬ä¸å¤šã€‚æ‰€ä»¥æˆ‘ä»¬æ€»ç»“ç»„ä»¶åŒ–å¼€å‘çš„åŸåˆ™å°±æ˜¯é«˜é‡ç”¨ï¼Œä½è€¦åˆã€‚å½“ç„¶è¿™åªæ˜¯ç›¸å¯¹è€Œè¨€ã€‚åŸºäºè¿™æ ·çš„è®¤è¯†ï¼Œæˆ‘ä»¬ç”šè‡³äºå¯ä»¥æŠŠèµ„è®¯ã€é—®ç­”ã€å­¦é™¢ã€ç›´æ’­ç­‰åŠŸèƒ½å°è£…æˆç»„ä»¶ï¼Œåªä¸è¿‡è¿™äº›ç»„ä»¶æ¯”è¾ƒå¤§ï¼Œä¾èµ–å¯èƒ½å¤šäº›ï¼Œä¸è¿‡æœ¬è´¨ä¸Šæ²¡æœ‰å¤šå°‘åŒºåˆ«ã€‚å°±åœ¨ä½ è¿›è¡Œé‡æ„çš„è¿‡ç¨‹ä¸­ï¼Œè¿™æ—¶éœ€æ±‚æ¥äº†ï¼šè¿è¥äººå‘˜è¦æ±‚é¦–é¡µé¡¶éƒ¨çš„ä¹å®«æ ¼æ ·å¼å·¥å…·æ å¯åŠ¨æ€é…ç½®ï¼Œé€šè¿‡æœåŠ¡ç«¯æ•°æ®ä¿®æ”¹æ˜¾ç¤ºåŠŸèƒ½ï¼Œå¹¶è°ƒç”¨å¯¹åº”çš„åŠŸèƒ½é¡µé¢ã€‚ 2.3æ’ä»¶ä»£ç é‡æ„ä»æ¥ä¸æ˜¯è¶…ç„¶ç‰©å¤–çš„ï¼Œåœ¨è¿›è¡Œè¿‡ç¨‹ä¸­æ¥åˆ°æ–°éœ€æ±‚ä¹Ÿæ˜¯å¸¸æœ‰çš„äº‹æƒ…ã€‚é‚£ä¹ˆï¼Œå¯¹äºè¿™æ ·ä¸€ä¸ªéœ€æ±‚ï¼Œåº”è¯¥æ€ä¹ˆè€ƒè™‘å‘¢ï¼Ÿè¿™ä¸ªåŠ¨æ€åŒ–éœ€æ±‚å¾ˆæ™®éï¼Œåªä¸è¿‡è¿™é‡Œæœ‰ä¸€ä¸ªéšæ€§è¦æ±‚â€”â€”æ—¢ç„¶éœ€æ±‚ä¸­è¦æ±‚åŠŸèƒ½åŠ¨æ€é…ç½®ï¼Œé‚£ä¹ˆè°ƒç”¨åŠŸèƒ½çš„åœ°æ–¹å°±ä¸çŸ¥é“åŠŸèƒ½çš„å…·ä½“å®ç°ã€‚æ‰€ä»¥æœ€ç»ˆçš„æ–¹æ¡ˆä¸­è¢«è°ƒç”¨åŠŸèƒ½å¿…é¡»æœ‰ç»Ÿä¸€æ¥å£ã€‚æˆ‘ä»¬è¿™é‡Œè¯´çš„æ¥å£åªæ˜¯ç¼–ç¨‹é¢†åŸŸçš„æŠ½è±¡æ¦‚å¿µï¼Œå¹¶éæ˜¯æŒ‡å…·ä½“è¯­è¨€çš„interfaceæˆ–è€…protocolã€‚è€Œæœ‰äº†è¿™ä¸€ç»Ÿä¸€æ¥å£ï¼Œå…¶é…ç½®åŠŸèƒ½å…¶å®å°±æ˜¯â€œæ’æ‹”â€\bè¿‡ç¨‹äº†ã€‚è¿™æ ·çš„æˆæœå®è´¨ä¸Šå·²ç»æ˜¯æ’ä»¶äº†ã€‚æ’ä»¶å¯ä»¥è§£é‡Šæˆå¯æ’æ‹”å¼ç»„ä»¶ï¼Œå®ƒçš„æ ¸å¿ƒå°±æ˜¯ä¸åŒåŠŸèƒ½å®ç°æä¾›ç»Ÿä¸€æ¥å£ã€‚é¡¹ç›®ä¸­æ’ä»¶åŒ–çš„ä¾‹å­å…¶å®ä¹Ÿä¸å°‘ï¼Œå†ä¸¾ä¸€ä¸ªä¾‹å­ï¼šæ¯”å¦‚èµ„è®¯å’Œé—®ç­”åŠŸèƒ½ä½¿ç”¨çš„å¼¹æ¡†æ ·å¼ä¸åŒï¼Œä½†æ˜¯åœ¨ä¸¤ä¸ªåŠŸèƒ½å†…éƒ¨å…¶å¼¹æ¡†æ ·å¼æ˜¯ä¸€è‡´çš„ã€‚é¢å¯¹è¿™æ ·çš„é—®é¢˜ï¼Œä½ åœ¨é‡æ„æ—¶å¯èƒ½ä¼šç®€å•çš„å°è£…å‡ºä¸¤ä¸ªç»„ä»¶AlertAå’ŒAlertBï¼Œåˆ†åˆ«ç»™ä¸¤ä¸ªåŠŸèƒ½ä½¿ç”¨ã€‚è¿™æ ·ç¡®å®å¾ˆä¾¿æ·ï¼Œè€Œä¸”é€‚åˆå½“ä¸‹çš„åœºæ™¯ï¼Œä½†æ˜¯ä»è®¾è®¡æˆ–è€…é•¿è¿œå‘å±•çš„è§’åº¦ä¸Šæ¥è€ƒè™‘ï¼Œå¦‚æœèµ„è®¯é‡Œé¢å¼¹æ¡†æ ·å¼éœ€è¦\bæ¢æˆå’Œé—®ç­”ä¸€æ ·ï¼Œç”šè‡³å…¶ä»–æ ·å¼ï¼Œé‚£ä¹ˆåŸºäºç°æœ‰çš„æ–¹æ³•ï¼Œä½ å°±éœ€è¦ä¿®æ”¹èµ„è®¯åŠŸèƒ½ä¸­æ‰€æœ‰è°ƒç”¨å¼¹æ¡†çš„åœ°æ–¹ã€‚æ‰€ä»¥æ’ä»¶åŒ–æ˜¯è§£å†³è¿™ä¸ªé—®é¢˜çš„å¥½åŠæ³•ï¼šå®šä¹‰AlertInterfaceæ¥å£ç»™å…·ä½“ä¸šåŠ¡åŠŸèƒ½ä½¿ç”¨ï¼Œå¹¶å®ç°AlertPluginAã€AlertPluginBï¼Œåœ¨å¤–é¢ç»™ä¸åŒçš„åŠŸèƒ½æŒ‡å®šä¸èƒ½çš„æ’ä»¶å³å¯ã€‚ 2.4æ¨¡å—è¿™æ—¶å€™é¡¹ç›®çš„ç»„ä»¶åŒ–æ‹†åˆ†å®Œæˆï¼ŒæŠ€æœ¯ç»ç†è¯´ä»¥åä¸åŒçš„æ¨¡å—ä¼šäº¤ç”±ä¸åŒçš„äººæ¥ç»´æŠ¤ï¼Œå„äººç»´æŠ¤å„è‡ªè´Ÿè´£çš„ä»£ç ã€‚è¿™ä¸ªéœ€æ±‚åˆçœ‹ä¸Šå»åªæ˜¯é¡¹ç›®ç®¡ç†ä¸Šçš„éœ€æ±‚ï¼Œä½†å®é™…æ‰§è¡Œæ—¶è‹¥èµ„è®¯ã€é—®ç­”ã€å­¦é™¢ã€ç›´æ’­åˆ†åˆ«ç”±å››ä¸ªäººç»´æŠ¤ï¼Œé‚£ä¹ˆä»–ä»¬è™½ç„¶å¤§éƒ¨åˆ†ä»£ç æ˜¯ç›¸äº’éš”ç¦»çš„ï¼Œä½†ä»ç„¶ä¼šæœ‰ç›¸å½“\bä¸€éƒ¨åˆ†ä»£ç è€¦åˆåœ¨ä¸€èµ·ï¼Œæœ‰æ—¶å€™ä¼šåŒæ—¶ä¿®æ”¹åŒä¸€ä¸ªä»£ç æ–‡ä»¶ã€‚è¿™æ—¶å€™è¦åšçš„è‡ªç„¶å°±æ˜¯æ¨¡å—åŒ–ã€‚ä¸ºä»€ä¹ˆæ˜¯æ¨¡å—åŒ–å‘¢ï¼ŸæŒ‰ç…§æ¨¡å—çš„å®šä¹‰ï¼Œå®ƒæ˜¯ä»¥å…³æ³¨ç‚¹è¿›è¡Œåˆ’åˆ†çš„ï¼Œè€Œå…³æ³¨ç‚¹è¯´åˆ°åº•å°±æ˜¯åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯è¯´æ ¹æ®æˆ‘ä»¬ä¸Šé¢çš„ä¾‹å­ï¼Œèµ„è®¯ã€é—®ç­”ã€å­¦é™¢ã€ç›´æ’­å¯ä»¥åˆ†æˆä¸åŒçš„æ¨¡å—ã€‚æˆ‘ä»¬æœ€å¼€å§‹å®šä¹‰è¿™ä¸ªè™šæ‹Ÿäº§å“çš„æ—¶å€™è¯´ï¼Œå®ƒæœ‰ä¸‰ä¸ªç‰¹ç‚¹â€”â€”é«˜è€¦åˆã€ä½å†…èšã€æ— é‡ç”¨ã€‚è€Œç¬¬ä¸€ç‚¹ç»„ä»¶åŒ–å¼€å‘ä¸»è¦æ˜¯è§£å†³äº†é‡ç”¨é—®é¢˜ï¼Œæå‡äº†éƒ¨åˆ†å†…èšï¼Œè€Œè€¦åˆé—®é¢˜åˆ™æ²¡æœ‰æ¶‰åŠã€‚æ‰€ä»¥è¯´æˆ‘ä»¬ä¸Šé¢å¯ä»¥å°†è¿™ä¸ªäº§å“åœ¨é€»è¾‘ä¸Šåˆ’åˆ†ä¸ºèµ„è®¯ã€é—®ç­”ã€å­¦é™¢ã€ç›´æ’­å››ä¸ªæ¨¡å—ï¼Œä½†åœ¨ä»£ç å±‚é¢ä¸Šå®ƒä»¬å´ä¸æ˜¯å››ä¸ªæ¨¡å—ï¼Œå› ä¸ºå®ƒä»¬çš„ä»£ç éƒ½æ˜¯æ··æ‚åœ¨ä¸€èµ·çš„ã€‚æ¯”å¦‚äº§å“é¦–é¡µï¼Œå¯èƒ½æ¨èäº†éƒ¨åˆ†èµ„è®¯ã€æ˜¾ç¤ºäº†çƒ­é—¨é—®ç­”ã€æ¨é€äº†ç›®å‰çš„ç›´æ’­ï¼Œè€Œè¿™äº›åŠŸèƒ½çš„ä»£ç åˆ™æ˜¯å†™åœ¨ä¸€èµ·çš„ï¼›å†æ¯”å¦‚ç¨‹åºå¯åŠ¨çš„æ—¶å€™ï¼Œè¿™å››ä¸ªæ¨¡å—éƒ½éœ€è¦åˆå§‹åŒ–ä¸€äº›æ•°æ®ï¼Œè€Œåˆå§‹åŒ–æ•°æ®çš„ä»£ç ä¹Ÿæ˜¯å†™åœ¨ä¸€èµ·çš„ã€‚è€Œæ¨¡å—åŒ–å¼€å‘å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼Œå³æé«˜å†…èšï¼Œå°†åˆ†å±åŒä¸€æ¨¡å—ä»£ç æ”¾åˆ°ä¸€èµ·ï¼›é™ä½è€¦åˆï¼Œå°†ä¸åŒæ¨¡å—é—´çš„è€¦åˆç¨‹åº¦å¼±åŒ–ã€‚é«˜å†…èšæ˜¯è¿™ä¸€æ­¥çš„ç›®æ ‡ã€‚ä½†ç°çŠ¶æ˜¯æœ‰è®¸å¤šåœ°æ–¹ä¼šç”¨åˆ°å¤šä¸ªæ¨¡å—ï¼Œæ¯”å¦‚å¯åŠ¨çš„æ—¶å€™ä¼šè°ƒç”¨å››ä¸ªæ¨¡å—ï¼Œé¦–é¡µä¼šå±•ç¤ºä¸‰ä¸ªæ¨¡å—çš„ç•Œé¢ã€‚å¦‚æœè¦é«˜å†…èšï¼Œé‚£ä¹ˆå¿…ç„¶éœ€è¦è¿™äº›æ¨¡å—ä¸ºä¸åŒçš„åœºæ™¯æä¾›ç›¸åŒçš„æ–¹æ³•ï¼Œè¿™å°±æ˜¯è¯´æ‰€æœ‰æ¨¡å—è¦å®ç°åŒä¸€å¥—å¤šä¸ªæ¥å£ã€‚è€Œä½è€¦åˆå…¶å®å¹¶éæ˜¯æ¨¡å—åŒ–å¼€å‘çš„è¦æ±‚ï¼Œå…¶å®æ›´å¤šæ—¶å€™æ˜¯åŸºäºäº§å“ä¸Šçš„åŠ¨æ€åŒ–è¦æ±‚ï¼Œæ‰€ä»¥æœ€å¸¸è§çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯è·¯ç”±æœºåˆ¶ã€‚è®²åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ¨¡å—åŒ–å’Œç»„ä»¶åŒ–çš„åŒºåˆ«å°±å·²ç»å¾ˆæ˜æ˜¾äº†ã€‚å¯¹äºä¸€èˆ¬åº”ç”¨è€Œè¨€ï¼Œä»£ç è®¾è®¡ä¼˜åŒ–åˆ°è¿™ä¸€æ­¥å°±å¾ˆå¥½äº†ï¼Œæ— è®ºæ˜¯ä»£ç å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§ã€å·¥ä½œåä½œæ•ˆç‡éƒ½å¾—åˆ°äº†ä¿éšœã€‚ä¸è¿‡ä¸ºäº†è®²åˆ°æˆ‘ä»¬ä¸Šé¢\bæ‰€è¯´çš„æ‰€æœ‰æ¦‚å¿µï¼Œæˆ‘ä»¬ä¸å¦¨çš®ä¸€ä¸‹ï¼Œç»™è‡ªå·±æç‚¹éœ€æ±‚ï¼šäº§å“ç»ç†æƒ³æŠŠå­¦é™¢æ¨¡å—å•ç‹¬æå‡ºæ¥åšä¸€ä¸ªAPPï¼Œä½†æ˜¯å› ä¸ºæŠ€æœ¯ç»ç†åæ˜ \bå¼€å‘èµ„æºæœ‰é™ï¼Œä¸èƒ½ç»™è¿™ä¸ªAPPé…å¤‡ç‹¬ç«‹çš„å¼€å‘äººå‘˜ï¼Œæ‰€ä»¥æœ€ç»ˆçš„ç»“æœæ˜¯è¿™ä¸ªAPPçš„åŠŸèƒ½å’ŒåŸåº”ç”¨ä¸­çš„å­¦é™¢æ¨¡å—ä½¿ç”¨åŒä¸€å¥—ä»£ç ï¼Œä¸”åŠŸèƒ½ç›¸åŒã€‚ 2.5å­åº”ç”¨å¯¹äºå¼€å‘äººå‘˜æ¥è¯´ï¼Œè¿™ä¹Ÿä¸èƒ½ç®—å¤šå›°éš¾çš„éœ€æ±‚ï¼Œåªéœ€è¦å†åˆ›å»ºä¸€ä¸ªæ–°å·¥ç¨‹ï¼Œå°†å­¦é™¢æ¨¡å—ä»£ç å¼•ç”¨è¿‡æ¥å¹¶æ˜¾ç¤ºå³å¯ã€‚è¿™ä¸ªæ–¹æ¡ˆç®€å•ç›´æ¥ï¼Œå³ä¾¿åé¢å†æŠŠç›´æ’­åˆ†ç¦»å‡ºå•ç‹¬APPæˆ‘ä¹Ÿå¯ä»¥è¿™æ ·æ¥åšã€‚ä½†æ˜¯ï¼Œæœ‰æ²¡æœ‰\bè§‰å¾—è¿™ä¸ªæ–¹æ¡ˆå’Œæˆ‘ä»¬ä¹‹å‰æåˆ°çš„Alertçš„ä¾‹å­æœ‰äº›ç¥ä¼¼ï¼Œåœ¨è¿™ä¸ªæ–¹æ¡ˆä¸­ï¼Œæ–°çš„å·¥ç¨‹å¿…ç„¶ç›´æ¥è€¦åˆå…·ä½“çš„æ¨¡å—ä»£ç ï¼Œä½ éœ€è¦åœ¨é‡Œé¢ç¼–å†™å¾ˆå¤šåˆå§‹åŒ–ä»£ç ã€‚è€Œè¿™æ ·çš„ä»£ç åœ¨å•ç‹¬çš„APPä¸­å’ŒåŸAPPä¸­æ˜¯ç›¸å½“ç±»ä¼¼çš„ã€‚æŒ‰ç…§ã€Šé‡æ„ã€‹ä¸€ä¹¦ä¸­çš„ææ³•ï¼Œè¿™æ˜¯æ˜æ˜¾çš„åå‘³é“ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨å·¥ç¨‹å’Œæ¨¡å—ä»£ç ä¹‹é—´æŠ½è±¡å‡ºä¸€å±‚æ¥å£ï¼Œä½¿ä¸¤è€…è§£é™¤ç›´æ¥è€¦åˆï¼Œè¿™æ ·æˆ‘ä»¬ç”šè‡³å¯ä»¥åšåˆ°åªéœ€è¦é…ç½®å°±å¯ä»¥å°†ä¸€ä¸ªæ¨¡å—å˜æˆä¸€ä¸ªæ–°çš„APPã€‚(æˆ–è®¸åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæœ‰äº›è¿‡åº¦è®¾è®¡äº†ï¼Œä½†æ˜¯åŸè°…æˆ‘ä¸¾ä¸å‡ºæ›´åˆæƒ…ç†çš„ä¾‹å­TAT)ä¸Šé¢æ–¹æ¡ˆçš„æˆæœï¼Œå®é™…ä¸Šå°±æŠŠå­¦é™¢æ¨¡å—ç¼–ç¨‹äº†å­¦é™¢å­åº”ç”¨ï¼Œè€Œè¿™ä¸ªå­åº”ç”¨è¢«åŸAPPå’Œæ–°çš„ç‹¬ç«‹APPæ‰€ä½¿ç”¨ã€‚åœ¨æ¦‚å¿µä¸Šï¼Œå­åº”ç”¨æ¯”æ¨¡å—çš„èŒƒå›´æ›´å¤§ï¼Œå­åº”ç”¨è¦æ±‚èƒ½åœ¨ä¸»åº”ç”¨é‡Œè¿è¡Œï¼Œä¹Ÿè¦æ±‚å¿…è¦æ—¶å¯ä»¥è‡ªå·±è¿è¡Œï¼Œé‚£ä¹ˆå°±å¿…ç„¶è¦æ±‚å­åº”ç”¨è¦æä¾›ç”Ÿå‘½å‘¨æœŸæ¥å£ï¼Œå’Œä¸»åº”ç”¨å¿…è¦æ—¶ä¿æŒä¸€è‡´ã€‚å…¶å®åœ¨\bä¸Šé¢ä¸€æ­¥çš„æ¨¡å—åŒ–å¼€å‘ä¸­ï¼Œæœ‰çš„æ—¶å€™ä¹Ÿä¼šæœ‰ç”Ÿå‘½å‘¨æœŸæ¥å£çš„è¦æ±‚ï¼Œåªä¸è¿‡å¹¶éå¼ºåˆ¶ï¼Œè€Œå­åº”ç”¨çš„è®¾è®¡ä¸­åˆ™æ˜¯å¿…é¡»è¦è€ƒè™‘çš„ã€‚ 3.æ€»ç»“åˆ°æ­¤ï¼Œæˆ‘ä»¬å°±æŠŠç»„ä»¶ã€æ’ä»¶ã€æ¨¡å—ã€å­åº”ç”¨å››ä¸ªä¸åŒç¨‹åº¦çš„è®¾è®¡æ¦‚å¿µ\bå¼‚åŒè®²å®Œäº†ï¼Œå¸Œæœ›è¯»è€…èƒ½æœ‰æ‰€å¾—ã€‚æ–‡ç« ä¸­è‹¥æœ‰å…¶ä»–ä¸è¶³ä¹‹å¤„ï¼Œæ³è¯·ä¸åèµæ•™ã€‚","categories":[{"name":"æ¶æ„çŸ¥è¯†","slug":"æ¶æ„çŸ¥è¯†","permalink":"http://yoursite.com/categories/%E6%9E%B6%E6%9E%84%E7%9F%A5%E8%AF%86/"}],"tags":[{"name":"æ¶æ„æ¦‚å¿µ","slug":"æ¶æ„æ¦‚å¿µ","permalink":"http://yoursite.com/tags/%E6%9E%B6%E6%9E%84%E6%A6%82%E5%BF%B5/"}]},{"title":"éšæ‰‹è®°å½•ğŸ“","slug":"æ—¥å¸¸ç¬”è®°ğŸ“’","date":"2020-03-19T07:40:37.000Z","updated":"2020-11-26T07:57:21.031Z","comments":true,"path":"2020/2020-03-19-15:40:37/","link":"","permalink":"http://yoursite.com/2020/2020-03-19-15:40:37/","excerpt":"UMLç±»å›¾","text":"UMLç±»å›¾ â€”â€”â€”â€”â€”â–· ç»§æ‰¿â€”â€”â€”â€“â–·å®ç°æ¥å£ â€”â€”â€”â€”â€”&gt; å…³è”â€”â€”â€”â€“&gt; ä¾èµ– â—†â€”â€”â€”â€”&gt; ç»„åˆâ—‡â€”â€”â€”â€”&gt; èšåˆ â—¦ æ¥å£ ä¸€äº›ä¼ é€é—¨è®¾è®¡æ¨¡å¼ [iTerm2] (https://www.cnblogs.com/xishuai/p/mac-iterm2.html) å¥½è®°æ€§ä¸å¦‚çƒ‚ç¬”å¤´/ç”¨æˆ·/Xuebiao/Library/Developer/Xcode/usr/local/bin ../ ä¸Šå±‚ç›®å½•./ å½“å‰ç›®å½•cal æ—¥å†æ—¶é—´bc è®¡ç®—å™¨ quité€€å‡ºcd - ä¸Šæ¬¡æŸ¥çœ‹çš„ç›®å½•cd .. è¿”å›ä¸Šå±‚ç›®å½•cd æ ¹ç›®å½• å¿«æ·é”®ï¼šæ˜¾ç¤ºéšè—æ–‡ä»¶ï¼šcommand + shift + . chmod 755 kspod æƒé™ ./kspod KSMallCartModule 1.0.0.0 â€˜first commitâ€™ pod â€˜KSMallOrderModuleâ€™, :path =&gt; â€˜../KSPrivatePods/KSMallOrderModule/â€˜ #è®¢å•æ¨¡å— swift-alogrithm-clubä¸Šçš„æ•°æ®ç»“æ„ å¢åŠ æœ€ä½é€Ÿåº¦æ—¶é—´git config â€“global http.lowSpeedLimit 0git config â€“global http.lowSpeedTime 999999 git config â€“global url.â€https://gitclone.com/github.com/&quot;.insteadOf https://github.com/ VALID_ARCHS x86_64 Mach-O æ˜¯Mach objectçš„ç¼©å†™ï¼Œæ˜¯Mac\\iOSä¸Šç”¨äºå­˜å‚¨ç¨‹åºã€åº“çš„æ ‡å‡†æ–‡ä»¶æ ¼å¼ã€‚Mach-Oä»‹ç»dyld åŠ¨æ€é“¾æ¥å™¨ /usr/lib/dylddSYM ç¬¦å·æ–‡ä»¶ Hexoåšå®¢åœ°å€ å‚è€ƒé“¾æ¥https://www.jianshu.com/p/860d3e0fff58https://segmentfault.com/a/1190000017986794 hexo n â€œæˆ‘çš„åšå®¢â€ == hexo new â€œæˆ‘çš„åšå®¢â€ //æ–°å»ºæ–‡ç« hexo g == hexo generate //ç”Ÿæˆhexo s == hexo server //å¯åŠ¨æœåŠ¡é¢„è§ˆhexo d == hexo deploy //éƒ¨ç½² hexo server //Hexoä¼šç›‘è§†æ–‡ä»¶å˜åŠ¨å¹¶è‡ªåŠ¨æ›´æ–°ï¼Œæ— é¡»é‡å¯æœåŠ¡å™¨hexo server -s //é™æ€æ¨¡å¼hexo server -p 5000 //æ›´æ”¹ç«¯å£hexo server -i 192.168.1.1 //è‡ªå®šä¹‰ IPhexo clean //æ¸…é™¤ç¼“å­˜ï¼Œè‹¥æ˜¯ç½‘é¡µæ­£å¸¸æƒ…å†µä¸‹å¯ä»¥å¿½ç•¥è¿™æ¡å‘½ä»¤ éƒ¨ç½²å‰æœ€å¥½èƒ½å…ˆæ‰§è¡Œä¸€ä¸‹ hexo clean å‘½ä»¤ï¼Œæ¸…é™¤ç¼“å­˜æ–‡ä»¶ (db.json) å’Œå·²ç”Ÿæˆçš„é™æ€æ–‡ä»¶ (public)ã€‚åœ¨æŸäº›æƒ…å†µï¼ˆå°¤å…¶æ˜¯æ›´æ¢ä¸»é¢˜åï¼‰ï¼Œå¦‚æœå‘ç°æ‚¨å¯¹ç«™ç‚¹çš„æ›´æ”¹æ— è®ºå¦‚ä½•ä¹Ÿä¸ç”Ÿæ•ˆï¼Œæ‚¨å¯èƒ½éœ€è¦è¿è¡Œè¯¥å‘½ä»¤ã€‚hexo clean éƒ¨ç½²ä¸Šä¼ hexo g -d Podpod install â€“repo-update æ›´æ–°æ…¢çš„é—®é¢˜ï¼šæ— è®ºæ˜¯æ‰§è¡Œpod installè¿˜æ˜¯pod updateéƒ½å¡åœ¨äº†Analyzing dependenciesä¸åŠ¨: pod install â€“verbose â€“no-repo-update pod update â€“verbose â€“no-repo-update gem which cocoapodswhere is kspod æŸ¥æ‰¾ä¸€ä¸ªæ–‡ä»¶æˆ–ç›®å½•find / -name validator.rb podæ£€æŸ¥å½“å‰å®‰è£…ç‰ˆæœ¬åˆ—è¡¨gem list â€“local | grep cocoapodså¸è½½ä¸ç”¨çš„ç‰ˆæœ¬sudo gem uninstall cocoapods 1.5.3å®‰è£…æŒ‡å®šç‰ˆæœ¬sudo gem install cocoapods -v 1.6.1å®‰è£…æœ€æ–°ç‰ˆæœ¬sudo gem install cocoapods ä¸Šä¼ podåº“åˆ°cocoapodså®˜æ–¹specä»“åº“git tag -123456789 0.1.0 -m â€œxxxxxxxxxxxxâ€pod trunk register yourEmail yourName â€“verbosepod trunk push xxxxxxxxx.podspec â€“allow-warnings Podç§æœ‰åº“åˆ¶ä½œæ•™ç¨‹http://blog.wtlucky.com/blog/2015/02/26/create-private-podspec/ ####gemsç›®å½•cd /Library/Ruby/Gems/2.3.0/gems/cocoapods-1.8.4 ç§æœ‰åº“i386ä¸Šä¼ é—®é¢˜ï¼Œä¿®æ”¹validator.rbæ–‡ä»¶ 1def xcodebuild(action, scheme, configuration)2 require &#39;fourflusher&#39;3 command &#x3D; %W(clean #&#123;action&#125; -workspace #&#123;File.join(validation_dir, &#39;App.xcworkspace&#39;)&#125; -scheme #&#123;scheme&#125; -configuration #&#123;configuration&#125;)4 case consumer.platform_name5 when :osx, :macos6 command +&#x3D; %w(CODE_SIGN_IDENTITY&#x3D;)7 when :ios8# command +&#x3D; %w(CODE_SIGN_IDENTITY&#x3D;- -sdk iphonesimulator)9# command +&#x3D; Fourflusher::SimControl.new.destination(:oldest, &#39;iOS&#39;, deployment_target)10# xcconfig &#x3D; consumer.pod_target_xcconfig11# if xcconfig12# archs &#x3D; xcconfig[&#39;VALID_ARCHS&#39;]13# if archs &amp;&amp; (archs.include? &#39;armv7&#39;) &amp;&amp; !(archs.include? &#39;i386&#39;) &amp;&amp; (archs.include? &#39;x86_64&#39;)14# # Prevent Xcodebuild from testing the non-existent i386 simulator if armv7 is specified without i38615# command +&#x3D; %w(ARCHS&#x3D;x86_64)16# end17# end18 command +&#x3D; %w(--help)19 when :watchos å›¾ç‰‡èµ„æºhttps://www.pexels.com/search/cat/ 1.48Kå¼ https://unsplash.com/search/photos/cat 3.9Kå¼ https://pixabay.com/zh/images/search/cat/ objcæºç ï¼šhttps://opensource.apple.com/tarballs/objc4/https://objccn.io Flutterï¼šhttps://flutterawesome.comhttps://flutter-io.cn/ åŒæ­¥å®˜ç½‘æ–‡æ¡£https://book.flutterchina.club flutterå¼€å‘å®æˆ˜https://startflutter.com Swiftï¼šhttps://docs.swift.org/swift-book/LanguageGuide/TheBasics.htmlhttps://swiftgg.gitbook.io/swift/ RXSwift:https://beeth0ven.github.io/RxSwift-Chinese-Documentation/https://mcxiaoke.gitbooks.io/rxdocs/content/ æƒ³çœ‹çš„ä¹¦ğŸ“šã€Šç»“æ„åŒ–æ€ç»´ã€‹ã€Šæ—¶é—´ä¸ä»»åŠ¡ç®¡ç†ã€‹ã€Šæœ‰æ•ˆæ²Ÿé€šå…­è¦ç´ ã€‹ã€Šå¯å¤åˆ¶çš„é¢†å¯¼åŠ›ã€‹","categories":[],"tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yoursite.com/tags/%E9%9A%8F%E7%AC%94/"}]},{"title":"ç»Ÿä¸€å»ºæ¨¡è¯­è¨€(UML)ç®€ä»‹","slug":"ç»Ÿä¸€å»ºæ¨¡è¯­è¨€-UML-ç®€ä»‹","date":"2019-12-06T13:02:23.000Z","updated":"2020-10-23T09:35:56.000Z","comments":true,"path":"2019/12-06-23:00:01/","link":"","permalink":"http://yoursite.com/2019/12-06-23:00:01/","excerpt":"ç»Ÿä¸€å»ºæ¨¡è¯­è¨€ç®€ä»‹","text":"ç»Ÿä¸€å»ºæ¨¡è¯­è¨€ç®€ä»‹ ç»Ÿä¸€å»ºæ¨¡è¯­è¨€ï¼ˆUnified Modeling Languageï¼ŒUMLï¼‰æ˜¯ç”¨æ¥è®¾è®¡è½¯ä»¶è“å›¾çš„å¯è§†åŒ–å»ºæ¨¡è¯­è¨€ï¼Œ1997 å¹´è¢«å›½é™…å¯¹è±¡ç®¡ç†ç»„ç»‡ï¼ˆOMGï¼‰é‡‡çº³ä¸ºé¢å‘å¯¹è±¡çš„å»ºæ¨¡è¯­è¨€çš„å›½é™…æ ‡å‡†ã€‚å®ƒçš„ç‰¹ç‚¹æ˜¯ç®€å•ã€ç»Ÿä¸€ã€å›¾å½¢åŒ–ã€èƒ½è¡¨è¾¾è½¯ä»¶è®¾è®¡ä¸­çš„åŠ¨æ€ä¸é™æ€ä¿¡æ¯ã€‚ ç»Ÿä¸€å»ºæ¨¡è¯­è¨€èƒ½ä¸ºè½¯ä»¶å¼€å‘çš„æ‰€æœ‰é˜¶æ®µæä¾›æ¨¡å‹åŒ–å’Œå¯è§†åŒ–æ”¯æŒã€‚è€Œä¸”èå…¥äº†è½¯ä»¶å·¥ç¨‹é¢†åŸŸçš„æ–°æ€æƒ³ã€æ–°æ–¹æ³•å’Œæ–°æŠ€æœ¯ï¼Œä½¿è½¯ä»¶è®¾è®¡äººå‘˜æ²Ÿé€šæ›´ç®€æ˜ï¼Œè¿›ä¸€æ­¥ç¼©çŸ­äº†è®¾è®¡æ—¶é—´ï¼Œå‡å°‘å¼€å‘æˆæœ¬ã€‚å®ƒçš„åº”ç”¨é¢†åŸŸå¾ˆå®½ï¼Œä¸ä»…é€‚åˆäºä¸€èˆ¬ç³»ç»Ÿçš„å¼€å‘ï¼Œè€Œä¸”é€‚åˆäºå¹¶è¡Œä¸åˆ†å¸ƒå¼ç³»ç»Ÿçš„å»ºæ¨¡ã€‚ UML ä»ç›®æ ‡ç³»ç»Ÿçš„ä¸åŒè§’åº¦å‡ºå‘ï¼Œå®šä¹‰äº†ç”¨ä¾‹å›¾ã€ç±»å›¾ã€å¯¹è±¡å›¾ã€çŠ¶æ€å›¾ã€æ´»åŠ¨å›¾ã€æ—¶åºå›¾ã€åä½œå›¾ã€æ„ä»¶å›¾ã€éƒ¨ç½²å›¾ç­‰ 9 ç§å›¾ã€‚ è¿™é‡Œä¸»è¦ä»‹ç»è½¯ä»¶è®¾è®¡æ¨¡å¼ä¸­ç»å¸¸ç”¨åˆ°çš„ç±»å›¾ï¼Œä»¥åŠç±»ä¹‹é—´çš„å…³ç³»ã€‚ ç±»ã€æ¥å£1. ç±»ç±»ï¼ˆClassï¼‰æ˜¯æŒ‡å…·æœ‰ç›¸åŒå±æ€§ã€æ–¹æ³•å’Œå…³ç³»çš„å¯¹è±¡çš„æŠ½è±¡ï¼Œå®ƒå°è£…äº†æ•°æ®å’Œè¡Œä¸ºï¼Œæ˜¯é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ï¼ˆOOPï¼‰çš„åŸºç¡€ï¼Œå…·æœ‰å°è£…æ€§ã€ç»§æ‰¿æ€§å’Œå¤šæ€æ€§ç­‰ä¸‰å¤§ç‰¹æ€§ã€‚åœ¨ UML ä¸­ï¼Œç±»ä½¿ç”¨åŒ…å«ç±»åã€å±æ€§å’Œæ“ä½œä¸”å¸¦æœ‰åˆ†éš”çº¿çš„çŸ©å½¢æ¥è¡¨ç¤ºã€‚(1) ç±»åï¼ˆNameï¼‰æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ï¼ŒStudentã€‚(2) å±æ€§ï¼ˆAttributeï¼‰æ˜¯æŒ‡ç±»çš„ç‰¹æ€§ï¼Œå³ç±»çš„æˆå‘˜å˜é‡ã€‚UML æŒ‰ä»¥ä¸‹æ ¼å¼è¡¨ç¤ºï¼š 1[å¯è§æ€§]å±æ€§å:ç±»å‹[&#x3D;é»˜è®¤å€¼] 2ä¾‹å¦‚ï¼š-name:String Tipsï¼šâ€œå¯è§æ€§â€è¡¨ç¤ºè¯¥å±æ€§å¯¹ç±»å¤–çš„å…ƒç´ æ˜¯å¦å¯è§ï¼ŒåŒ…æ‹¬å…¬æœ‰ï¼ˆPublicï¼‰ã€ç§æœ‰ï¼ˆPrivateï¼‰ã€å—ä¿æŠ¤ï¼ˆProtectedï¼‰å’Œæœ‹å‹ï¼ˆFriendlyï¼‰4 ç§ï¼Œåœ¨ç±»å›¾ä¸­åˆ†åˆ«ç”¨ç¬¦å·+ã€-ã€#ã€~è¡¨ç¤ºã€‚çœç•¥è¿™äº›ä¿®é¥°ç¬¦è¡¨ç¤ºå…·æœ‰packageï¼ˆåŒ…ï¼‰çº§åˆ«çš„å¯è§æ€§ã€‚ (3) æ“ä½œï¼ˆOperationsï¼‰æ˜¯ç±»çš„ä»»æ„ä¸€ä¸ªå®ä¾‹å¯¹è±¡éƒ½å¯ä»¥ä½¿ç”¨çš„è¡Œä¸ºï¼Œæ˜¯ç±»çš„æˆå‘˜æ–¹æ³•ã€‚UML æŒ‰ä»¥ä¸‹æ ¼å¼è¡¨ç¤ºï¼š 1[å¯è§æ€§]åç§°(å‚æ•°åˆ—è¡¨)[:è¿”å›ç±»å‹] 2ä¾‹å¦‚ï¼š+display():voidã€‚ å›¾ 1 æ‰€ç¤ºæ˜¯å­¦ç”Ÿç±»çš„ UML è¡¨ç¤ºã€‚ 2.æŠ½è±¡ç±»åœ¨ç±»å›¾ä¸­ä»¥æ–œä½“è¡¨ç¤ºä¸€ä¸ªæŠ½è±¡ç±»æˆ–è€…æŠ½è±¡æ“ä½œï¼ŒæŠ½è±¡ç±»æ˜¯ä¸èƒ½å®ä¾‹åŒ–çš„ï¼Œä¸€èˆ¬è‡³å°‘åŒ…å«ä¸€ä¸ªæŠ½è±¡æ“ä½œã€‚ 3.æ¥å£æ¥å£ï¼ˆInterfaceï¼‰æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç±»ï¼Œå®ƒå…·æœ‰ç±»çš„ç»“æ„ä½†ä¸å¯è¢«å®ä¾‹åŒ–ï¼Œåªå¯ä»¥è¢«å­ç±»å®ç°ã€‚å®ƒåŒ…å«æŠ½è±¡æ“ä½œï¼Œä½†ä¸åŒ…å«å±æ€§ã€‚å®ƒæè¿°äº†ç±»æˆ–ç»„ä»¶å¯¹å¤–å¯è§çš„åŠ¨ä½œã€‚åœ¨ UML ä¸­ï¼Œæ¥å£ä½¿ç”¨ä¸€ä¸ªå¸¦æœ‰åç§°çš„å°åœ†åœˆæ¥è¿›è¡Œè¡¨ç¤ºã€‚ å›¾ 2 æ‰€ç¤ºæ˜¯å›¾å½¢ç±»æ¥å£çš„è¡¨ç¤ºã€‚ ç±»ä¹‹é—´çš„å…³ç³»åœ¨è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œç±»ä¸æ˜¯å­¤ç«‹å­˜åœ¨çš„ï¼Œç±»ä¸ç±»ä¹‹é—´å­˜åœ¨å„ç§å…³ç³»ã€‚æ ¹æ®ç±»ä¸ç±»ä¹‹é—´çš„è€¦åˆåº¦ä»å¼±åˆ°å¼ºæ’åˆ—ï¼ŒUML ä¸­çš„ç±»å›¾æœ‰ä»¥ä¸‹å‡ ç§å…³ç³»ï¼šä¾èµ–å…³ç³»ã€å…³è”å…³ç³»ã€èšåˆå…³ç³»ã€ç»„åˆå…³ç³»ã€æ³›åŒ–å…³ç³»å’Œå®ç°å…³ç³»ã€‚å…¶ä¸­æ³›åŒ–å’Œå®ç°çš„è€¦åˆåº¦ç›¸ç­‰ï¼Œå®ƒä»¬æ˜¯æœ€å¼ºçš„ã€‚ 1. ä¾èµ–å…³ç³»ä¾èµ–ï¼ˆDependencyï¼‰å…³ç³»æ˜¯ä¸€ç§ä½¿ç”¨å…³ç³»ï¼Œå®ƒæ˜¯å¯¹è±¡ä¹‹é—´è€¦åˆåº¦æœ€å¼±çš„ä¸€ç§å…³è”æ–¹å¼ï¼Œæ˜¯ä¸´æ—¶æ€§çš„å…³è”ã€‚åœ¨ä»£ç ä¸­ï¼ŒæŸä¸ªç±»çš„æ–¹æ³•é€šè¿‡å±€éƒ¨å˜é‡ã€æ–¹æ³•çš„å‚æ•°æˆ–è€…å¯¹é™æ€æ–¹æ³•çš„è°ƒç”¨æ¥è®¿é—®å¦ä¸€ä¸ªç±»ï¼ˆè¢«ä¾èµ–ç±»ï¼‰ä¸­çš„æŸäº›æ–¹æ³•æ¥å®Œæˆä¸€äº›èŒè´£ã€‚ åœ¨ UML ç±»å›¾ä¸­ï¼Œä¾èµ–å…³ç³»ä½¿ç”¨å¸¦ç®­å¤´çš„è™šçº¿æ¥è¡¨ç¤ºï¼Œç®­å¤´ä»ä½¿ç”¨ç±»æŒ‡å‘è¢«ä¾èµ–çš„ç±»ã€‚ å›¾ 4 æ‰€ç¤ºæ˜¯äººä¸æ‰‹æœºçš„å…³ç³»å›¾ï¼Œäººé€šè¿‡æ‰‹æœºçš„è¯­éŸ³ä¼ é€æ–¹æ³•æ‰“ç”µè¯ã€‚ 2. å…³è”å…³ç³»å…³è”ï¼ˆAssociationï¼‰å…³ç³»æ˜¯å¯¹è±¡ä¹‹é—´çš„ä¸€ç§å¼•ç”¨å…³ç³»ï¼Œç”¨äºè¡¨ç¤ºä¸€ç±»å¯¹è±¡ä¸å¦ä¸€ç±»å¯¹è±¡ä¹‹é—´çš„è”ç³»ï¼Œå¦‚è€å¸ˆå’Œå­¦ç”Ÿã€å¸ˆå‚…å’Œå¾’å¼Ÿã€ä¸ˆå¤«å’Œå¦»å­ç­‰ã€‚å…³è”å…³ç³»æ˜¯ç±»ä¸ç±»ä¹‹é—´æœ€å¸¸ç”¨çš„ä¸€ç§å…³ç³»ï¼Œåˆ†ä¸ºä¸€èˆ¬å…³è”å…³ç³»ã€èšåˆå…³ç³»å’Œç»„åˆå…³ç³»ã€‚ å…³è”å¯ä»¥æ˜¯åŒå‘çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å•å‘çš„ã€‚åœ¨ UML ç±»å›¾ä¸­ï¼ŒåŒå‘çš„å…³è”å¯ä»¥ç”¨å¸¦ä¸¤ä¸ªç®­å¤´æˆ–è€…æ²¡æœ‰ç®­å¤´çš„å®çº¿æ¥è¡¨ç¤ºï¼Œå•å‘çš„å…³è”ç”¨å¸¦ä¸€ä¸ªç®­å¤´çš„å®çº¿æ¥è¡¨ç¤ºï¼Œç®­å¤´ä»ä½¿ç”¨ç±»æŒ‡å‘è¢«å…³è”çš„ç±»ã€‚ä¹Ÿå¯ä»¥åœ¨å…³è”çº¿çš„ä¸¤ç«¯æ ‡æ³¨è§’è‰²åï¼Œä»£è¡¨ä¸¤ç§ä¸åŒçš„è§’è‰²ã€‚ åœ¨ä»£ç ä¸­é€šå¸¸å°†ä¸€ä¸ªç±»çš„å¯¹è±¡ä½œä¸ºå¦ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡æ¥å®ç°å…³è”å…³ç³»ã€‚ å›¾ 5 æ‰€ç¤ºæ˜¯è€å¸ˆå’Œå­¦ç”Ÿçš„å…³ç³»å›¾ï¼Œæ¯ä¸ªè€å¸ˆå¯ä»¥æ•™å¤šä¸ªå­¦ç”Ÿï¼Œæ¯ä¸ªå­¦ç”Ÿä¹Ÿå¯å‘å¤šä¸ªè€å¸ˆå­¦ï¼Œä»–ä»¬æ˜¯åŒå‘å…³è”ã€‚ 3. èšåˆå…³ç³»èšåˆï¼ˆAggregationï¼‰å…³ç³»æ˜¯å…³è”å…³ç³»çš„ä¸€ç§ï¼Œæ˜¯å¼ºå…³è”å…³ç³»ï¼Œæ˜¯æ•´ä½“å’Œéƒ¨åˆ†ä¹‹é—´çš„å…³ç³»ï¼Œæ˜¯ has-a çš„å…³ç³»ã€‚ èšåˆå…³ç³»ä¹Ÿæ˜¯é€šè¿‡æˆå‘˜å¯¹è±¡æ¥å®ç°çš„ï¼Œå…¶ä¸­æˆå‘˜å¯¹è±¡æ˜¯æ•´ä½“å¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯æˆå‘˜å¯¹è±¡å¯ä»¥è„±ç¦»æ•´ä½“å¯¹è±¡è€Œç‹¬ç«‹å­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œå­¦æ ¡ä¸è€å¸ˆçš„å…³ç³»ï¼Œå­¦æ ¡åŒ…å«è€å¸ˆï¼Œä½†å¦‚æœå­¦æ ¡åœåŠäº†ï¼Œè€å¸ˆä¾ç„¶å­˜åœ¨ã€‚ åœ¨ UML ç±»å›¾ä¸­ï¼Œèšåˆå…³ç³»å¯ä»¥ç”¨å¸¦ç©ºå¿ƒè±å½¢çš„å®çº¿æ¥è¡¨ç¤ºï¼Œè±å½¢æŒ‡å‘æ•´ä½“ã€‚ å›¾ 6 æ‰€ç¤ºæ˜¯å¤§å­¦å’Œæ•™å¸ˆçš„å…³ç³»å›¾ã€‚ 4. ç»„åˆå…³ç³»ç»„åˆï¼ˆCompositionï¼‰å…³ç³»ä¹Ÿæ˜¯å…³è”å…³ç³»çš„ä¸€ç§ï¼Œä¹Ÿè¡¨ç¤ºç±»ä¹‹é—´çš„æ•´ä½“ä¸éƒ¨åˆ†çš„å…³ç³»ï¼Œä½†å®ƒæ˜¯ä¸€ç§æ›´å¼ºçƒˆçš„èšåˆå…³ç³»ï¼Œæ˜¯ cxmtains-a å…³ç³»ã€‚ åœ¨ç»„åˆå…³ç³»ä¸­ï¼Œæ•´ä½“å¯¹è±¡å¯ä»¥æ§åˆ¶éƒ¨åˆ†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œä¸€æ—¦æ•´ä½“å¯¹è±¡ä¸å­˜åœ¨ï¼Œéƒ¨åˆ†å¯¹è±¡ä¹Ÿå°†ä¸å­˜åœ¨ï¼Œéƒ¨åˆ†å¯¹è±¡ä¸èƒ½è„±ç¦»æ•´ä½“å¯¹è±¡è€Œå­˜åœ¨ã€‚ä¾‹å¦‚ï¼Œå¤´å’Œå˜´çš„å…³ç³»ï¼Œæ²¡æœ‰äº†å¤´ï¼Œå˜´ä¹Ÿå°±ä¸å­˜åœ¨äº†ã€‚ åœ¨ UML ç±»å›¾ä¸­ï¼Œç»„åˆå…³ç³»ç”¨å¸¦å®å¿ƒè±å½¢çš„å®çº¿æ¥è¡¨ç¤ºï¼Œè±å½¢æŒ‡å‘æ•´ä½“ã€‚ å›¾ 7 æ‰€ç¤ºæ˜¯å¤´å’Œå˜´çš„å…³ç³»å›¾ã€‚ 5. æ³›åŒ–ï¼ˆç»§æ‰¿ï¼‰å…³ç³»æ³›åŒ–ï¼ˆGeneralizationï¼‰å…³ç³»æ˜¯å¯¹è±¡ä¹‹é—´è€¦åˆåº¦æœ€å¤§çš„ä¸€ç§å…³ç³»ï¼Œè¡¨ç¤ºä¸€èˆ¬ä¸ç‰¹æ®Šçš„å…³ç³»ï¼Œæ˜¯çˆ¶ç±»ä¸å­ç±»ä¹‹é—´çš„å…³ç³»ï¼Œæ˜¯ä¸€ç§ç»§æ‰¿å…³ç³»ï¼Œæ˜¯ is-a çš„å…³ç³»ã€‚ åœ¨ UML ç±»å›¾ä¸­ï¼Œæ³›åŒ–å…³ç³»ç”¨å¸¦ç©ºå¿ƒä¸‰è§’ç®­å¤´çš„å®çº¿æ¥è¡¨ç¤ºï¼Œç®­å¤´ä»å­ç±»æŒ‡å‘çˆ¶ç±»ã€‚åœ¨ä»£ç å®ç°æ—¶ï¼Œä½¿ç”¨é¢å‘å¯¹è±¡çš„ç»§æ‰¿æœºåˆ¶æ¥å®ç°æ³›åŒ–å…³ç³»ã€‚ä¾‹å¦‚ï¼ŒStudent ç±»å’Œ Teacher ç±»éƒ½æ˜¯ Person ç±»çš„å­ç±»ï¼Œ å…¶ç±»å›¾å¦‚å›¾ 8 æ‰€ç¤ºï¼š 6. å®ç°å…³ç³»å®ç°ï¼ˆRealizationï¼‰å…³ç³»æ˜¯æ¥å£ä¸å®ç°ç±»ä¹‹é—´çš„å…³ç³»ã€‚åœ¨è¿™ç§å…³ç³»ä¸­ï¼Œç±»å®ç°äº†æ¥å£ï¼Œç±»ä¸­çš„æ“ä½œå®ç°äº†æ¥å£ä¸­æ‰€å£°æ˜çš„æ‰€æœ‰çš„æŠ½è±¡æ“ä½œã€‚ åœ¨ UML ç±»å›¾ä¸­ï¼Œå®ç°å…³ç³»ä½¿ç”¨å¸¦ç©ºå¿ƒä¸‰è§’ç®­å¤´çš„è™šçº¿æ¥è¡¨ç¤ºï¼Œç®­å¤´ä»å®ç°ç±»æŒ‡å‘æ¥å£ã€‚ä¾‹å¦‚ï¼Œæ±½è½¦å’Œèˆ¹å®ç°äº†äº¤é€šå·¥å…·ã€‚å…¶ç±»å›¾å¦‚å›¾ 9 æ‰€ç¤ºï¼š","categories":[{"name":"ç¼–ç¨‹æ€æƒ³","slug":"ç¼–ç¨‹æ€æƒ³","permalink":"http://yoursite.com/categories/%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3/"}],"tags":[{"name":"UML","slug":"UML","permalink":"http://yoursite.com/tags/UML/"}]},{"title":"å…­å¤§è®¾è®¡åŸåˆ™","slug":"å…­å¤§è®¾è®¡åŸåˆ™","date":"2019-12-06T07:11:26.000Z","updated":"2020-03-23T07:42:43.000Z","comments":true,"path":"2019/12-06-15:11:26/","link":"","permalink":"http://yoursite.com/2019/12-06-15:11:26/","excerpt":"1ã€å•ä¸€èŒè´£åŸåˆ™","text":"1ã€å•ä¸€èŒè´£åŸåˆ™ å•ä¸€èŒè´£åŸåˆ™çš„è‹±æ–‡åç§°æ˜¯Single Responsibility Principle ï¼Œç®€ç§°SRPã€‚è¿™ä¸ªè®¾è®¡åŸåˆ™å¤‡å—äº‰è®®ï¼Œåªè¦ä½ æƒ³å’Œåˆ«äººäº‰æ‰§ã€æ€„æ°”æˆ–è€…æ˜¯åµæ¶ï¼Œè¿™ä¸ªåŸåˆ™æ˜¯å±¡è¯•ä¸çˆ½çš„ã€‚ å®šä¹‰ï¼šThere should never be more than one reason for a class to change. åº”è¯¥æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªåŸå› å¼•èµ·ç±»çš„å˜æ›´ã€‚ ç†è§£ï¼šä¸åŒçš„ç±»å…·å¤‡ä¸åŒçš„èŒè´£ï¼Œå„å¸å…¶èŒã€‚åšç³»ç»Ÿè®¾è®¡æ—¶ï¼Œå¦‚æœå‘ç°æœ‰ä¸€ä¸ªç±»æ‹¥æœ‰äº†ä¸¤ç§èŒè´£ï¼Œé‚£ä¹ˆå°±è¦é—®ä¸€ä¸ªé—®é¢˜ï¼šå¯ä»¥å°†è¿™ä¸ªç±»åˆ†æˆä¸¤ä¸ªç±»å—ï¼Ÿå¦‚æœçœŸçš„æœ‰å¿…è¦ï¼Œé‚£å°±åˆ†å¼€ï¼Œåƒä¸‡ä¸è¦è®©ä¸€ä¸ªç±»å¹²çš„äº‹æƒ…å¤ªå¤šã€‚ ä¼˜ç‚¹ï¼šç±»çš„å¤æ‚æ€§é™ä½ï¼Œå®ç°ä»€ä¹ˆèŒè´£éƒ½æœ‰æ¸…æ™°æ˜ç¡®çš„å®šä¹‰ï¼›å¯è¯»æ€§æé«˜ï¼Œå¤æ‚æ€§é™ä½ï¼Œé‚£å½“ç„¶å¯è¯»æ€§æé«˜äº†ï¼›å¯ç»´æŠ¤æ€§æé«˜ï¼Œå¯è¯»æ€§æé«˜ï¼Œé‚£å½“ç„¶æ›´å®¹æ˜“ç»´æŠ¤äº†ï¼›å˜æ›´å¼•èµ·çš„é£é™©é™ä½ï¼Œå˜æ›´æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œå¦‚æœæ¥å£çš„å•ä¸€èŒè´£åšå¾—å¥½ï¼Œä¸€ä¸ªæ¥å£ä¿®æ”¹åªå¯¹ç›¸åº”çš„å®ç°ç±»æœ‰å½±å“ï¼Œå¯¹å…¶ä»–çš„æ¥å£æ— å½±å“ï¼Œè¿™å¯¹ç³»ç»Ÿçš„æ‰©å±•æ€§ã€ç»´æŠ¤æ€§éƒ½æœ‰éå¸¸å¤§çš„å¸®åŠ©ã€‚ æ€»ç»“ï¼šä¸€ä¸ªç±»åªæ‰¿æ‹…ä¸€ä¸ªèŒè´£ã€‚å•ä¸€èŒè´£åŸåˆ™æå‡ºäº†ä¸€ä¸ªç¼–å†™ç¨‹åºçš„æ ‡å‡†ï¼Œç”¨â€èŒè´£â€œæˆ–â€å˜åŒ–åŸå› â€œæ¥è¡¡é‡æ¥å£æˆ–ç±»è®¾è®¡å¾—æ˜¯å¦ä¼˜è‰¯ï¼Œä½†æ˜¯â€èŒè´£â€œå’Œâ€å˜åŒ–åŸå› â€œéƒ½æ˜¯ä¸å¯åº¦é‡çš„ï¼Œå› é¡¹ç›®è€Œå¼‚ï¼Œå› ç¯å¢ƒè€Œå¼‚ã€‚ 2ã€é‡Œæ°æ›¿æ¢åŸåˆ™å®ƒæœ‰ä¸¤ç§å®šä¹‰ï¼šç¬¬ä¸€ç§å®šä¹‰ï¼Œä¹Ÿæ˜¯æœ€æ­£å®—çš„å®šä¹‰ï¼šIf for each object o1 of type S there is an object o2 of type T such that for all programs P defined in terms of T, the behavior of P is unchanged when o1 is substituted for o2 then S is a subtype of T.(å¦‚æœå¯¹æ¯ä¸€ä¸ªç±»å‹ä¸ºSçš„å¯¹è±¡o1ï¼Œéƒ½æœ‰ç±»å‹ä¸ºTçš„å¯¹è±¡o2ï¼Œä½¿å¾—ä»¥Tå®šä¹‰çš„æ‰€æœ‰ç¨‹åºPåœ¨æ‰€æœ‰çš„å¯¹è±¡o1éƒ½ä»£æ¢æˆo2æ—¶ï¼Œç¨‹åºPçš„è¡Œä¸ºæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆç±»å‹Sæ˜¯ç±»å‹Tçš„å­ç±»å‹ã€‚) ç¬¬äºŒç§å®šä¹‰ï¼šFunctions that use pointers or references to base classes must be able to use objects of derived classes without knowing it.(æ‰€æœ‰å¼•ç”¨åŸºç±»çš„åœ°æ–¹å¿…é¡»èƒ½é€æ˜åœ°ä½¿ç”¨å…¶å­ç±»çš„å¯¹è±¡ã€‚) ç¬¬äºŒä¸ªå®šä¹‰æ˜¯æœ€æ¸…æ™°æ˜ç¡®çš„ï¼Œé€šä¿—ç‚¹è®²ï¼Œåªè¦çˆ¶ç±»èƒ½å‡ºç°çš„åœ°æ–¹å­ç±»å°±å¯ä»¥å‡ºç°ï¼Œè€Œä¸”æ›¿æ¢ä¸ºå­ç±»ä¹Ÿä¸ä¼šäº§ç”Ÿä»»ä½•é”™è¯¯æˆ–å¼‚å¸¸ï¼Œä½¿ç”¨è€…å¯èƒ½æ ¹æœ¬å°±ä¸éœ€è¦çŸ¥é“æ˜¯çˆ¶ç±»è¿˜æ˜¯å­ç±»ã€‚ä½†æ˜¯ï¼Œåè¿‡æ¥å°±ä¸è¡Œäº†ï¼Œæœ‰å­ç±»å‡ºç°çš„åœ°æ–¹ï¼Œçˆ¶ç±»æœªå¿…å°±èƒ½é€‚ç”¨ã€‚ ç†è§£ï¼šçˆ¶ç±»å¯è¢«å­ç±»æ›¿æ¢ï¼Œä½†åä¹‹ä¸ä¸€å®šæˆç«‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»£ç ä¸­å¯ä»¥å°†çˆ¶ç±»å…¨éƒ¨æ›¿æ¢ä¸ºå­ç±»ï¼Œç¨‹åºä¸ä¼šå‡ºç°å¼‚å¸¸ï¼Œä½†åè¿‡æ¥å°±ä¸ä¸€å®šäº†ã€‚ æ€»ç»“ï¼šåœ¨ç»§æ‰¿ç±»æ˜¯ï¼ŒåŠ¡å¿…é‡å†™ï¼ˆoverrideï¼‰çˆ¶ç±»ä¸­æ‰€æœ‰çš„æ–¹æ³•ï¼Œå°¤å…¶éœ€è¦æ³¨æ„çˆ¶ç±»çš„protectedæ–¹æ³•ï¼ˆå®ƒä»¬å¾€å¾€æ˜¯è®©ä½ é‡å†™çš„ï¼‰ï¼Œå­ç±»å°½é‡ä¸è¦æš´éœ²è‡ªå·±çš„publicæ–¹æ³•ä¾›å¤–ç•Œè°ƒç”¨ã€‚ 3ã€ä¾èµ–å€’ç½®åŸåˆ™ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDependence Inversion Principle, DIPï¼‰ å®šä¹‰ï¼šHigh level modules should not depends upon low level modules.Both should depend upon abstractions.Abstractions should not depend upon details.Details should depend upon abstractions. ç†è§£ï¼š1.é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½å±‚æ¨¡å—ï¼Œä¸¤è€…éƒ½åº”è¯¥ä¾èµ–å…¶æŠ½è±¡ï¼› 2.æŠ½è±¡ä¸åº”è¯¥ä¾èµ–ç»†èŠ‚ï¼› 3.ç»†èŠ‚åº”è¯¥ä¾èµ–æŠ½è±¡ã€‚ åº”è¯¥é¢å‘æ¥å£ç¼–ç¨‹ï¼Œä¸è¯¥é¢å‘å®ç°ç±»ç¼–ç¨‹ã€‚é¢å‘å®ç°ç±»ç¼–ç¨‹ç›¸å½“äºå°±äº‹è®ºäº‹ï¼Œé‚£æ˜¯æ­£å‘ä¾èµ–ï¼›é¢å‘æ¥å£ç¼–ç¨‹ï¼Œç›¸å½“äºé€è¿‡ç°è±¡çœ‹æœ¬è´¨ï¼ŒæŠ“ä½äº‹åŠ¡çš„å…±æ€§ï¼Œé‚£å°±æ˜¯åå‘ä¾èµ–ï¼Œå³ä¾èµ–å€’ç½®ã€‚ æ€»ç»“ï¼šé¢å‘æ¥å£ç¼–ç¨‹ï¼Œæå–å‡ºäº‹åŠ¡çš„æœ¬è´¨å’Œå…±æ€§ã€‚ 4ã€æ¥å£éš”ç¦»åŸåˆ™ä»€ä¹ˆæ˜¯æ¥å£å‘¢ï¼Ÿå®ƒåˆ†ä¸ºä¸¤ç§ï¼šå®ä¾‹æ¥å£ï¼ˆObject Interfaceï¼‰ï¼Œåœ¨Javaä¸­å£°æ˜ä¸€ä¸ªç±»ï¼Œç„¶åç”¨newå…³é”®å­—äº§ç”Ÿä¸€ä¸ªå®ä¾‹ï¼Œå®ƒæ˜¯å¯¹ä¸€ä¸ªç±»å‹çš„æè¿°ï¼Œè¿™æ˜¯ä¸€ç§æ¥å£ã€‚æ¯”å¦‚ä½ å®šä¹‰Personè¿™ä¸ªç±»ï¼Œç„¶åä½¿ç”¨Person zhangSan =new Person()äº§ç”Ÿäº†ä¸€ä¸ªå®ä¾‹ï¼Œè¿™ä¸ªå®ä¾‹è¦éµä»çš„æ ‡å‡†å°±æ˜¯Personè¿™ä¸ªç±»ï¼ŒPersonç±»å°±æ˜¯zhangSançš„æ¥å£ã€‚Javaä¸­çš„ç±»ä¹Ÿæ˜¯ä¸€ç§æ¥å£ã€‚ ç±»æ¥å£ï¼ˆClass Interfaceï¼‰ï¼ŒJavaä¸­ç»å¸¸ä½¿ç”¨çš„interfaceå…³é”®å­—å®šä¹‰çš„æ¥å£ã€‚ ä»€ä¹ˆæ˜¯éš”ç¦»å‘¢ï¼Ÿå®ƒæœ‰ä¸¤ç§å®šä¹‰ï¼šClients should not be forced to depend upon interfaces that they donâ€™t use.(å®¢æˆ·ç«¯ä¸åº”è¯¥ä¾èµ–å®ƒä¸éœ€è¦çš„æ¥å£ã€‚)The dependency of one class to another one should depend on the smallest possible interface.(ç±»é—´çš„ä¾èµ–å…³ç³»åº”è¯¥å»ºç«‹åœ¨æœ€å°çš„æ¥å£ä¸Šã€‚) ç†è§£ï¼šç¬¬ä¸€ç§å®šä¹‰ï¼šâ€å®¢æˆ·ç«¯ä¸åº”è¯¥ä¾èµ–ä¸éœ€è¦çš„æ¥å£â€œï¼Œé‚£ä¾èµ–ä»€ä¹ˆï¼Ÿä¾èµ–å®ƒéœ€è¦çš„æ¥å£ï¼Œå®¢æˆ·ç«¯éœ€è¦ä»€ä¹ˆæ¥å£å°±æä¾›ä»€ä¹ˆæ¥å£ï¼ŒæŠŠä¸éœ€è¦çš„æ¥å£å‰”é™¤æ‰ï¼Œé‚£å°±éœ€è¦å¯¹æ¥å£è¿›è¡Œç»†åŒ–ï¼Œä¿è¯å…¶çº¯æ´æ€§ï¼›å†çœ‹ç¬¬äºŒç§å®šä¹‰ï¼šâ€ç±»é—´çš„ä¾èµ–å…³ç³»åº”è¯¥å»ºç«‹åœ¨æœ€å°çš„æ¥å£â€œï¼Œå®ƒè¦æ±‚æ˜¯æœ€å°çš„æ¥å£ï¼Œä¹Ÿæ˜¯è¦æ±‚æ¥å£ç»†åŒ–ï¼Œæ¥å£çº¯æ´ï¼Œä¸ç¬¬ä¸€ä¸ªå®šä¹‰å¦‚å‡ºä¸€è¾™ï¼Œåªæ˜¯ä¸€ä¸ªäº‹ç‰©çš„ä¸¤ç§ä¸åŒæè¿°ã€‚æˆ‘ä»¬å¯ä»¥æŠŠä¸¤ä¸ªå®šä¹‰æ¦‚æ‹¬ä¸ºä¸€å¥è¯ï¼šå»ºç«‹å•ä¸€æ¥å£ï¼Œä¸ç”¨å»ºç«‹è‡ƒè‚¿åºå¤§çš„æ¥å£ã€‚å†é€šä¿—ä¸€ç‚¹è®²ï¼šæ¥å£å°½é‡ç»†åŒ–ï¼ŒåŒæ—¶æ¥å£ä¸­çš„æ–¹æ³•å°½é‡å°‘ã€‚ æ€»ç»“ï¼šä¸€ä¸ªæ¥å£åªæœåŠ¡äºä¸€ä¸ªå­æ¨¡å—æˆ–ä¸šåŠ¡é€»è¾‘ï¼›é€šè¿‡ä¸šåŠ¡é€»è¾‘å‹ç¼©æ¥å£ä¸­çš„publicæ–¹æ³•ï¼Œæ¥å£æ—¶å¸¸å»å›é¡¾ï¼Œå°½é‡è®©æ¥å£è¾¾åˆ°â€æ»¡èº«ç­‹éª¨è‚‰â€œï¼Œè€Œä¸æ˜¯â€è‚¥å˜Ÿå˜Ÿâ€œçš„ä¸€å¤§å †æ–¹æ³•ï¼›å·²ç»è¢«æ±¡æŸ“äº†çš„æ¥å£ï¼Œå°½é‡å»ä¿®æ”¹ï¼Œè‹¥å˜æ›´çš„é£é™©è¾ƒå¤§ï¼Œåˆ™é‡‡ç”¨é€‚é…å™¨æ¨¡å¼è¿›è¡Œè½¬åŒ–å¤„ç†ï¼›äº†è§£ç¯å¢ƒï¼Œæ‹’ç»ç›²ä»ã€‚æ¯ä¸ªé¡¹ç›®æˆ–äº§å“éƒ½æœ‰ç‰¹å®šçš„ç¯å¢ƒå› ç´ ï¼Œåˆ«çœ‹åˆ°å¤§å¸ˆæ˜¯è¿™æ ·åšçš„ä½ å°±ç…§æŠ„ã€‚åƒä¸‡åˆ«ï¼Œç¯å¢ƒä¸åŒï¼Œæ¥å£æ‹†åˆ†çš„æ ‡å‡†å°±ä¸åŒã€‚æ·±å…¥äº†è§£ä¸šåŠ¡é€»è¾‘ï¼Œæœ€å¥½çš„æ¥å£è®¾è®¡å°±å‡ºè‡ªä½ çš„æ‰‹ä¸­ï¼ 5ã€è¿ªç±³ç‰¹æ³•åˆ™è¿ªç±³ç‰¹æ³•åˆ™ï¼ˆLaw of Demeterï¼ŒLoDï¼‰ä¹Ÿç§°ä¸ºæœ€å°‘çŸ¥è¯†åŸåˆ™ï¼ˆLeast Knowledge Principleï¼ŒLKPï¼‰ï¼Œè™½ç„¶åå­—ä¸åŒï¼Œä½†æè¿°çš„æ˜¯åŒä¸€ä¸ªè§„åˆ™ï¼šä¸€ä¸ªå¯¹è±¡åº”è¯¥å¯¹å…¶ä»–å¯¹è±¡æœ‰æœ€å°‘çš„äº†è§£ã€‚é€šä¿—çš„è®²ï¼Œä¸€ä¸ªç±»åº”è¯¥å¯¹è‡ªå·±éœ€è¦è€¦åˆæˆ–è°ƒç”¨çš„ç±»çŸ¥é“çš„æœ€å°‘ï¼Œä½ ï¼ˆè¢«è€¦åˆæˆ–è°ƒç”¨çš„ç±»ï¼‰çš„å†…éƒ¨æ˜¯å¦‚ä½•å¤æ‚éƒ½å’Œæˆ‘æ²¡å…³ç³»ï¼Œé‚£æ˜¯ä½ çš„äº‹æƒ…ï¼Œæˆ‘å°±çŸ¥é“ä½ æä¾›çš„è¿™ä¹ˆå¤špublicæ–¹æ³•ï¼Œæˆ‘å°±è°ƒç”¨è¿™ä¹ˆå¤šï¼Œå…¶ä»–çš„æˆ‘ä¸€æ¦‚ä¸å…³å¿ƒã€‚ ç†è§£ï¼šå°½é‡å‡å°‘å¯¹è±¡ä¹‹é—´çš„äº¤äº’ï¼Œä»è€Œå‡å°ç±»ä¹‹é—´çš„è€¦åˆã€‚åœ¨åšç³»ç»Ÿè®¾è®¡æ—¶ï¼Œä¸è¦è®©ä¸€ä¸ªç±»ä¾èµ–äºå¤ªå¤šå…¶ä»–çš„ç±»ï¼Œéœ€å°½é‡å‡å°ä¾èµ–å…³ç³»ï¼Œå¦åˆ™æ­»éƒ½ä¸çŸ¥é“æ€ä¹ˆæ­»çš„ã€‚ æ€»ç»“ï¼šä¸€å®šè¦åšåˆ°ï¼šä½è€¦åˆã€é«˜å†…èšã€‚ 6ã€å¼€é—­åŸåˆ™å®šä¹‰ï¼šSoftware entities like classes,modules and functions should be open for extension but closed for modifications.(ä¸€ä¸ªè½¯ä»¶å®ä½“å¦‚ç±»ã€æ¨¡å—å’Œå‡½æ•°åº”è¯¥å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚) ç†è§£ï¼šç±»ã€æ¨¡å—ã€å‡½æ•°ï¼Œå¯ä»¥å»æ‰©å±•ï¼Œä½†ä¸è¦å»ä¿®æ”¹ã€‚å¦‚æœè¦ä¿®æ”¹ä»£ç ï¼Œå°½é‡ç”¨ç»§æ‰¿æˆ–ç»„åˆçš„æ–¹å¼æ¥æ‰©å±•ç±»çš„åŠŸèƒ½ï¼Œè€Œä¸æ˜¯ç›´æ¥ä¿®æ”¹ç±»çš„ä»£ç ã€‚å½“ç„¶ï¼Œå¦‚æœèƒ½ä¿è¯å¯¹æ•´ä¸ªæ¶æ„ä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ï¼Œé‚£å°±æ²¡å¿…è¦æçš„é‚£ä¹ˆå¤æ‚ï¼Œç›´æ¥æ”¹è¿™ä¸ªç±»å§ã€‚ æ€»ç»“ï¼šå¯¹è½¯ä»¶å®ä½“çš„æ”¹åŠ¨ï¼Œæœ€å¥½ç”¨æ‰©å±•è€Œéä¿®æ”¹çš„æ–¹å¼ã€‚","categories":[{"name":"ç¼–ç¨‹æ€æƒ³","slug":"ç¼–ç¨‹æ€æƒ³","permalink":"http://yoursite.com/categories/%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3/"}],"tags":[{"name":"è®¾è®¡åŸåˆ™","slug":"è®¾è®¡åŸåˆ™","permalink":"http://yoursite.com/tags/%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/"}]},{"title":"iOSèµ„æ–™æ•´ç†","slug":"iOSèµ„æ–™æ•´ç†","date":"2019-12-03T07:15:15.000Z","updated":"2020-11-09T07:48:14.308Z","comments":true,"path":"2019/12-03-15:15:15/","link":"","permalink":"http://yoursite.com/2019/12-03-15:15:15/","excerpt":"ä¼ é€é—¨","text":"ä¼ é€é—¨ æ–°æµªå¾®åšiOSå®¢æˆ·ç«¯æ¶æ„ä¸ä¼˜åŒ–ä¹‹è·¯ MVVMå®è·µå¹²è´§ çŒ¿é¢˜åº“iOSå®¢æˆ·ç«¯æ¶æ„è®¾è®¡ Podç§æœ‰åº“åˆ¶ä½œæ•™ç¨‹ å¦‚ä½•ä¼˜é›…çš„ä½¿ç”¨KVO å†…å­˜å¸ƒå±€ iOSé‚£äº›è¢«å¿½ç•¥çš„æ¡†æ¶ Mach-O","categories":[],"tags":[{"name":"iOS","slug":"iOS","permalink":"http://yoursite.com/tags/iOS/"},{"name":"èµ„æ–™æ•´ç†","slug":"èµ„æ–™æ•´ç†","permalink":"http://yoursite.com/tags/%E8%B5%84%E6%96%99%E6%95%B4%E7%90%86/"}]}]}